---
title: Generative structural elucidation from mass spectra as an iterative optimization problem
title_zh: 将基于质谱的生成式结构解析视为迭代优化问题
authors: "Mrunali Manjrekar, Runzhong Wang, Samuel Goldman, Jenna C. Fromer, Connor W. Coley"
date: 2026-02-07
pdf: "https://arxiv.org/pdf/2602.07709v1"
tags: ["keyword:SR", "query:SR"]
score: 6.0
evidence: 用于公式约束优化的图遗传算法
tldr: "本研究针对液相色谱-串联质谱（LC-MS/MS）中大量分子特征难以通过参考数据库注释的挑战，提出了名为FOAM的计算工作流。FOAM将结构解析转化为迭代优化问题，利用分子式约束的图遗传算法结合光谱模拟，在化学空间中搜索匹配实验光谱的候选结构。实验表明，FOAM在NIST'20等数据集上表现优异，不仅能独立完成解析，还能显著增强现有模型的性能，为复杂代谢物的结构鉴定提供了高效且可扩展的新范式。"
motivation: 现有的质谱结构注释方法高度依赖参考数据库，导致大量未知分子特征无法得到准确鉴定。
method: 提出FOAM工作流，通过分子式约束的图遗传算法与光谱模拟相结合，将结构解析建模为迭代优化过程。
result: "在NIST'20和MassSpecGym数据集上的测试证明，FOAM作为独立工具或现有模型的补充均表现出色。"
conclusion: 该研究确立了迭代优化是解决质谱结构解析问题的一种有效且具有高度可扩展性的新范式。
---

## 摘要
液相色谱-串联质谱 (LC-MS/MS) 是代谢组学、环境化学和化学取证领域中分子鉴定的关键分析技术。虽然已经出现了多种计算方法用于对感兴趣的光谱特征进行结构注释，但其中许多特征仍无法通过参考结构或光谱进行可靠注释。在此，我们介绍了 FOAM（Formula-constrained Optimization for Annotating Metabolites，用于注释代谢物的分子式约束优化），这是一种将 LC-MS/MS 结构解析建模为迭代优化问题的计算工作流。FOAM 将分子式约束的图遗传算法与光谱模拟相结合，以在给定实验光谱的情况下探索候选注释。我们在 NIST'20 和 MassSpecGym 数据集上展示了 FOAM 的性能，证明其既可以作为独立的解析流程，也可以作为现有逆向模型的补充。这项工作确立了迭代优化作为结构解析的一种有效且可扩展的范式。

## Abstract
Liquid chromatography tandem mass spectrometry (LC-MS/MS) is a critical analytical technique for molecular identification across metabolomics, environmental chemistry, and chemical forensics. A variety of computational methods have emerged for structural annotation of spectral features of interest, but many of these features cannot be confidently annotated with reference structures or spectra. Here, we introduce FOAM (Formula-constrained Optimization for Annotating Metabolites), a computational workflow that poses structure elucidation from LC-MS/MS as an iterative optimization problem. FOAM couples a formula-constrained graph genetic algorithm with spectral simulation to explore candidate annotations given an experimental spectrum. We demonstrate FOAM's performance on the NIST'20 and MassSpecGym datasets as both a standalone elucidation pipeline and as a complement to existing inverse models. This work establishes iterative optimization as an effective and extensible paradigm for structural elucidation.