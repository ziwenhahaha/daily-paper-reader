---
title: Turning mechanistic models into forecasters by using machine learning
title_zh: 利用机器学习将机理模型转化为预测模型
authors: "Amit K. Chakraborty, Hao Wang, Pouria Ramazi"
date: 2026-02-04
pdf: "https://arxiv.org/pdf/2602.04114v1"
tags: ["keyword:SR", "query:SR"]
score: 9.0
evidence: 从时间序列中进行数据驱动的控制方程发现
tldr: 针对复杂动力系统机制不明且传统数据驱动方法假设参数恒定的局限，本研究提出一种将机器学习与机制模型结合的新框架。该方法允许模型参数随时间变化，并直接从数据中学习其演化规律，从而构建包含时变参数的微分方程组。通过预测这些参数的未来走势，模型能够实现高精度的系统预测。在传染病、生态及环境等多个数据集上的验证表明，该模型在短期和长期预测中均优于传统深度学习方法，为动态系统建模提供了新思路。
motivation: 传统数据驱动的方程发现方法通常假设系数为常数，难以捕捉复杂动力系统中随时间演变的动态特征。
method: 允许微分方程参数随时间变化，利用机器学习学习其演化规律，并将其代入推导出的方程组中进行预测。
result: "模型在多个真实数据集上的预测误差极低（一月期预测误差低于6%），且性能显著优于CNN-LSTM和GBM等传统机器学习方法。"
conclusion: 将时变参数引入数据驱动的微分方程发现框架，能显著增强模型对动态环境的适应性及预测准确性。
---

## 摘要
复杂动力系统的方程可能无法通过专家知识来确定，特别是当底层机制未知时。数据驱动的发现方法通过使用由测量变量构建的函数库，从时间序列数据中推断控制方程，从而应对这一挑战。然而，这些方法通常假设系数是时不变的，这限制了它们捕捉演化系统动力学的能力。为了克服这一局限性，我们允许部分参数随时间变化，直接从数据中学习其时间演化，并推断出一个包含常数参数和时变参数的方程组。然后，我们通过预测时变参数并将这些预测值代入学习到的方程中，将该框架转化为预测模型。该模型使用易感者-感染者-康复者（SIR）模型、消费者-资源模型、温室气体浓度和蓝藻细胞计数的数据集进行了验证。通过动态适应时间偏移，我们提出的模型在学习时间序列时的平均绝对误差低于 3%，在提前一个月的预测中平均绝对误差低于 6%。此外，我们还将其预测性能与 CNN-LSTM 和梯度提升机（GBM）进行了比较，结果表明我们的模型在大多数数据集上都优于这些方法。我们的研究结果表明，将时变参数整合到微分方程的数据驱动发现中，可以同时提高建模精度和预测性能。

## Abstract
The equations of complex dynamical systems may not be identified by expert knowledge, especially if the underlying mechanisms are unknown. Data-driven discovery methods address this challenge by inferring governing equations from time-series data using a library of functions constructed from the measured variables. However, these methods typically assume time-invariant coefficients, which limits their ability to capture evolving system dynamics. To overcome this limitation, we allow some of the parameters to vary over time, learn their temporal evolution directly from data, and infer a system of equations that incorporates both constant and time-varying parameters. We then transform this framework into a forecasting model by predicting the time-varying parameters and substituting these predictions into the learned equations. The model is validated using datasets for Susceptible-Infected-Recovered, Consumer--Resource, greenhouse gas concentration, and Cyanobacteria cell count. By dynamically adapting to temporal shifts, our proposed model achieved a mean absolute error below 3\% for learning a time series and below 6\% for forecasting up to a month ahead. We additionally compare forecasting performance against CNN-LSTM and Gradient Boosting Machine (GBM), and show that our model outperforms these methods across most datasets. Our findings demonstrate that integrating time-varying parameters into data-driven discovery of differential equations improves both modeling accuracy and forecasting performance.

---

## 论文详细总结（自动生成）

这是一份关于论文《Turning mechanistic models into forecasters by using machine learning》的结构化深入总结：

### 1. 核心问题与研究动机
*   **核心问题**：如何从观测数据中自动发现能够处理“非平稳动态”（即系统规律随时间演变）的控制方程，并将其转化为具备高精度预测能力的模型。
*   **研究动机**：
    *   **机理模型局限性**：传统基于专家知识的微分方程难以描述极其复杂的自然系统（如温室气体排放、流行病传播）。
    *   **现有数据驱动方法不足**：如 SINDy 等方法通常假设方程系数是恒定的，无法捕捉因环境变化（如季节、政策）导致的系统演化。
    *   **预测困境**：即使识别出了时变参数，如何预测这些参数的未来走势并将其重新整合进动力系统进行长期预报，仍是一个挑战。

### 2. 方法论：核心思想与技术细节
该研究提出了一个结合**稀疏回归**与**机器学习预测**的两阶段框架：
*   **第一阶段：方程结构发现**
    *   使用**顺序阈值岭回归（STRR）**在全量数据上识别系统的活跃项（Active Terms）。
    *   通过相关性分析确定哪些参数应设为“时变”，哪些设为“常数”。通常选择与导数相关性最高的项作为时变参数。
*   **第二阶段：时变参数学习与预测**
    *   **滑动窗口拟合**：在较短的时间窗口内重复 STRR，提取参数随时间演变的序列。
    *   **机器学习建模**：利用**随机森林（Random Forest）**建立外部协变量（如气温、湿度、风速等天气因子）与时变参数之间的映射关系。
*   **第三阶段：动力学预测**
    *   在预测期内，先用机器学习模型预测未来的参数值，再将这些参数代入发现的常微分方程（ODE）中，通过数值积分（如欧拉法或龙格-库塔法）得到状态变量的预测轨迹。
*   **理论保证**：论文推导了有限时域预测误差界限（Finite-horizon forecast error bounds），证明了在参数非平稳时，时变参数模型比固定参数模型具有更紧致的误差上界。

### 3. 实验设计
*   **数据集/场景**：
    1.  **SIR 模型（模拟）**：模拟传染病传播，加入正弦波动的传染率和随机噪声。
    2.  **消费者-资源（CR）模型（模拟）**：模拟生态捕食关系，加入环境随机性。
    3.  **温室气体浓度（真实）**：阿尔伯塔省油砂尾矿池的 $CO_2$ 和 $CH_4$ 每日监测数据。
    4.  **蓝藻细胞计数（真实）**：阿尔伯塔省 78 个湖泊的长期监测数据。
*   **对比方法（Benchmarks）**：
    *   **固定参数 SINDy**：假设系数恒定的传统方程发现方法。
    *   **CNN-LSTM**：一种结合卷积和长短期记忆网络的深度学习黑盒模型。
    *   **GBM（梯度提升机）**：一种高性能的集成学习回归模型。

### 4. 资源与算力
*   论文提到计算资源由 **Digital Research Alliance of Canada（原 Compute Canada）** 提供。
*   **具体细节**：文中**未明确说明**具体的 GPU 型号、核心数量或具体的训练时长。考虑到使用的是随机森林和稀疏回归，其算力需求通常远低于大规模深度神经网络。

### 5. 实验数量与充分性
*   **实验规模**：
    *   针对模拟数据（SIR, CR），设置了 5 种不同的噪声强度（从 0 到 0.4 或 2.0）进行鲁棒性测试。
    *   针对真实数据，使用了多个监测站（AMS-1, AMS-18）和长达数十年的湖泊监测记录。
    *   采用了**扩展窗口时间序列交叉验证（Expanding-window CV）**，将测试集分为 5 个折叠（Folds），每折预测 30 天。
*   **充分性评价**：实验设计较为充分且客观。它不仅对比了同类方程发现方法，还跨领域对比了纯数据驱动的深度学习模型，并探讨了超参数（如窗口长度、时变参数数量）对结果的影响。

### 6. 主要结论与发现
*   **精度提升**：该模型在学习阶段的平均绝对误差（MAE）低于 **3%**，在提前一个月的预测中 MAE 低于 **6%**。
*   **超越黑盒模型**：在大多数数据集上，该框架的预测性能显著优于 CNN-LSTM 和 GBM，尤其是在处理具有底层物理/生物机制的系统时，机理约束提供了更好的泛化能力。
*   **噪声鲁棒性**：在模拟实验中，即使噪声增加，时变参数模型依然能保持稳定的预测性能，而固定参数模型和纯 ML 模型误差上升较快。
*   **最优配置**：研究发现，通过微调窗口长度和时变参数数量，预测精度可进一步提升（比交叉验证选出的默认配置再提升 2%-8%）。

### 7. 优点与亮点
*   **可解释性与预测力的平衡**：既保留了微分方程的物理含义（因果性），又利用机器学习捕捉了环境驱动的动态变化。
*   **灵活性**：框架不依赖于特定的机器学习算法，可以根据需要更换参数预测器（如用神经网络替换随机森林）。
*   **理论支撑**：提供了严谨的数学证明，解释了为什么时变参数在非平稳系统中优于固定参数。

### 8. 不足与局限
*   **依赖外部驱动变量**：预测精度高度依赖于外部协变量（如天气预报）的准确性。如果天气预报不准，参数预测就会失效。
*   **超参数敏感性**：窗口长度 $w$ 和时变参数的选择对结果影响较大，且目前的交叉验证方法并不总能选出全局最优配置。
*   **库函数依赖**：方程发现依赖于预设的候选函数库（Library），如果真实的非线性项不在库中，模型可能无法准确识别系统。
*   **误差累积**：作为自回归预测模型，长期预测可能会面临数值积分带来的误差累积风险。

（完）
