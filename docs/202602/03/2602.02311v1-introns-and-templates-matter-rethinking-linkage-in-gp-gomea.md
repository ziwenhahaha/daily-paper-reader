---
title: "Introns and Templates Matter: Rethinking Linkage in GP-GOMEA"
title_zh: 内含子与模板的重要性：重新思考 GP-GOMEA 中的连锁
authors: "Johannes Koch, Tanja Alderliesten, Peter A. N. Bosman"
date: 2026-02-02
pdf: "https://arxiv.org/pdf/2602.02311v1"
tags: ["keyword:SR", "query:SR"]
score: 10.0
evidence: 直接针对符号回归中的GP-GOMEA和连锁学习进行改进
tldr: GP-GOMEA是符号回归领域的先进算法，其核心在于利用节点间的联动性（Linkage）来优化进化过程。然而，现有方法在固定模板下产生的内含子（Introns）会干扰互信息的准确估计，进而影响联动性学习。本文提出了两种改进方案：一种在互信息计算中显式考虑内含子，另一种则直接从模板结构推导联动性。实验证明，新方法显著提升了算法性能，且直接利用模板结构的效果最为出色。
motivation: 现有的GP-GOMEA联动性学习机制受内含子干扰，无法准确捕捉树节点间真实的依赖关系。
method: 提出了考虑内含子的互信息度量方法，以及一种直接基于表达式模板结构的灰盒联动性度量方法。
result: 在五个标准符号回归问题上，新方法均显著提升了性能，且发现学习到的联动结构与模板结构高度一致。
conclusion: 显式处理内含子或直接利用模板结构能更有效地捕捉联动性，是提升GP-GOMEA进化效率的关键。
---

## 摘要
GP-GOMEA 是符号回归领域的先进方法之一，尤其擅长寻找小型且具有潜在可解释性的解。任何 GOMEA 变体中采用的关键机制都是利用连锁（即变量之间的依赖关系），以确保高效的进化。在 GP-GOMEA 中，迄今为止一直使用 GP 树中节点位置之间的互信息来学习连锁。为此，需要使用一个固定的表达式模板。然而，对于小于完整模板的表达式，这会导致内含子（introns）的产生。由于内含子对适应度没有影响，它们的出现与选择没有直接联系。因此，内含子可能会对互信息捕捉树节点之间依赖关系的准确性产生不利影响。为了克服这一问题，我们提出了两种新的连锁学习度量方法：一种在互信息估计中明确考虑了内含子；另一种从灰盒视角重新审视 GP-GOMEA 中的连锁学习，从而得到一种无需从种群中学习、而是直接从模板中推导出的度量。在五个标准符号回归问题上，使用这两种度量的 GP-GOMEA 都取得了显著改进。我们还发现，新学习到的连锁结构紧密反映了模板连锁结构，且明确使用模板结构在整体上表现最佳。

## Abstract
GP-GOMEA is among the state-of-the-art for symbolic regression, especially when it comes to finding small and potentially interpretable solutions. A key mechanism employed in any GOMEA variant is the exploitation of linkage, the dependencies between variables, to ensure efficient evolution. In GP-GOMEA, mutual information between node positions in GP trees has so far been used to learn linkage. For this, a fixed expression template is used. This however leads to introns for expressions smaller than the full template. As introns have no impact on fitness, their occurrences are not directly linked to selection. Consequently, introns can adversely affect the extent to which mutual information captures dependencies between tree nodes. To overcome this, we propose two new measures for linkage learning, one that explicitly considers introns in mutual information estimates, and one that revisits linkage learning in GP-GOMEA from a grey-box perspective, yielding a measure that needs not to be learned from the population but is derived directly from the template. Across five standard symbolic regression problems, GP-GOMEA achieves substantial improvements using both measures. We also find that the newly learned linkage structure closely reflects the template linkage structure, and that explicitly using the template structure yields the best performance overall.

---

## 论文详细总结（自动生成）

这篇论文对符号回归（Symbolic Regression, SR）领域的高效算法 GP-GOMEA 进行了深入的重新审视，重点探讨了如何通过改进“连锁学习”（Linkage Learning）来提升算法性能。

以下是对该论文的结构化总结：

### 1. 核心问题与研究动机
*   **核心问题**：在 GP-GOMEA 算法中，如何准确捕捉程序树节点之间的依赖关系（即连锁/Linkage），以实现更有效的变异和交叉。
*   **研究动机**：
    *   GP-GOMEA 使用固定结构的模板来表示数学表达式，这不可避免地产生了**内含子（Introns）**——即在语义上对表达式输出无影响的无效节点。
    *   传统的连锁学习依赖于种群的**互信息（Mutual Information, MI）**统计。由于内含子不受选择压力影响，其取值具有随机性，这会作为噪声干扰 MI 的估计，导致算法无法识别真正的结构依赖。
    *   研究者希望通过消除内含子噪声或利用先验的模板结构信息，来优化进化效率。

### 2. 方法论
论文提出了两种改进连锁学习的新度量方法：
*   **MI_masked（掩码互信息）**：
    *   **核心思想**：在计算变量的熵和互信息时，显式识别每个解中的内含子。
    *   **技术细节**：为所有处于内含子状态的节点分配一个特殊的“掩码标签”。这样，在统计概率分布时，内含子不再被视为随机的函数符号，而是被统一处理，从而使 MI 的计算聚焦于活跃（Active）节点。
*   **Node Proximity（节点邻近度度量）**：
    *   **核心思想**：从“灰盒”优化视角出发，直接利用已知的树模板拓扑结构，而非从种群中学习。
    *   **技术细节**：根据节点在树模板中的物理距离（最短路径）定义相似度。公式为 $S_{i,j} = 1 - \frac{d(i,j)}{1 + \max(d)}$。这种方法假设在树结构中距离越近的节点，其逻辑依赖性越强。
*   **算法流程**：每一代根据上述度量构建相似度矩阵，利用 UPGMA 算法生成连锁树（Linkage Tree），并指导基因池最优混合（GOM）操作。

### 3. 实验设计
*   **数据集**：使用了 5 个标准的符号回归基准问题：Airfoil（机翼噪声）、Bike Sharing（共享单车）、Concrete（混凝土强度）、Dow Chemical（陶氏化学数据）和 Tower。
*   **对比方法（Benchmarks）**：
    *   **Random**：随机连锁结构。
    *   **MI**：标准互信息。
    *   **MI_adjusted**：之前研究提出的偏置修正互信息。
    *   **Univariate**：假设变量间完全独立（基准线）。
*   **变量控制**：测试了不同的模板高度（5层和7层）以及是否开启线性缩放（Linear Scaling, LS）。

### 4. 资源与算力
*   **硬件设施**：实验在配备两颗 **Intel Xeon E5-2699v4** 处理器的机器上运行，每个实验实例运行在独立的物理核心上。
*   **算力预算**：每个运行实例的计算预算上限为 **$10^7$ 次适应度评估**。
*   **训练时长**：论文未给出总时长，但提到单个问题的运行时间从几分钟到几小时不等（见文中图 6 的 Runtime 轴）。

### 5. 实验数量与充分性
*   **实验规模**：每个算法配置在 5 个数据集上进行 5 折交叉验证，每折重复 6 次，共计 **30 次独立运行**。
*   **充分性**：实验设计非常充分且严谨。作者不仅对比了最终精度，还分析了收敛过程（评估次数 vs. 精度）和运行耗时。
*   **客观性**：采用了统计显著性检验（Friedman test 和 Nemenyi test）以及最新的分层自助法（Stratified Bootstrap）置信区间分析，确保了结果的可靠性。

### 6. 主要结论与发现
*   **性能提升**：提出的 `Node` 和 `MI_masked` 在所有设置下均显著优于现有的 MI 方法。
*   **模板的重要性**：直接使用模板结构的 `Node` 方法表现最佳。这表明在 GP-GOMEA 中，**树结构的拓扑约束比种群的实时统计信息更重要**。
*   **连锁学习的本质**：通过可视化发现，`MI_masked` 学习到的结构最终会趋同于模板结构。这解释了为什么直接使用模板（Node 方法）效果最好——它直接提供了连锁学习的“终极目标”。
*   **效率增益**：新方法在达到相同精度时，所需的评估次数和实际运行时间大幅减少（有时可达数倍加速）。

### 7. 优点
*   **简单且零开销**：`Node` 方法不需要在运行时计算复杂的统计量，降低了算法的计算负担。
*   **理论洞察深**：论文揭示了内含子如何通过噪声干扰进化，并证明了 GP 中的连锁在很大程度上是由表示形式（Representation）而非仅仅是数据语义决定的。
*   **实验严谨**：遵循了进化计算领域的最佳实验实践，统计分析非常扎实。

### 8. 不足与局限
*   **应用限制**：该方法高度依赖于 GP-GOMEA 的固定模板设定。对于不使用固定模板的传统 GP 算法，其适用性尚待研究。
*   **偏差风险**：虽然在标准 SR 问题上表现优异，但如果某个特定问题的真实数学结构与所选树模板的拓扑结构存在严重冲突，`Node` 方法可能会引入强烈的先验偏置。
*   **算子集影响**：虽然补充材料测试了更大的算子集，但对于更复杂的超越函数或自定义算子的连锁效应讨论较少。

（完）
