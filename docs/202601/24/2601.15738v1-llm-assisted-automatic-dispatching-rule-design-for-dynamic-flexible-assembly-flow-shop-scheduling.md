<div class="paper-title-row">
<h1 class="paper-title-zh">大语言模型辅助的动态柔性装配流水车间调度自动调度规则设计</h1>
<h1 class="paper-title-en">LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling</h1>
</div>

<div class="paper-meta-row">
<div class="paper-meta-left">
<p><strong>Authors</strong>: Junhao Qiu, Haoyang Zhuang, Fei Liu, Jianjun Liu, Qingfu Zhang</p>
<p><strong>Date</strong>: 2026-01-22</p>
<p><strong>PDF</strong>: <a href="https://arxiv.org/pdf/2601.15738v1" target="_blank">https://arxiv.org/pdf/2601.15738v1</a></p>
<p><strong>Tags</strong>: <span class="tag-label tag-green">EOH</span> <span class="tag-label tag-green">EAA</span></p>
<p><strong>Score</strong>: 9.0</p>
</div>
<div class="paper-meta-right">
<p><strong>Evidence</strong>: 大模型辅助的调度启发式算法自动设计</p>
<p><strong>TLDR</strong>: 利用大语言模型自动设计动态柔性装配流水线调度的派工规则。</p>
</div>
</div>

<div class="paper-glance-section">
<h2 class="paper-glance-title">速览</h2>
<div class="paper-glance-row">
<div class="paper-glance-col">
<div class="paper-glance-label">Motivation</div>
<div class="paper-glance-content">传统的启发式设计方法难以捕捉动态不确定性及多级装配系统中的复杂层级依赖关系。</div>
</div>
<div class="paper-glance-col">
<div class="paper-glance-label">Method</div>
<div class="paper-glance-content">通过异构图建模决策过程，结合精英知识引导初始化与LLM双专家机制（代码生成与调度评估）实现规则进化。</div>
</div>
<div class="paper-glance-col">
<div class="paper-glance-label">Result</div>
<div class="paper-glance-content">在多项实验中，该方法的平均延迟比现有最优方法降低了3.17%-12.39%，且在多种复杂场景下表现出更强的鲁棒性。</div>
</div>
<div class="paper-glance-col">
<div class="paper-glance-label">Conclusion</div>
<div class="paper-glance-content">LLM辅助的规则设计能有效提取动态特征并应对复杂约束，为工业调度问题提供了更具泛化能力的自动化解决方案。</div>
</div>
</div>
<div class="paper-glance-tldr"><strong>TLDR</strong>：提出LLM4DRD框架，利用大语言模型自动设计并演化适用于动态柔性装配流水车间的高效调度规则。</div>
</div>

---


## 摘要
动态多产品交付环境要求在混合加工与装配系统中快速协调零件完工和产品级配套，以满足严格的分层供应约束。柔性装配流水车间调度问题正式定义了多阶段配套的依赖关系，然而动态变体使得在多级时间耦合下设计集成调度规则极具挑战性。现有的自动启发式设计方法，特别是受限于固定终结符集的遗传编程，难以捕捉和利用瞬态决策状态下的动态不确定性和分层依赖信息。本研究开发了一个大语言模型辅助的动态规则设计框架（LLM4DRD），该框架能够自动演化出适应调度特征的集成在线调度规则。首先，基于异构图将多阶段加工和装配供应决策转化为可行的有向边排序。然后，精英知识引导的初始化将先进的设计专业知识嵌入到初始规则中，以提高初始质量。此外，引入了一种双专家机制，其中 LLM-A 演化代码以生成候选规则，而 LLM-S 进行调度评估；同时，动态特征拟合规则演化结合混合评估实现了持续改进，并提取出具有强泛化能力的自适应规则。通过一系列实验验证了该方法的有效性。在用于训练和测试的 20 个实际算例中，LLM4DRD 的平均延迟性能分别比最先进的方法高出 3.17-12.39%。在包含不同资源配置、订单负载和扰动水平的 24 个场景（共 480 个算例）中，其性能比排名第二的竞争对手高出 11.10%，表现出卓越的鲁棒性。

## 速览
**TLDR**：针对动态柔性装配流水线调度中多级供应约束和动态不确定性带来的挑战，本文提出了一种基于大语言模型的自动调度规则设计框架（LLM4DRD）。该框架通过异构图转化调度决策，并利用双专家机制（LLM-A生成代码，LLM-S评估）进行规则进化。实验证明，该方法在降低平均延期时间和增强系统鲁棒性方面显著优于现有启发式设计方法，为复杂装配系统的实时调度提供了新方案。 \
**Motivation**：传统的自动化启发式设计方法难以有效捕捉动态不确定性及多级层级依赖信息，导致在复杂装配调度场景下性能受限。 \
**Method**：开发了LLM4DRD框架，通过异构图建模、精英知识引导初始化及双专家进化机制，实现调度规则的自动演化与特征拟合。 \
**Result**：实验显示，该方法在平均延期时间上比现有最先进方法提升了3.17%-12.39%，且在不同负载和扰动场景下表现出极强的鲁棒性。 \
**Conclusion**：LLM辅助的规则设计能够自动提取具备强泛化能力的自适应调度规则，是解决动态柔性装配调度问题的有效途径。

---

## Abstract
Dynamic multi-product delivery environments demand rapid coordination of part completion and product-level kitting within hybrid processing and assembly systems to satisfy strict hierarchical supply constraints. The flexible assembly flow shop scheduling problem formally defines dependencies for multi-stage kitting, yet dynamic variants make designing integrated scheduling rules under multi-level time coupling highly challenging. Existing automated heuristic design methods, particularly genetic programming constrained to fixed terminal symbol sets, struggle to capture and leverage dynamic uncertainties and hierarchical dependency information under transient decision states. This study develops an LLM-assisted Dynamic Rule Design framework (LLM4DRD) that automatically evolves integrated online scheduling rules adapted to scheduling features. Firstly, multi-stage processing and assembly supply decisions are transformed into feasible directed edge orderings based on heterogeneous graph. Then, an elite knowledge guided initialization embeds advanced design expertise into initial rules to enhance initial quality. Additionally, a dual-expert mechanism is introduced in which LLM-A evolutionary code to generate candidate rules and LLM-S conducts scheduling evaluation, while dynamic feature-fitting rule evolution combined with hybrid evaluation enables continuous improvement and extracts adaptive rules with strong generalization capability. A series of experiments are conducted to validate the effectiveness of the method. The average tardiness of LLM4DRD is 3.17-12.39% higher than state-of-the-art methods in 20 practical instances used for training and testing, respectively. In 24 scenarios with different resource configurations, order loads, and disturbance levels totaling 480 instances, it achieves 11.10% higher performance than the second best competitor, exhibiting excellent robustness.

---

## 论文详细总结（自动生成）

这是一份关于论文《LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling》的结构化深入总结：

### 1. 核心问题与整体含义（研究动机和背景）
*   **研究背景**：在个性化消费趋势下，制造业正从大规模生产转向小批量定制。柔性装配流水车间（FAFSP）需同时处理零件加工与产品装配，且面临动态订单到达、机器故障等不确定性。
*   **核心挑战**：
    1.  **多级配套约束**：订单的交付取决于其中最晚完成的产品，存在严格的层级耦合。
    2.  **动态不确定性**：传统静态调度方法无法应对实时扰动。
    3.  **现有方法局限**：遗传编程（GP）等自动化启发式设计方法受限于固定的符号集，难以捕捉复杂的系统语义和动态特征。
*   **研究目的**：利用大语言模型（LLM）强大的代码生成与逻辑推理能力，自动设计并演化能够自适应动态环境的高性能派工规则（PDRs）。

### 2. 方法论：LLM4DRD 框架
*   **核心思想**：构建一个“双专家”协同进化系统，将调度问题建模为马尔可夫决策过程（MDP），通过 LLM 自动迭代生成并优化调度代码。
*   **关键技术细节**：
    *   **异构图建模**：基于异构图将加工和装配决策统一表示为有向边的排序问题，消除多阶段供应冲突。
    *   **精英知识引导初始化**：利用经典调度规则（如 EDD）作为基准，提取设计知识引导 LLM 生成高质量的初始种群。
    *   **双专家机制**：
        *   **LLM-A（算法专家）**：负责编写和修改 Python 格式的派工规则代码。
        *   **LLM-S（调度专家）**：负责分析调度结果，提供定性的语义反馈和改进建议。
    *   **混合评估策略**：结合定量指标（平均延迟）与定性分析（LLM-S 的反馈），为进化提供多维度指导。
    *   **特征拟合进化**：设计了四种 Prompt 策略（优势融合交叉、探索性交叉、定向优化、参数微调），使规则能够精准拟合动态系统特征。

### 3. 实验设计
*   **数据集/场景**：
    *   **真实数据**：源自中国某家电制造商的订单结构和资源配置。
    *   **合成数据**：通过泊松过程模拟动态订单到达，涵盖 24 种不同资源规模、柔性因子、负载强度和扰动水平的场景。
*   **Benchmark（对比方法）**：
    *   **经典规则**：EDD, FIFO, SPT, MOPNR, LWKR, MWKR 等及其组合。
    *   **传统 AHD 方法**：遗传编程（GP）、基因表达式编程（GEP）。
    *   **LLM 驱动方法**：EOH, FunSearch, ReEvo, MCTS-AHD, Random Sample。

### 4. 资源与算力
*   **硬件环境**：实验运行在 Intel Core i5-12600KF 处理器上。
*   **模型使用**：对比了 Qwen-72B、Claude、DeepSeek-Chat、GPT-4o-mini 等模型。最终因性价比和代码准确率选择 **GPT-4o-mini** 作为核心引擎。
*   **训练时长**：文中未明确给出具体的总训练/演化时长，但提到派工规则的在线决策时间为毫秒级，满足实时调度需求。

### 5. 实验数量与充分性
*   **实验规模**：
    *   在 20 个核心实例上进行了消融实验和 SOTA 对比。
    *   在 24 种不同工况下进行了 480 个实例的鲁棒性测试。
*   **充分性评价**：实验设计非常充分。不仅包含了针对算法组件的**消融实验**（验证了动态特征、精英初始化、双专家机制的有效性），还进行了**收敛性分析**和**可解释性分析**（展示了代码逻辑如何随迭代演进），客观地证明了 LLM4DRD 的优越性。

### 6. 主要结论与发现
*   **性能提升**：LLM4DRD 在训练和测试集上的平均延迟性能比现有最先进方法（如 GP, EOH）高出 **3.17% - 12.39%**。
*   **鲁棒性强**：在极端高负载和频繁扰动场景下，LLM4DRD 比次优方法性能高出 **11.10%**。
*   **知识演化**：实验证明 LLM 能够通过语义反馈发现复杂的调度逻辑（如引入预测性加工时间、历史性能因子等），这是传统符号回归方法难以实现的。

### 7. 优点（亮点）
*   **语义驱动**：引入 LLM-S 专家，将“为什么这个规则好/坏”的语义信息转化为改进动力，突破了纯数值优化的瓶颈。
*   **端到端自动化**：从特征提取到代码生成再到评估，实现了全流程闭环，无需人工干预设计复杂的启发式函数。
*   **强泛化性**：生成的规则在未见过的复杂工况下依然保持稳定，具有很高的工业应用潜力。

### 8. 不足与局限
*   **API 依赖**：框架高度依赖商业 LLM 的 API，存在成本波动和网络延迟风险。
*   **约束覆盖**：目前主要关注加工与装配，尚未深入考虑二次资源约束（如模具、人力）或复杂的物流运输约束。
*   **随机性风险**：尽管有温度控制，但 LLM 生成代码仍存在随机性，可能需要多次采样才能获得最优解。

（完）
