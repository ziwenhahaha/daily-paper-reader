Title: LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling

URL Source: https://arxiv.org/pdf/2601.15738v1

Published Time: Fri, 23 Jan 2026 01:30:27 GMT

Number of Pages: 48

Markdown Content:
# LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling 

Junhao Qiu a, Haoyang Zhuang b, Fei Liu a, Jianjun Liu b, Qingfu Zhang a, ∗

> aDepartment of Computer Science, City University of Hong Kong, Hong Kong, China
> bGuangdong Provincial Key Laboratory of Computer Integrated Manufacturing, School of Electromechanical Engineering, Guangdong University of Technology, Guangzhou, China

Abstract 

Dynamic multi-product delivery environments demand rapid coordination of part completion and product-level kitting within hybrid processing and assembly systems to satisfy strict hierarchical supply constraints. The flexi-ble assembly flow shop scheduling problem formally defines dependencies for multi-stage kitting, yet dynamic variants make designing integrated schedul-ing rules under multi-level time coupling highly challenging. Existing au-tomated heuristic design methods, particularly genetic programming con-strained to fixed terminal symbol sets, struggle to capture and leverage dy-namic uncertainties and hierarchical dependency information under transient decision states. This study develops an LLM-assisted Dynamic Rule De-sign framework (LLM4DRD) that automatically evolves integrated online scheduling rules adapted to scheduling features. Firstly, multi-stage process-ing and assembly supply decisions are transformed into feasible directed edge orderings based on heterogeneous graph. Then, an elite knowledge guided initialization embeds advanced design expertise into initial rules to enhance initial quality. Additionally, a dual-expert mechanism is introduced in which LLM-A evolutionary code to generate candidate rules and LLM-S conducts scheduling evaluation, while dynamic feature-fitting rule evolution combined with hybrid evaluation enables continuous improvement and extracts adap-       

> ∗Principal corresponding author
> Email addresses: junhaoqiu2-c@my.cityu.edu.hk (Junhao Qiu),
> zhuanghaoyang@mails.gdut.edu.cn (Haoyang Zhuang), fliu36-c@my.cityu.edu.hk
> (Fei Liu), jianjun.liu@gdut.edu.cn (Jianjun Liu), qingfu.zhang@cityu.edu.hk
> (Qingfu Zhang)
> arXiv:2601.15738v1 [cs.NE] 22 Jan 2026

tive rules with strong generalization capability. A series of experiments are conducted to validate the effectiveness of the method. The average tardi-ness of LLM4DRD is 3.17-12.39% higher than state-of-the-art methods in 20 practical instances used for training and testing, respectively. In 24 scenarios with different resource configurations, order loads, and disturbance levels to-taling 480 instances, it achieves 11.10% higher performance than the second best competitor, exhibiting excellent robustness. 

Keywords: Flexible assembly flow shop, Dynamic job arrivals, Multi-product delivery, Large language model, Automatic dispatching rule design 

1. Introduction 

With the emergence of personalized consumption patterns, traditional processing and assembly hybrid multistage manufacturing systems are under-going a profound transformation from large-scale production to small-batch customization (Zhang and Ming, 2023; Qin and Lu, 2021). International lo-gistics shipments under frequent geopolitical changes and on-site centralized deliveries of packaged products further emphasize the centralized aggrega-tion of different families of products in the time dimension (Bednarski et al., 2025). The drastic order fluctuations and increasingly complex kitting deliv-ery requirements pose a severe challenge to the hierarchical coordination and processing capability of the manufacturing system. The traditional indepen-dent scheduling of sub-shops and periodic overall decision optimization are difficult to meet the requirements of high responsiveness and strong robust-ness in cloud manufacturing systems (Sahoo and Lo, 2022; Qiu et al., 2024b). Therefore, there is an urgent need for companies to build online integrated scheduling schemes for changes in multi-stage manufacturing systems from the perspective of flexible and responsive decision-making. The Flexible Assembly Flow shop Scheduling Problem (FAFSP) precisely portrays the supply relationship between part processing and product as-sembly (Liu et al., 2025; Komaki et al., 2019), and has attracted significant attention in the appliance (Elyasi et al., 2024; Seidgar et al., 2014), elec-tronics Chen et al. (2023), automotive (Leng et al., 2023), and plastics in-dustries (Allahverdi et al., 2016). Multi-product delivery involves further centralized completion and delivery of different product families based on the hierarchical coupling constraints inherent in FAFSP’s product structure 2supply assembly (Azizi and Hu, 2020; Zou et al., 2018). The dual kitting constraints of processing sets establish a stricter supply relationship between tasks and orders, necessitating multi-stage collaborative decision-making. In traditional static FAFSP where the process information is exactly known before scheduling, researchers have proposed a variety of solution methods, including exact algorithms (e.g., mathematical programming (da Silva San-tana and Fuchigami, 2024), branch-and-bound method (Fattahi et al., 2014; Komaki et al., 2019)) as well as various kinds of meta-heuristic applied to large-scale problems, such as genetic algorithm (Luo et al., 2019; Wu et al., 2021a), iterative greedy (Zhang et al., 2021; Wu et al., 2020), particle swarm optimization (Chang et al., 2025; Hao and Zhu, 2024), dynamic differential evolution (Wu et al., 2021b), etc. However, these methods are established on the ideal assumption that the production process is stable and unchanging, and exhaustively solved in a closed environment with abundant computa-tional resources (Lei et al., 2023). These approaches clearly fail to meet the high responsiveness requirements when dealing with uncertain events such as the dynamic arrival of new orders and machine breakdowns in online schedul-ing scenarios. In online scheduling, the arrival of urgent orders requires reassessing pri-orities and processing, which also profoundly impacts the inherent stricter supply relationship (Branke* and Mattfeld, 2005). The existing methods for dynamic scheduling of manufacturing systems are mainly categorized proac-tive and reactive (Ouelhadj and Petrovic, 2009). Proactive scheduling, also known as robust scheduling, generates initial solutions that can resist a cer-tain degree of uncertainty by inserting idle time, but usually at the expense of optimality (Pandhare et al., 2024; Lu et al., 2012). In contrast, reactive scheduling (also known as response rescheduling) offers greater flexibility and adaptability by reevaluating decisions in response to each dynamic event. However, it heavily relies on Priority Dispatching Rules (PDRs) (Qiu et al., 2024b; Yang and Geunes, 2008), which are favored for their computational efficiency and quick response, enabling real-time decision-making in dynamic environments. Nevertheless, traditional PDRs (e.g., FIFO, EDD (Bayka-soğlu and Özbakır, 2010)) remain largely static, depending on expert knowl-edge or offline optimization techniques tailored to specific production sce-narios (Zhang et al., 2023b; Wang et al., 2022). As a result, their perfor-mance deteriorates significantly when the scheduling problem characteristics or workshop conditions undergo structural changes (Qiu et al., 2024a). Deep Reinforcement Learning (DRL) is widely used to solve this problem 3by dynamically adapting to changes in the environment and making quick ac-tion decisions. The scheduling problem is often formulated by such methods as a Markov Decision Process (MDP), where actions are either determined indirectly through the dynamic selection of PDRs or inferred directly via end-to-end optimization. For example, Lei et al. (2023); Wang et al. (2022); Qiu et al. (2024a) have utilized DRL to train agents on a pre-defined set of PDRs, enabling the dynamic selection of rules or search strategies (Cai et al., 2023) to solve complex problems. While this approach facilitates rule adjustment in response to state changes, its effectiveness is still highly depen-dent on the initial performance of the pre-selected PDR set. Therefore, the key challenge in solving the online FAFSP lies in enabling scheduling rules to exhibit adaptive capabilities, thereby facilitating the automatic design of responsive PDRs. The automatic design of PDRs involves the automatic selection, tuning, or construction of effective heuristics for given problem classes (Burke et al., 2013). Genetic Programming (GP) is one of the most well-known methods in the field of heuristic automatic design for scheduling problems (Zhang et al., 2023a; Nguyen et al., 2017). Early work by Tay and Ho (2008) used GP to design multi-objective PDRs aimed at optimizing makespan, tardiness, and flowtime for multi-objective Flexible Job Shop Scheduling (FJSP). In dynamic FJSP, Zhang et al. (2020) integrated feature selection into GP hy-perheuristics, successfully designing more interpretable scheduling heuristics with fewer unique features and reduced complexity. Ozturk et al. (2019) con-sidered the inclusion of scheduling environment information when construct-ing the terminal set in Genetic Expression Programming (GEP).However, these methods exhibit certain limitations. In particular, GP typically relies on a predefined set of terminal symbols or mutation actions to construct and evolve heuristics, which necessitates prior specification of the search space and may implicitly incorporate problem specific knowledge into the algo-rithm design process (O’Neill et al., 2010). Recently, the application of Large Language Models (LLMs) for Au-tomated Heuristic Design (AHD) has achieved notable success in various fields(Liu et al., 2024b), including combinatorial optimization (Li et al., 2025; Ye et al., 2024; Xie et al., 2025), mathematics (Romera-Paredes et al., 2024; Novikov et al., 2025), and machine learning (Mo et al., 2025). The core idea is to integrate LLMs as heuristic designers within evolutionary search, neigh-borhood search, and other iterative search frameworks. Huang et al. (2024) designed the SeEvo framework, inspired by the self-reflective design strate-4gies of human experts, for the design of PDRs in dynamic Job shop Schedul-ing Problems(JSP). Notable examples include EoH (Liu et al., 2024a) which evolves both the reasoning process and the code for effective automation. These studies highlight the significant potential of such methods in Flow shop Scheduling Problems (FSP) and Job shop Scheduling Problems(JSP), demonstrating their vast future applicability. 

Table 1: Recent research on solving production scheduling problems. 

Method Problem Reference Dynamic Objective Offline Characteristic 

GP FJSP Tay and Ho (2008) - Makespan, Tardiness, Flowtime 

✗ Design composite PDRs FJSP Zhou et al. (2020) RJA Tardiness, Flowtime 

✓ Design PDRs for job sequencing and machine allocation FJSP Zhang et al. (2020) RJA Tardiness, Flowtime 

✓ Design routing and sequencing PDRs with feature selection GEP FJSP Ozturk et al. (2019) RJA Makespan, Tardiness, Flowtime 

✓ Applying multi-objective GEP to ex-tract PDRs DRL FJSP Lei et al. (2023) RJA Makespan ✓ New job release control and scheduling decision based on multi-agent structure THFSP Wang et al. (2022) RJA Tardiness ✓ Dynamic selection of rules for machine allocation and batch formation FAFSP Cai et al. (2023) - Makespan ✗ Dynamic selection of search strategies TFAFSP Qiu et al. (2024a) RJA Tardiness ✓ Dynamic selection of multi-level PDRs LLM JSP Huang et al. (2024) PTU Makespan ✓ Automated design of PDRs FSP/JSP Liu et al. (2024a) - Makespan ✓ Automated design of heuristic FAFSP Ours RJA Tardiness ✓ Automatic design of integrated PDRs JSP: Job shop scheduling problem, FJSP: Flexible job shop scheduling problem, DFJSP: Distributed flexible job shop scheduling problem, FSP: Flow shop scheduling problem, THFSP: Two-stage hybrid flow shop scheduling problem, FAFSP: Flexible assembly flow shop scheduling problem, TFAFSP: Two-stage flexible assembly flow shop scheduling problem, RJA: Random job arrive, MB: Machine breakdowns, PTU: Processing time uncertainty. 

LLMs exhibit strong capabilities in code generation and logical reason-ing, yet significant challenges remain in automatically designing dynamic PDRs capable of understanding complex constraints and disturbance pat-terns: (1)Semantic perception of uncertainty in dynamic scheduling. LLM-generated PDRs react in real time to fluctuating order demands while ac-counting for factors such as order priority, delivery deadlines, and resource availability. Effectively representing and exploiting the semantic state infor-mation of dynamic, multi-level manufacturing systems is essential for ensur-ing the robustness of LLM-generated PDRs (Zhang et al., 2020). (2)Asyn-5chronous integrated scheduling with multi-level PDRs in hybrid process-ing–assembly systems. In practical production environments, processing and assembly decisions occur asynchronously, creating decision misalignment. Processing aims to reduce changeover losses and improve efficiency to ensure complete product sets, thereby preventing assembly idle time (da Silva San-tana and Fuchigami, 2024). In contrast, assembly prioritizes coordinating different products within the same order to enable consolidated delivery and avoid order delays (Qiu et al., 2024a). Therefore, enabling the automatic gen-eration of asynchronous, integrated PDRs that account for heterogeneous decision preferences and dynamic system semantics is crucial for balanc-ing multi-product delivery performance and resource utilization. To address these challenges, this study proposes an LLM-assisted Dynamic Rules Design framework (LLM4DRD) for online scheduling in flexible assembly flow shops. The main contributions are as follows: 1. A heterogeneous graph based MDP is formulated for the dual kitting constrained FAFSP, where assembly supply and multi-product delivery decisions are jointly represented as directed edges to eliminate hierar-chical conflicts in multi stage supply. 2. An automatic PDR design framework named LLM4DRD is proposed for online FAFSP. A dual-expert mechanism with LLM-A for rule gen-eration and LLM-S for scheduling evaluation is employed to achieve cross-domain integration of algorithm design and optimization knowl-edge for continuous improvement. 3. An elite knowledge guided initialization mechanism is introduced to transfer high level design knowledge into the initial PDR construction, improving the quality of initial rules and accelerating convergence. 4. A hybrid evaluation strategy is developed to assess PDR adaptability in dynamic multi level manufacturing systems by combining objective indicators with empirical evaluation, supporting more targeted perfor-mance improvement. 5. A feature fitting based rule evolution mechanism is designed to contin-ually extract dynamic PDRs that align with system features by lever-aging domain knowledge, thereby improving both search efficiency and generalization performance. The remainder of this paper is organized as follows. Section 2 intro-duces and formulates the FAFSP, the MDP, and the associated optimiza-tion problem. Section 3 presents the implementation details of the proposed 6LLM4DRD framework. Section 4 reports the computational experiments and discusses the corresponding results. Finally, Section 5 concludes the paper with a brief summary. 

2. Problem description and formulation 

2.1. Problem description 

In traditional FAFSP, an order consists of a single product and its comple-tion time depends on the corresponding processing and assembly processes. Although multi-stage routing and machine alternatives are considered, the problem fundamentally concerns a single product process chain. In realistic production environments, however, a customer order often comprises multi-ple heterogeneous products need to be jointly completed before entering the final assembly or delivery stage. This multi-product structure fundamentally alters the nature of the FAFSP. Under multi-product delivery, the key challenge arises from the require-ment of kit-completeness: an order’s delivery time is determined by the latest finished product within it. Any delay in one product propagates directly to the entire order. This coupling, absent in the traditional FAFSP, introduces strong cross-product dependencies. Furthermore, the products within the same order often differ in process routes, processing times, machine alter-natives, and quantity demands, creating substantial load imbalance during processing and leading to divergent completion times that accumulate at the order level. Extending FAFSP to this environment raises a hierarchi-cal scheduling problem in which product-level assembly kitting constraints (often referred to as hierarchical coupling constraints) and order-level syn-chronization requirements must be jointly satisfied (Zou et al., 2018). The optimization challenge shifts from sequencing a single process chain to coor-dinating multiple heterogeneous product chains whose progress need to be synchronized for timely order delivery. Balancing resource utilization while ensuring kit-completeness becomes the core difficulty, making multi-product delivery a significantly more complex and tightly coupled scheduling problem than the traditional FAFSP. 

2.2. Problem formulation 

The notation of the mathematical model is illustrated in Table 2. Each order i ∈ I is characterized by a expected delivery time DT i and an arrival 7Table 2: Notations of mathematical model. 

Indices 

i Order index, i ∈ Ip Product index, p ∈ Pj Job index, j1, j 2 ∈ Jm Machine index, m ∈ M

Parameters 

Qj,m 1 if the machine m is qualified to process the job j, 0 otherwise 

Pj1,j 2 1 if job j1 is the immediate predecessor of job j2, 0 otherwise 

P T j,m Processing time of job j on machine mAp,j 1 if job j is an assembly task for the product p, 0 otherwise 

Oi,p 1 if product p belongs to order i, 0 otherwise. 

DT i Delivery time of order iAT i Arrival time of order iST j1,j 2 Setup time for job j1 switch to job j2

V A large number 

Decision variables 

tt i Tardiness of order if t i Completion time of order ict j Completion time of job jst j Start time of processing for job jxj1,j 2,m Binary variable, if job j1 is processed after job j2 in machine m,then xj1,j 2,m = 1 , otherwise xj1,j 2,m = 0 

time AT i. An order contains p ∈ P products to be delivered, all of which must be processed on the set of processing or assembly machines m ∈ M . Each order can be decomposed into multiple processing or assembly jobs j ∈ J.A machine m ∈ M is qualified to process job j if Qj,m = 1 , and unqualified otherwise. The processing time of job j on machine m is denoted by P T j,m ,and the setup time required to switch from job j1 to job j2 is denoted by 

ST j1,j 2 . If job j1 is the immediate predecessor of job j2, then Qj1,j 2 = 1 , and 0 otherwise. If job j belongs to order i, then Bi,j = 1 , and 0 otherwise. If job j is the assembly job corresponding to product p, then Ap,j = 1 , and 0 otherwise. Finally, if order i contains product p, then Oi,p = 1 , and 0 otherwise. The decision variable xj1,j 2,m is a binary variable that takes the value 1 if, on machine m, job j2 is processed immediately after job j1 due to a setup change from j1 to j2, and 0 otherwise. In addition, the model includes the following decision variables: the tardiness of order i, denoted by tt i; the completion time of order i, denoted by f t i; the completion time of job j,8denoted by ct j ; and the start time of job j, denoted by st j . The objective, as shown in 1, is to minimize the all tardiness in multi-product delivery orders. 

min 

> I

X

> i=1

(tt i) (1) Subjective to: 

xj1,j 2,m ≤ Qj2,m , ∀j1 ∈ [0] ∪ J, j 2 ∈ J, m ∈ M (2) 

> J

X

> j=1

x0,j,m = 1 , ∀m ∈ M (3) 

> M

X

> m=1
> J

X

> j1=0

xj1,j 2,m = 1 , ∀j2 ∈ J (4) 

> J

X

> j1=0

xj1,j 2,m −

> J

X

> j1=0

xj2,j 1,m = 0 , ∀j2 ∈ J, m ∈ M (5) 

st j2 ≤ ct j2 − P T j2,m + V × 1 −

> J

X

> j1=0

xj1,j 2 , m 

!

, ∀j2 ∈ J, m ∈ M (6) 

ct j2 ≥ ct j1 × P T j2,m + ST j1,j 2 + V × (xj1,j 2,m − 1) ,

∀j1 ∈ [0] ∪ J, j 2 ∈ J, m ∈ M (7) 

ct j2 ≥ Pj1,j 2 × ct j1 +

> M

X

> m=1
> J

X

> j3=0

(xj3,j 2,m × (P T j2,m + ST j3,j 2 )) , ∀j1, j 2 ∈ J (8) 

f t i ≥ ct j + V × (Ap,j + Oi,p − 2) , ∀i ∈ I, p ∈ P, j ∈ J (9) 

st j ≥ (Ap,j + Oi,p − 2) × V + AT i, ∀i ∈ I, p ∈ P, j ∈ J (10) 

tt i ≥ f t i − DT i, ∀i ∈ I (11) 9tt i, f t i, ct j , st j ≥ 0, ∀i ∈ I, j ∈ J (12) Constraints 2-5 define the flow and sequence restrictions for jobs on ma-chines. Note that j = 0 represents a virtual order, and ct j = 0 . Constraint 6 and 7 imposes the processing time limitations for jobs executed on the same machine. Constraint 8 represents the hierarchical coupling constraint, en-suring that the temporal requirements of the processing routes are satisfied. Constraint 9 is the multi-product delivery constraint, as it determines the final delivery time of each order. Constraint 10 enforces the arrival-time re-striction, statically ensuring that the start time of an order cannot precede its arrival time. The constraints 11 and 12 specify the definition of tardiness and the feasible range of key decision variables. 

2.3. Markov decision process 

The FAFSP online decision process is event-driven, where each decision step is triggered at time 0 or upon the completion of any job. At deci-sion step t, given the current dynamic system state st, the PDRs is used to filter the feasible action set, and the scheduling decision at is applied for integrated processing and assembly operations. The environment then tran-sitions to the next decision step t + 1 . This process continues until all jobs have been scheduled. Based on the heterogeneous graph representation of flexible processing capabilities, the job-sequencing and machine-assignment subproblems are jointly modeled as directed j-m arcs decision. The MDP and other notations in this paper are described in Table 3, and the MDP tuple (S, A, P, R ) is defined as follows: 

States St: The system state st at decision step t captures the conditions of all jobs and machines. To effectively represent the dynamics and flexibility of the multi-stage manufacturing system, observation features are designed for jobs, job–machine arcs j-m, and machines. The state vector satisfies 

St ∈ R9, with detailed feature definitions provided in Table 4. As the system evolves from t to t + 1 , the state features are continuously recomputed and updated. Due to the arrival of new orders, the feasible action space is also updated across decision steps. 

Actions at: At step t, the action at ∈ At is defined as selecting a feasible job and machine pair (j, m ) corresponding to the activation of a directed 

j-m arc. A pair is feasible only if job j has arrived, all its predecessors are completed, and machine m is idle. Once a job or machine is assigned, 10 Table 3: Notations of problem formulation.                                      

> Notations Description
> JtJob set at decision step tJundo tUnprocessed job set at decision step tJf inish tFinished job set at decision step tJ(t)
> mSet or number of jobs qualified for processing of machine mEM (t)
> jSet or number of available processing machines for job jat step tIT (t)
> mEarliest machine available time at step tCT (t)
> mCumulative processing time of machine mat decision step tET (t)
> j,m Actual processing time at step t, cumulative time if the job has been processed, otherwise average P T ion available machines
> y(t)
> jBinary variable, 1 if job is processed or not in decision step t, 0 otherwise
> xInstance x∈ X
> πPDR πfor prioritizing arcs
> SSolver for dynamic FAFSP
> G(A)(·)LLM-based algorithm generator
> G(S)(·)LLM-based schedule evaluator

the associated feasible arcs are removed to avoid reassignment. When all feasible arcs have been selected and no job is waiting for allocation, will skip the current decision step until the next event occurs. 

Reward R: The dynamic FAFSP is a disturbance-prone sequential deci-sion problem, where the effectiveness of PDR is evaluated using the tardiness derived from the final scheduling outcome. 

Transition P (st+1 | st, a ): The state transition from step t to t + 1 is governed by the selected PDR. At decision step t, feasible (j, m ) pairs are iteratively assigned according to the rule until no feasible assignment remains. The system then advances to the next decision epoch, which is defined as the earliest occurrence between the next job completion event and the next job arrival event. When a job completes, the corresponding machine becomes available and downstream operations are released. When a new job arrives, additional op-erations and machines are introduced, thereby expanding the feasible (j, m )

set. The resulting state at step t + 1 integrates updated pair-level features, machine workload profiles, and a regenerated feasible arc set, capturing the temporal evolution of the scheduling system. 11 Table 4: The state features at decision step t.                                                                               

> Type Index Value Description
> Order f1[y(t)
> j], j ∈JtProcessing status information each job
> f2[ET (t)
> j], j ∈JtActual processing time each job
> f3[EM (t)
> j], j ∈JtNumber of available processing machines each job Arc f4[PIt
> i
> PPp(AT i×(Bi,p −1) ×(Ap,j −1))] , j ∈JtArrival time for each job
> f6[PIt
> i
> PPp(DT i×(Bi,p −1) ×(Ap,j −1))] , j ∈JtDelivery time of each job on each machine
> f6[PIt
> i
> PPp(P T i×(Bi,p −1) ×(Ap,j −1))] , j ∈JtProcessing time of each job on each machine Resource f7[IT (t)
> m], m ∈MNext available time for each machine
> f8[J(t)
> m], m ∈MNumber of qualified processing jobs for each machine
> f9[CT (t)
> m], m ∈MUtilization of each machine

2.4. Formulation of dynamic PDRs optimization 

In this section, we formulate the optimization problem of finding the dynamic PDRs for FAFSP. The objective is to optimize the tardiness perfor-mance of PDRs across different instances while accounting for disturbances and system-specific characteristics, thereby obtaining scheduling policies that achieve the best generalization performance in each production scenario. To begin with, the space of instances is defined as X , where each instance 

x ∈ X represents a specified structure information such as processing and assembly resource structure, perturbation distribution and order information, material structure, etc. The space of global solutions Y represents all possible solutions across all instances. And an objective function f : X × Y → R that quantifies the performance of a solution in a given instance. Thus, for a specific instance x,feasible solutions form a subset Y(x) ⊆ Y . The objective is to find a solution 

y∗ ∈ Y (x) minimizing tardiness f (x , y) .Define the dynamic scheduler or solver as S that generates solution y ∈Y on the instance x ∈ X of the specific perturbation distribution. The performance of the scheduler is dependent on the applied dynamic PDR, which can be represented as π used to make job-machine decisions based on state as discrete events occur. Dynamic scheduling operates as Eq. 13: 

y = S(x | π) ≈ y∗ (13) The optimization process of PDR involves leveraging an algorithm expert 

G(A)(·) to generate dispatching rules and a G(S)(·) to evaluate and improve these rules. The algorithm expert generates a set of candidate dispatching rules based on a given prompt p, which includes disturbance features, problem 12 descriptions, and existing rule design knowledge, etc. The π belongs to the space of PDRs Π generated by G(A)(·).The schedule expert evaluates the current dispatching rule π by calculat-ing the objective function f (x | π) for each instance x, denoted as F (x | π)

in Eq. 14. 

F (x | π) = f (x | S(x | π)) , ∀x ∈ X (14) The scheduling expert provides feedback to supplement or adjust the π′

design suggestions, limitations, and other information to updata the new prompts p′ for optimizing the next iteration, as Eq. 15. 

p′ = G(S)(· | (π, f (x | π))) , ∀x ∈ X (15) The goal is to maximize the average performance of the PDR across all instances, which is expressed as Eq. 16. 

π∗ ∈ arg min  

> π∈Π

Ex∈X [F (x | π)] , (16) subject to a total computational budget T (e.g., total design runs, evaluation time). Here, Ex∈X denotes the expectation over all instances. The optimiza-tion process aims to find the dispatching rule π∗ that minimizes the expected average performance in instance set X , ensuring optimal scheduling across all problem instances. 

3. Proposed method 

3.1. Overview framework of LLM4DRD 

Dynamic FAFSP involves the integrated and rapid coordination of pro-cessing, assembly, and delivery stages to satisfy complex kitting requirements for multi-product fulfillment. Unlike the traditional method of combining ter-minal symbols, LLM-based dynamic scheduling rule design rapidly matches the semantic representations and design knowledge of dynamic systems to construct domain knowledge-driven PDRs. The proposed LM4DRD frame-work for solving dynamic FAFSP is illustrated in Fig. 1. Upon order arrival, each order is decomposed according to its product structure into correspond-ing processing and assembly jobs awaiting processing in the operation buffer. Assembly only begin once all processing jobs associated with the correspond-ing assembly component are completed. similarly, final delivery is permitted 13 only after all assembly jobs associated with the order have finished. New orders arrive continually at future steps and inevitably disrupt the existing schedule, requiring the production system to re-optimize decisions to mini-mize the adverse impact of dynamic disturbances. This integrated processing and assembly decision process characterized by flexible processing capabilities and stringent kitting constraints, which is modeled as a directed heteroge-neous graph–based decision procedure. At each decision step, feasible (j, m )

pairs are ranked using PDRs derived from the current multi-stage system state. The highest priority (j, m ) pair is selected, scheduled on its machine, and the system state is updated. Features at step t

Elite 

Rule 

Initialization AI-S AI-S 

Analysis 

Refer 

> Pn P3 P2 P1
> Initialize

Design 

Requirement 

Evaluation AI-A AI-A 

Design 

Fitness 

Calculation AI-S AI-S 

Evaluate 

Comprehensive 

Assessment 

> Empirical
> Objective
> Select

Evolution 

> Crossover
> Mutation
> Crossover
> Mutation
> P1 P1
> P2 P2
> P3 P3
> P4 P4 AI-A AI-A

Strengths 

cross AI-A AI-A 

Weakness 

improve 

> Generations

new new 

> Paternal
> generations

Env 1OiO

> ...
> Mp1
> Mp2
> Mpk
> …

Process 

> Ma1
> Ma2
> Mam
> …

Assembly 

…

Deliver y

Job buffer     

> t-1tOn t+ 1
> O2 O1 ...

Decision 

Modeling    

> Iteration
> Mp1 Mpk Ma1 Mam

1

2

3

4

5

6

7

81OiO  

> ... ...
> Grap Dynamic
> Best Priority
> Rule

Event triggered 

sorting of j-m pairs input input           

> 2Mp1
> 2Mpk
> 6Ma1
> 2Mp1
> 8Mam
> ...
> 2Mp1
> 2Mpk
> 6Ma1
> 2Mp1
> 8Mam
> ...

time 

... 

> Mpk

...  

> Mp1
> ...
> O2Arrive
> Mam
> Ma1

... 

> Mpk

...  

> Mp1
> ...
> O2Arrive
> Mam
> Ma1

time 

... 

> Mpk

...  

> Mp1
> ...
> O2Arrive
> Mam
> Ma1
> Output

Figure 1: Dynamic PDR automated design for FAFSP based on LLM4DRD framework. 

These dynamic PDRs are automatically evolved by the LLM4DRD, driven by LLM reasoning and evolutionary principles. LLM4DRD consists of sev-eral modules: elite knowledge guided rule generation, hybrid evaluation, and co-evolution of design knowledge and rules. Two specialized LLM agents are defined: an algorithm expert called LLM-A, proficient in code design and responsible for constructing efficient and diverse PDRs, and a scheduling ex-pert called LLM-S, knowledgeable about production scheduling and capable of analyzing multi-stage system states and PDR behaviors. In the initializa-tion stage, insights from elite strategies guide the construction of the initial 14 population. A subjective and objective hybrid evaluation combining expert analyses with fitness assessment, which is then used to comprehensively as-sess and refine individuals. Subsequently, the two expert agents collaborate through iterations to achieve co-evolution of the algorithm design knowledge with the PDR, which is able to continuously adapt to changes in the system state to generate highly generalized heuristic rules. At each decision step, the evolved PDRs rank candidate (j, m ) pairs based on real-time system char-acteristics, thereby enabling rapid schedule construction until all operations are completed. 

3.2. Automated design of PDRs 

The design process of LLM4DRD-based dynamic PDRs is divided into: coding design, initialization, evaluation and iterative evolution. In the ini-tialization stage, design knowledge extracted from elite strategies is used to construct the initial PDRs set of heuristic rules. Each rule is then assessed through a hybrid evaluation that combines objective performance metrics with expert-based qualitative judgment. The objective evaluation computes the tardiness performance of each rule, while the expert evaluation provides complementary insights grounded in scheduling knowledge. During the evolu-tionary stage, crossover and mutation operations are guided jointly by design knowledge and expert feedback. Empirical suggestions from experts are em-bedded into the generation of new rule candidates, while code-level analysis of existing rules supports structural refinement and innovation. Newly gener-ated rules again undergo hybrid evaluation to ensure consistent performance improvement. 

3.2.1. PDRs Coding 

Unlike traditional encoding schemes based on numerical or symbolic rep-resentations, the individuals in this study do not denote complete scheduling solutions. Instead, each individual is composed of a different semantic tex-tual description of a heuristic rule containing the corresponding description, code, and performance information, shown as A1 in Fig. 2. The code is an implementation of a specific dynamic PDR for sorting job-machine pairs in the moment t of a dynamic multi-stage manufacturing system, filtering the actions to be executed at the next moment. Specifically, each rule individual generated by algorithm generator (LLM-A) consists of three components: 1) Textual description, which summarizes the fundamental idea underlying the heuristic rule. 2) Code block, which 15 A2   

> Description
> Code
> LLM -S
> ce
> Selection Evaluation and
> suggestion
> Individual
> C1
> Crossover
> task
> LLM -S
> ps
> Evaluating
> demand
> Description
> Fitness
> ce
> Evaluati on and
> suggesiton dynamic features

Start 

End ···  

> M2
> Improve
> task
> Suggestion
> Fitness

cs

Feature Fitting 

based Rule 

Evolution 

> An iteration of
> evolution
> An iteration of
> evolution
> An iteration of
> evolution

······ ······    

> Performance indicator
> C2
> Crossover
> task
> Evalution
> M1
> Mutation
> task AI-S AI-S
> EDD
> Description
> Code
> EDD
> Description
> Code
> A1
> Description
> Code ps
> Evaluating
> demand
> Description
> Fitness AI-S AI-S
> A1
> Code
> csce
> Description
> A1
> Code
> csce
> Description
> LLM -AAI-A AI-A LLM -AAI-A
> LLM -AAI-A AI-A LLM -AAI-A
> LLM -AAI-A AI-A LLM -AAI-A
> Ini
> Task
> Dynamic
> features
> Initial
> suggestion
> Ini
> Task
> Dynamic
> features
> Initial
> suggestion

Elite Knowledge guided 

Rule Generation 

Hybrid Evaluation Figure 2: Automated design and evolution process for dynamic PDR. 

provides the executable implementation of the rule. The code must strictly comply with specified function names and input–output formats to ensure portability and compatibility across different scheduling environments. 3) Objective fitness score cs, the numerical performance of the objective is cal-culated by applying the rule to a simulator containing multiple instances. 4) Subjective evaluation and suggestion ce, which are obtained by schedule eval-uator LLM-S to analyze the design ideas, code and numerical performance of the algorithm. In addition, the initial code templates provided can limit the diversity of new algorithms designed by LLM. In order to evolve PDRs that can finely match dual kitting constrained FAFSP, dynamic system state features are input as parameters for all PDR functions. These features include different dimensions of order, arc, and machine, as detailed in Table 4. PDRs that can adaptively fit dynamic feature changes can be obtained in order to obtain excellent generalizability performance under different instances. 

3.2.2. Elite knowledge guided rule generation 

In traditional design methods such as GP, initial PDR populations are often generated using random or heuristic strategies to enhance population performance and diversity. Generating individuals through random combi-nations of terminal symbols is inefficient and difficult to extract semantic 16 Algorithm 1 Elite knowledge guided rules generation mechanism  

> 1:

Input: Instance set X , elite rule π0, population size of PDR P, temper-ature of LLM u,temperature setting range (Ulow , U up ). 

> 2:

Output: Initial PDR population P 0 and temperature u0; 

> 3:

Creating parallel environments with X to construct the simulator E(·); 

> 4:

Initialize the algorithm generator G(A)(·) and schedule evaluator G(S)(·); 

> 5:

Get the elite rule π0 and prompt elements (C A/CS , cf , cc, cs, ce); 

> 6:

F (X | π0) ← E(X | π0); 

> 7:

cf ← calculate the dynamic features;  

> 8:

cc, cs, n, F best ← π0, F (X | π0), 1, V ; 

> 9:

pS ← (C S , cf , cc, cs). 

> 10:

ce ← G(S)(· | pS ); 

> 11:

while p ≤ P do  

> 12:

u ← Ulow + p × (Uup − Ulow )/P); 

> 13:

pA ← (C A, cf , cc, cs, ce); 

> 14:

π′ ← G(A)(· | (pA, u )) ; 

> 15:

if π′ is valid then  

> 16:

F (X | π′) ← E(X | π′); 

> 17:

P 0 

> n

← (π′, F (X | π′)) ; 

> 18:

p ← p + 1 ; 

> 19:

if F (X | π′) ≤ Fbest then  

> 20:

u0 ← u; 

> 21:

end if  

> 22:

end if  

> 23:

end while 

information from them. To overcome these limitations, this study proposes an elite knowledge guided rule generation mechanism, the details as shown in Algorithm 1. Leveraging the elite rule π0, the schedule evaluator G(S)(·),and the algorithm generator G(A)(·), a structurally diverse and performance-robust initial population of heuristic dispatching rules P 0 is constructed, providing a high-quality starting point for subsequent co-evolutionary opti-mization. During the initialization phase, parallel simulation environments are cre-ated based on the instance set X to construct the scheduling simulator E(·).17 Subsequently, the algorithm generator G(A)(·) and the scheduling schedule evaluator G(S)(·) are initialized, and an elite rule π0 is selected as the initial guiding benchmark. For example, the classical EDD rule is adopted as π0 due to its stability and structural clarity. The rule is executed in the simulator to obtain its performance F (X | π0). The dynamic features cf , executable code 

cc, and performance score cs are extracted to construct the expert evaluation prompt pS = (C S , cf , cc, cs).The expert model G(S)(·) then outputs an evaluation ce of the elite rule based on pS , summarizing the advantages and limitations of π0 in the current scheduling environment and providing actionable improvement directions. Unlike conventional textual comments, ce is explicitly incorporated into the generation prompt for the algorithm generator, thereby injecting domain knowledge directly into the construction of new rule individuals. In the rule generation phase, the algorithm iteratively constructs individ-uals until the population size N is reached, following the logic in Line 11 of the Algorithm 1. The population size of PDR is P, and the system adapts the LLM sampling temperature using u = p × U/ P, ensuring that early generations favor conservative structures while later generations enhance di-versity. A generation prompt pA = (C A, cf , cc, cs, ce) is constructed and input into G(A)(· | (pA, u )) to generate a candidate rule π′. If π′ satisfies syntax, function interface, and scheduling semantics requirements, its performance 

F (X | π′) is evaluated in the simulator and the individual (π′, F (X | π′)) 

is added to the initial population P 0. At the same time, the system checks structural differences between π′ and existing rules to avoid redundancy and enhance semantic diversity. When F (X | π′) is better than the current best 

Fbest , the corresponding temperature is recorded as u0 for subsequent tem-perature control strategies. Through this elite knowledge guided mechanism, the initial population not only preserves the core scheduling logic of the elite rule π0 but also in-corporates the improvement directions revealed by the expert evaluation ce,resulting in a rule set that is both high-performing and structurally diverse. This high-quality initial population substantially improves the search start-ing point for the evolutionary algorithm, providing a solid foundation for subsequent hybrid evaluation and co-evolution of knowledge and rules. 

3.2.3. Hybrid evaluation 

In existing evaluation methods for scheduling rules, individuals are typ-ically assessed solely using quantitative metrics, specifically the objective 18 value F (X | π) of the schedule obtained by applying a rule π to the test instance set X . However, a single quantitative measure is insufficient to characterize the applicability of rules in dynamic multi-stage scheduling en-vironments and nor to reveal latent strengths or limitations. For instance, a rule may perform moderately under standard conditions but exhibit superior performance under specific disturbances, which cannot be captured by ob-jective value alone. Moreover, purely numerical comparison rarely provides actionable guidance for evolutionary improvement. To address these limitations, a hybrid evaluation method is proposed, in-tegrating quantitative metrics and qualitative expert analysis. As illustrated in the Algorithm 2, each newly generated rule π′ is first evaluated objec-tively by the simulator E(X | π′) to calculate tardiness or other performance indicators F (X | π′). If the rule fails to execute, it is deemed invalid and prioritized for elimination, ensuring the efficiency and quality of evolutionary optimization. If the rule executes successfully, it undergoes an experiential evaluation stage. In this stage, LLM-S produces evaluation information ce,incorporating the rule’s textual description CS , dynamic features cf , code features cc, and initial scores cs. LLM-S outputs a comprehensive report, detailing the advantages, limitations, and specific improvement suggestions for the rule. This dual-layer evaluation mechanism allows a holistic under-standing of rule characteristics, providing clear guidance for subsequent rule generation and evolutionary refinement. By combining quantitative assessment with expert knowledge, it ensures that the initial population is both high-performing and diverse, thereby es-tablishing a strong foundation for subsequent evolutionary search. 

3.2.4. Co-evolution of design knowledge and rules 

In conventional evolutionary algorithms, the optimization process re-lies on selection, crossover, and mutation operations. However, traditional crossover often fails to exploit parent-specific semantic characteristics, and mutation lacks guided direction, limiting the effective transfer of advanta-geous traits. To overcome these limitations, a feature fitting based rule evo-lution mechanism is proposed, which integrates the experiential evaluation 

ce generated by hybrid evaluation into the evolutionary process, the detail as shown in Algorithm 2. During the co-evolution procedure, each neighborhood strategy n ∈ N 

triggers a complete round of knowledge–rule interactive evolution (e.g. C1, C2, M3 and M4 in Fig. 2). Parent individuals are first selected via Tourna-19 Algorithm 2 Co-evolution of design knowledge and rules  

> 1:

Input: Maximum number of iterations K, instance set X , initial PDR population P 0, temperature u0, dynamic scheduling simulator E(·),prompt neighborhood strategies N , dynamic features cf ,algorithm gen-erator G(A)(·) and schedule evaluator G(S)(·). 

> 2:

Output: The optimal PDR π∗; 

> 3:

Initialize the prompt elements (C A/CS , cf , cc, cs, ce); 

> 4:

P, F best ← P 0, V  

> 5:

for k = 1 , . . . , K do  

> 6:

OP i ← ∅ ▷ Initialize the offspring set  

> 7:

for n ∈ N do ▷ Execute strategies one by one  

> 8:

C(A) ←Get the problem and task description in strategy n; 

> 9:

j ← Get the number of parent PDR needed in strategy n; 

> 10:

P S ← Determine j parent PDRs by TournamentSelection;  

> 11:

cc, cs ← Get the code and scores of parent PDR π in P S ; 

> 12:

if whether evaluation is required in n then  

> 13:

pS ← (C S , cf , cc, cs); 

> 14:

ce ← G(S)(· | pS ); 

> 15:

pA ← (C A, cf , cc, cs, ce); 

> 16:

else  

> 17:

pA ← (C A, cf , cc, cs); 

> 18:

end if  

> 19:

π′ ← G(A)(· | (pA, u 0)) ; 

> 20:

if π′ is valid then  

> 21:

F (X | π′) ← E(X | π′); 

> 22:

OP i = OP i ∪ (π′, F (X | π′)) ; 

> 23:

if F (X | π′) ≤ Fbest then  

> 24:

π∗ ← π′; 

> 25:

end if  

> 26:

end if  

> 27:

end for  

> 28:

P ← OP i ▷ Replace population by offspring  

> 29:

end for 

20 ment Selection strategy to form the set P S . Their code representations and scheduling performance are extracted to form (c c, cs). Depending on whether semantic evaluation is required, a prompt pS is constructed as (C S , cf , cc, cs)

and the evaluator G(S) produces the semantic assessment result ce. In prac-tice, this evaluation process simultaneously receives the best and worst ob-jective values in the current population, the textual description of the rule being evaluated, and its objective performance. Based on these inputs, LLM-S generates a structured assessment report consisting of: 1) an analysis of the rule’s advantageous features in scheduling; 2) a semantic summary of its po-tential limitations; and 3) targeted improvement suggestions. This semantic information, together with numerical performance, forms a knowledge input that guides the direction of subsequent rule generation. The second prompt 

pA is then constructed as (C A, cf , cc, cs) and the algorithmic generator G(A)

produces the offspring rule under temperature u0 as Eq. 17. 

π′ ∼ G(A)(· | (pA, u 0)) (17) This generation process naturally realizes two types of crossover opera-tors. When the prompt emphasizes the advantageous features and perfor-mance of the parent individuals, G(S) actively integrates the high-quality traits reflected in cs and ce, forming a dominance-fusion crossover. When the prompt weakens parental constraints to encourage exploration, the process becomes an exploratory crossover, enabling the generation of structurally novel rules that expand the search space. Hence, crossover is no longer de-pendent on fixed operators but is automatically regulated through prompt structure and semantic content, enabling deep recombination of parental rule structures. During the improvement phase, the prompt similarly unifies two distinct improvement operators. When the prompt incorporates improvement sugges-tions from ce, the generator performs directed refinement of the parent rule, achieving the effect of a directed optimization operator. When the prompt emphasizes key parameters in the rule code cc and their functional roles, the generator explores the parameter space and adaptively adjusts critical variables, corresponding to a parameter tuning operator. Both operators are implicitly implemented by G(A), in contrast to explicit traditional operators. The generated offspring rule π′ undergoes feasibility checking and schedul-ing performance evaluation as Eq. 18. 

F (X | π′) = E(X | π′) (18) 21 The evaluation results are used to update the best rule π∗ and the next-generation population OP i. Parent selection ensures that high-quality rules influence subsequent generations, while temperature u0 controls exploration to maintain a balance between performance and diversity. Through this mechanism, crossover and improvement operations are no longer governed by static operators but are dynamically driven by the inter-action among prompts, semantic evaluation, and the generator. This enables continuous interplay and mutual reinforcement between domain knowledge and rule structures throughout the iterative cycles. Consequently, the rule population evolves under the joint influence of numerical fitness and seman-tic knowledge, yielding scheduling rules that exhibit greater robustness and broader applicability. 

3.3. Prompt strategies 

The evolution of algorithms in LLM-based AHD relies on sophisticat-edly designed prompts. In LLM4DRD, the algorithm expert LLM-A and the scheduling expert LLM-S undertake distinct analytical and design tasks, with structured prompt strategies effectively defining task requirements. As illustrated in Fig. 3, the framework employs two distinct prompt templates, 

pS and pA, to drive the schedule evaluator G(S) and the algorithm generator 

G(A) respectively. The prompt pS is specifically designed to activate the evaluation capa-bility of the schedule evaluator G(S). Besides the delayed fitness perfor-mance, pS integrates information such as the current individual’s code cc,its objective fitness F (X | π), and the dynamic features of the manufactur-ing system cf . Furthermore, to generate insightful evaluation feedback ce,the prompt additionally provides the performance and descriptions of the “best” and “worst” rules discovered within the PDRs population. The tem-plate instructs the LLM to “evaluate the following heuristic rules based on the above information” , thereby forcing the model to identify specific strengths and weaknesses relative to the historical performance baselines rather than evaluating the rule in isolation. The prompt pA drives the generation of new PDRs. It integrates the eval-uation feedback ce from pS with specific evolutionary operator instructions 

CA. By manipulating the task description in the prompt, we implement four distinct evolutionary operators: C1: Dominance-Fusion Crossover aims to combine the strengths of operators to design new high-performance op-erators. This prompt establishes a context involving two parent PDRs and 22 Prompt pAAI-A AI-A 

Cc : Code    

> •De scription
> •Function name
> •Input & Output AI-S AI-S

Cs : Score      

> •Fitness value
> F(X|π)
> : Evaluation
> •Strengths & Weaknesses
> •Suggestions

Cf : Dynamic features    

> •Initial order count
> •New order count
> •Arrival frequency distribution

Prompt pS

cf: Dynamic features    

> •Initial order count
> •New order count
> •Arrival frequency distribution

Candidate rule π' Evaluation 

G(A) ( ·) G(S) ( ·) 

CA    

> •Role : a lgorithm expert
> •Task :
> dominance -fusion crossover ,
> exploratory crossover ，
> directed optimization ，
> parameter tuning

CS   

> •Role : schedule ex pert
> •Task :
> evaluation

Cs : Score    

> •Fitness value
> F(X|π)

Cf : Dynamic features    

> •Initial order count
> •New order count
> •Arrival frequency distribution

Cc : Code    

> •De scription
> •Function name
> •Input & Output

Figure 3: Design strategies and prompt engineering. 

instructs the LLM: “Please design a new algorithm by combining the advan-tages of the two provided algorithms.” This encourages the model to merge the structural strengths of parent PDRs into an excellent offspring. C2: Ex-ploratory Crossover forces the LLM to design a novel PDR, preventing premature convergence and escaping local optima. The prompt provides par-ent code but explicitly states: “Please help me create a new algorithm that is completely different in form from the given one” . This instruction prevents the LLM from simply mimicking the parent code, triggering the generation of new algorithmic structures. M1: Directed Optimization aims to lo-cally refine algorithms by focusing on logical refinement. It leverages the explicit suggestion field within evaluator feedback Ce. Prompts feed parent code and suggestions into the generator while specifying “Please improve the given algorithm based on the suggested enhancements” . This translates nat-ural language suggestions into code-level optimizations. M2: Parameter Tuning focuses on numerical refinement rather than structural change. The prompt instructs the LLM to “identify the main algorithm parameters, then create a new algorithm that has a different parameter settings of the score function provided” . This guides the LLM to perform fine-grained adjust-ments to weights and thresholds within an existing logic structure. Finally, to ensure the generated code is executable, all prompts include 23 strict formatting constraints, requiring the output to be a Python function 

cal_priority with specific input and output variables. 

3.4. Evolution and Application Process 

The evolution and application of LLM4DRD rules form a closed-loop mechanism oriented toward real manufacturing systems through offline de-sign and online scheduling, as illustrated in Fig. 4. The offline design phase is not merely concerned with algorithm optimization in a simulated envi-ronment; rather, it constructs a scheduling environment via digital twins or numerical simulations that realistically reproduces actual production condi-tions based on the resource structure, machine load, and disturbance dis-tribution. Within this environment, LLMs drive the generation, evaluation, and refinement of scheduling rules, enabling these rules to fully adapt to the dynamic characteristics of manufacturing scenarios in terms of structural rep-resentation, semantic logic, and robustness. Concurrently, the offline phase continuously distills scheduling knowledge from historical operational data and expert experience, encoding it into prompts interpretable by the model. This ensures that rule evolution follows a well-defined direction and main-tains stable performance under diverse loads and disturbances. Once the rules meet the expected scheduling performance, they can be adopted as candidate schedulers for real systems. AI-S AI-S Elite design 

> thought
> extraction

Scheduler      

> (PDR)
> Trigger
> Decision All orders
> completed ?
> N
> YDynamic evaluation
> of response
> scheduling PDR
> End
> Collection and
> processing of
> instances
> Environment
> initialization and
> action construction
> Start AI-A AI-A
> PDR
> Design AI-S AI-S
> Analysis &
> suggestions

Scheduler   

> (PDR) Offline
> Design
> Online
> Application
> Meet expected
> performance
> Resource structure, load and
> disturbance distribution 𝐹 x| 𝜋 𝜋
> PDR evolution

Figure 4: Offline design and online application process of LLM4DRD. 

24 The online scheduling phase targets the actual order flow: decisions are triggered upon order arrival or machine availability, and the scheduler instan-taneously invokes the high-quality rules generated during the offline phase to execute (j, m ) pairs selection. Scheduling outcomes are continuously moni-tored in the real environment, with the system evaluating the practical effec-tiveness of the rules based on resource utilization, processing waiting times, disturbance responses, and order completion. When necessary, operational instances and their performance are fed back to the offline module to sup-port subsequent evolutionary iterations. This feedback not only helps the model identify potential shortcomings of the rules in complex real-world sce-narios but also allows offline evolution to continuously assimilate the latest production characteristics, thereby achieving co-evolution of scheduling rules and the manufacturing system. Through this offline–online cycle, scheduling rules can progressively adapt to the dynamic changes of actual production systems, realizing deployable, updatable, and long-term effective intelligent scheduling in real-world environments. 

4. Computational experiments 

The LLM4DRD framework is designed for the automatic generation of PDRs tailored to the dynamic FAFSP with dual constraints, with a partic-ular focus on evaluating the quality of the rules produced under different scenarios. To assess the effectiveness of the proposed approach, a compre-hensive set of experiments is conducted. Section 4.1 describes the problem instances and experimental settings. Section 4.2 investigates key algorith-mic parameters, including different LLMs and temperature configurations. Section 4.3 presents ablation studies to verify the contribution of each mod-ule within LLM4DRD. Section 4.4 compares the proposed framework with state-of-the-art automatic algorithm design methods. To further examine convergence, Section 4.5 provides a visualization and analysis of algorithmic convergence and solution behaviors. Finally, Section 4.6 evaluates the ro-bustness of LLM4DRD against mainstream heuristic rules across 24 problem operating conditions and a total of 480 test instances. 

4.1. Description of instances and implementation 

To the best of current knowledge, no publicly available benchmark exists for the dynamic multi-product delivery FAFSP with dual kitting constraints. Consequently, the experimental evaluation in this study is conducted on a 25 collection of test datasets that integrate real-world industrial instances and synthetically generated instances. The real-world instances originate from the order and resource configuration data of a Chinese home-appliance man-ufacturer within a specific period, including information on order structure, machine resources, and dynamic order arrivals. The generated instances follow the settings commonly adopted in existing dynamic scheduling stud-ies Basir et al. (2018); Lei et al. (2023); Qiu et al. (2024a) for configuring order arrival processes. 

P (X = n) = (1 /2) n (19) 

L = max 



max 

> m=1 ,...,P M JP

X

> j=1

P T j,m + min 

> m=1 ,...,AM JA

X

> j=1

P T j,m ,

max 

> m=1 ,...,AM JA

X

> j=1

P T j,m 

 (20) In the dynamic FAFSP, the multi-level system comprises m1 ∈ { 1, . . . , AM }

assembly lines and m2 ∈ { 1, . . . , P M } processing machines. The structural information of the product is extracted from the actual production data, and the machine qualification set for each operation is determined by a flexibil-ity factor φ. The probability distribution of the number of products n in each order is given by Eq. 19. The processing rate of the assembly lines, 

Va, follows a normal distribution Va ∼ N (8 , 2) , the average processing rate in the processing stage, Vp, is set to 0.8Va. Order due dates follow a uni-form distribution [L(1 − T − R/ 2) , L(1 − T + R/ 2)] , in accordance with the method of Basir et al. (2018), where L denotes the lower bound of the makespan computed as in Eq. 20, and T and R are hyperparameters con-trolling the range of DT i, usually set between 0 and 1. At the initial time, a subset of orders already exists, while subsequent arrivals follow a Poisson process. Specifically, the inter-arrival time between two consecutive orders follows an exponential distribution with mean λ, where λ corresponds to the estimated completion time with load for the average of orders that have ar-rived up to step t − 1, computed according to Eq. 21 and 22. The workload factor is denoted by μ, and the number of dynamically arriving orders is 

α ∈ { 20 , 50 }, and the order arrival times are defined by Eq. 23. To evaluate the performance of LLM4DRD under different order arrival frequencies and production loads, instances with different operating conditions are generated 26 by adjusting (m1, m 2, φ, μ, α ), and various experiments are designed for a comprehensive evaluation. 

ET (t) = X

> i=1 ,...,I (t)



max 

> m=1 ,...,P M

 X

> j=1 ,...,I (t)
> P

P T j,m × (Bi,j − 1) 



+ min 

> m=1 ,...,AM

 X

> j=1 ,...,I (t)
> A

P T j,m × (Bi,j − 1) 

 (21) 

λ = ET (t−1) /(I(t) × μ) (22) 

AT i = AT i−1 + ∆g (23) The application of PDRs and the instance-solving procedure follows the description in the Section 2.3, while the specific differences in experimen-tal settings are supplemented in the corresponding subsections. It is noted that all classical and LLM-generated PDRs exhibit millisecond-level decision times, fully satisfying the real-time requirements of online FAFSP. The im-plementation of LLM4DRD and all comparative algorithms is carried out in Python. All experiments in this study are executed on an Intel Core i5-12600KF processor. 

4.2. Parameters setting and experiment 

The algorithmic parameters of LLM4DRD include the number of gener-ations, the population size, LLMs, and the corresponding temperature set-tings. Following existing studies (Liu et al., 2024a), the number of genera-tions is fixed at 20 in all experiments, and the population size is set to 4-6. Specifically in comparison with AHD methods in section 4.4 the pop size is extended to 6 in order to compare the performance of different AHD meth-ods in detail and to limit the maximum total sampling budget. The specific settings for these comparisons are described in the related experiments. The newly introduced parameters, namely the selected large language model and the temperature values, are investigated separately in order to determine their appropriate configurations. The major differences introduced by using different LLMs concern the quality of the generated PDRs and the computational cost. Therefore, experimental comparisons of all instances Tall , randomly divided training 27 Ttrain and test instances Ttest , are performed in 20 instances of the condition (m1 = 3 , m 2 = 6 , φ = 0 .5, μ = 1 , α = 20 ) to evaluate the tardiness perfor-mance. In addition, the total consumed tokens (Token), the accuracy of the generated code (Acc), the total expenditure (Cost), and a cost performance ratio (Ratio) are recorded. The Cost is the expense consumed to complete the algorithm design task using the commercial API. And the Ratio is calculated as the improvement of the best obtained individual over the EDD baseline divided by the corresponding cost. All results are presented in Table 5.                                           

> Table 5: Comparison of different LLMs.
> LLM Ttrain Ttest Tall Token Acc Cost Ratio QW8 1244.02 1052.85 1148.44 0.37M 80.5% 0.40 0.000647 QW235 1015.66 951.93 983.79 0.38M 94.5% 1.67 0.002133 deepseek chat 1090.51 1074.69 1082.61 0.28M 91.5% 0.65 0.000950 claude 1021.45 896.38 958.91 0.53M 75.0% 5.77 0.007144 gpt-4o-mini 1082.17 974.07 1028.12 0.33M 96.0% 0.09 0.000122

The results indicate that changing the underlying model significantly af-fects both code accuracy and cost. Although QW235 and Claude achieve competitive performance on different sets of instances, both show disadvan-tages in accuracy and total expenditure. It is important to note that the QW model used in this study is open source and may reduce cost when local deployment is available. Considering the overall code generation cost and accuracy, GPT-4o-mini is selected for all subsequent experiments. In the proposed elite knowledge guided rule generation as shown in Al-gorithm 1, different temperature range (Ulow , U up ) settings are used to en-hance the diversity of the initial individuals and to determine the evolu-tion temperature. Following the recommendations from related studies and from model providers, three temperature ranges are examined, including 

[(0 , 1.6) , (0 .3, 1.5) , (0 .5, 1.25)] . Similar comparisons are conducted regarding code accuracy and performance on different sets of instances. The results are reported in Table 6. The experiments show that the temperature setting has a clear influence on the quality of the generated algorithms. According to the documentation provided by model developers, lower temperature values are more suitable for code generation and mathematical reasoning, while values around 1.3 are preferred for general conversation and translation, and even higher values 28 Table 6: Comparison of different temperature range.                        

> (Ulow , U up )Acc Ttrain Ttest Tall u
> (0 ,1.6) 98.00% 1130.84 1104.38 1117.61 0.64
> (0 .3,1.5) 98.50% 1055.5 949.12 1022.31 0.3
> (0 .5,1.25) 97.00% 1133.23 1122.92 1128.06 0.8

are suitable for creative tasks. The range from 0 to 1.6 yields a performance of 1130.84 on the training set with an accuracy of 98%. Narrowing the range to 0.3 to 1.5 further improves the performance to 1055.5, and the corresponding evolution temperature uo shown in Algorithm 2 is determined as 0.3. However, narrowing the range beyond this level results in a decline in both accuracy and performance. Therefore, the medium temperature range is adopted in other experiments. 

4.3. Ablation experiment 

In this section, a series of ablation studies is conducted to evaluate the contribution of each algorithmic component. The examined modules include the elite knowledge guided rule generation, the hybrid evaluation mecha-nism, the dynamic feature encoder, the crossover-prompt strategy, and the improved-prompt strategy. Comparisons with the well-known AHD frame-work EOH and EDD rule are also incorporated. The purpose is to quantify the effectiveness of individual components in mitigating tardiness for the FAFSP under dual kitting constraints. For clarity, the ablated baseline of LLM4DRD is denoted as ERAD, and each proposed module is removed independently. To assess the influence of dynamic disturbance information, all dynamic features are excluded from the prompts while the remaining procedure is kept unchanged; this variant is re-ferred to as EDRD-D. Removing the elite knowledge guided rule generator from the initialization stage results in EDRD-E, while exclusion of the hy-brid evaluation module yields EDRD-S. As crossover and mutation prompts act as essential evolutionary operators, their removal produces EDRD-C and EDRD-M, respectively. To enable a more comprehensive assessment, the LLM-based automated design framework EOH is further included as com-parative baselines. The experimental settings follow those presented in Sec-tion 4.1. Similar to the parameters setting experiment in Section 4.2, the test suite consists of 20 generated instances constructed from real industrial data 29 characteristics. For fairness, all LLM-based methods are executed for 20 iter-ations with a population size of 6. The corresponding results are summarized in Table 8. 

> Table 7: The results of ablation experiment.

Inst. EOH EDRD-D EDRD-S EDRD-E EDRD-M EDRD-C LLM4DRD 1 734.08 2069.73 747.35 887.38 821.57 536.05 639.20 2 581.77 438.82 620.48 395.48 321.13 390.25 454.22 3 1074.32 1064.02 887.40 752.30 950.23 988.15 1021.40 4 1325.32 1270.37 1136.28 1148.73 1022.03 1201.75 1160.25 5 420.72 1438.28 919.80 397.12 542.60 358.33 366.15 6 1362.42 1835.43 1186.40 937.43 1065.28 835.45 938.98 7 311.48 1150.83 225.70 182.30 182.30 156.42 268.07 8 1316.67 1289.72 1534.50 1216.97 1276.90 1295.12 1257.57 9 2502.75 2467.05 2574.93 2492.87 2778.60 2196.85 2316.12 10 1343.53 1425.75 1110.85 1730.53 1571.08 1264.28 1084.40 

11 895.22 872.48 1033.33 762.40 789.05 721.48 903.00 12 849.30 1187.37 765.77 700.42 717.42 614.28 658.47 13 2182.07 1909.73 1948.55 1771.38 1760.90 1925.30 1524.82 

14 1230.95 1167.60 1120.35 1125.17 1016.95 831.73 979.08 15 2068.77 2611.93 1893.15 2583.10 2014.77 2552.82 1572.60 

16 675.93 1537.73 716.18 572.65 511.33 622.30 740.73 17 2046.78 2718.63 1785.90 1620.30 1511.92 1318.43 1219.07 

18 571.28 1109.52 348.93 319.88 273.20 701.12 582.65 19 840.60 1317.52 1168.40 978.22 903.62 1081.67 936.00 20 1249.12 2806.52 1063.65 604.40 597.60 639.75 572.00 

Avg. 1179.15 1584.45 1139.40 1058.95 1031.42 1011.58 959.74 

The general-purpose evolutionary framework EOH, after undergoing evo-lutionary optimization, achieves a result of 1179.15. LLM4DRD obtains the best performance with an average tardiness of 959.74. When dynamic distur-bance features are removed from the prompts, the EDRD-D variant exhibits a substantial deterioration, with the average tardiness increasing to 1584, which is the poorest performance among all variants. This finding highlights the importance of modeling dynamic disturbances. The availability of dy-namic information enables the LLM to design PDRs that respond effectively to stochastic order arrivals. A significant degradation is also observed for EDRD-S, where the experience-based evaluation of LLM-S is removed, and 30 Figure 5: The box plot of tardiness performance for ablation experiment. 

the average tardiness rises to 1139. This demonstrates that experience-driven evaluation provides information that numerical indicators such as tardiness alone cannot capture in the online FAFSP with dual kitting constraints. The improvement suggestions and domain knowledge generated by LLM-S are therefore essential for enhancing algorithmic performance. In the case of EDRD-E, elite rules are removed during population initial-ization, and the average tardiness increases to 1058.95. This indicates that elite rules play an important role in improving the initial population quality and thus provide a more favorable starting condition for subsequent evolu-tionary optimization. Regarding evolutionary prompt strategies, removing the crossover-prompt operator results in an average tardiness of 1011.58, and removing the improvement-prompt operator leads to a value of 1031.42. These observations suggest that crossover prompts are beneficial for main-taining population diversity, while improvement prompts support directed refinement and parameter adjustment. Both operators are positive for achiev-ing superior performance. 31 Overall, the ablation study indicates that the various components of LLM4DRD collectively contribute to performance improvements. Dynamic-feature encoding exhibits the largest observed effect, while elite-rule initial-ization and experience-based evaluation appear to provide supportive bene-fits. The combined influence of these modules helps the framework achieve competitive performance in the dynamic FAFSP. 

4.4. Comparative experiment 

To provide a comprehensive evaluation of the proposed method, LLM4DRD is compared against several representative frameworks for automatic PDRs design. The comparison covers two categories. The first includes estab-lished approaches in traditional Automatic Heuristic Design (AHD), such as GP and GEP. The second includes recent heuristic design frameworks based on large language models, such as Funsearch based on island-model explo-ration (Romera-Paredes et al., 2024), EOH based on evolutionary search (Liu et al., 2024a; Yao et al., 2025), MCTS-AHD based on Monte Carlo tree search(Zheng et al., 2025), ReEvo incorporating reflective reasoning (Ye et al., 2024), and Random repeated prompt LLMs to generate heuristic with-out an iterative search framework (Zhang et al., 2024). To ensure fairness, the dynamic features used in LLM4DRD for the dynamic FAFSP are added to the terminal sets of GP and GEP. All LLM-based approaches adopt the same template for PDR construction and are permitted to access the same dynamic features. Each method is evaluated in terms of its convergence effi-ciency and the performance of the rules generated on the training set, followed by an assessment of stability and generalisation on test instance set. In par-ticular, twenty dynamic FAFSP instances that correspond to real industrial characteristics ( m1 = 3 , m 2 = 6 , α = 0 .5, μ = 2 , α = 20 ) are selected, and ten of them are randomly assigned as the training set. Each method is indepen-dently conducted for five PDRs design tasks with a maximum sampling limit of 200. the limiting population size is the number of prompt strategies 5 or set according to the parameters commonly used for the different methods. The tardiness results of all methods, together with the classical EDD rule, are reported in Table 8, where the average performance, variance, ARI, and ranking over all instances, the training instances, and the test instances are summarised. Note that ARI is average relative improvement, computed as 

(Tcurrent − Pworst )/P worst .The training results show that all AHD methods exceed the EDD baseline with an average tardiness of 8909.21 on the training set, although their gener-32 Table 8: Comparison of different traditional and LLM-based AHD methods. 

Inst. EDD GP GEP RandSample FunSearch EOH MCTS_AHD ReEvo LLM4DRD 

1 18620.87 13779.29 ±1583.03 12888.94 ±676.57 16125.55 ±1072.87 15501.02 ±1276.06 16606.39 ±188.84 16025.71 ±2511.83 16269.56 ±772.33 14918.53 ±738.55 2 6209.37 5206.79 ±171.79 5439.67 ±118.26 5074.58 ±178.02 5180.63 ±194.74 4997.67 ±247.11 5128.14 ±323.62 5025.17 ±82.26 4983.60 ±123.33 

3 14040.38 15286.23 ±620.67 15889.09 ±751.30 14666.24 ±518.11 14920.71 ±500.68 15506.72 ±1690.63 15915.30 ±1628.90 15948.22 ±2414.32 13718.30 ±1322.11 

4 5615.83 4508.49 ±172.44 4494.34 ±82.72 4591.96 ±274.80 4677.21 ±167.20 4397.28 ±140.58 4456.35 ±111.37 4625.54 ±198.97 4427.48 ±183.37 5 8564.67 7129.13 ±844.62 7914.79 ±572.44 6498.42 ±851.99 7259.66 ±581.37 7005.32 ±512.93 7745.51 ±1564.11 7586.26 ±1606.54 6176.54 ±270.17 

6 5401.75 3582.52 ±200.21 3771.46 ±190.15 3692.99 ±199.03 3856.92 ±213.78 3800.25 ±244.37 4026.00 ±370.74 3890.38 ±332.11 3471.25 ±156.75 

7 5306.45 4886.91 ±487.79 5701.90 ±551.75 5212.66 ±299.20 5246.81 ±434.28 5077.85 ±368.14 5634.60 ±249.19 5355.93 ±359.83 4958.29 ±388.79 8 3113.85 2619.01 ±196.23 2716.35 ±99.73 2444.02 ±238.98 2413.26 ±130.94 2426.47 ±101.31 2434.68 ±204.44 2584.65 ±317.76 2421.06 ±49.40 9 15820.28 16733.99 ±1786.72 17773.62 ±1165.02 15335.59 ±371.19 15147.89 ±759.68 14181.08 ±777.92 14345.73 ±710.97 14586.37 ±446.35 15066.96 ±712.06 10 6398.62 5645.15 ±715.20 6595.46 ±361.02 5042.04 ±244.70 5178.99 ±202.42 6073.79 ±594.05 5576.02 ±856.01 5624.99 ±715.46 4889.82 ±290.04 

11 3150.55 3482.09 ±705.00 4013.67 ±387.63 2937.59 ±160.20 2866.28 ±106.43 2877.80 ±97.69 3049.71 ±245.76 2978.32 ±106.57 2852.79 ±78.30 

12 4689.78 4144.37 ±639.18 4646.20 ±306.09 3770.40 ±86.07 3778.30 ±194.73 3761.24 ±102.24 3879.92 ±116.97 4008.66 ±241.41 3873.35 ±167.08 13 4028.45 5614.78 ±2235.00 6623.13 ±1159.47 3728.43 ±206.27 3596.64 ±324.88 3400.84 ±206.78 4440.97 ±1464.87 4012.66 ±495.46 3659.26 ±397.92 14 6514.52 6787.40 ±1972.00 8648.84 ±926.04 5572.10 ±627.87 5920.40 ±682.68 6606.24 ±258.01 6361.14 ±746.49 6560.46 ±1341.46 5580.81 ±125.47 15 4713.58 4384.48 ±546.86 4413.90 ±499.63 4331.87 ±633.85 4089.39 ±610.40 4267.29 ±723.96 4007.20 ±520.46 4126.82 ±529.14 4036.83 ±469.30 16 6737.87 4182.07 ±393.73 4096.37 ±418.56 4367.37 ±449.91 4122.71 ±348.62 4645.99 ±397.15 4613.52 ±739.17 4708.95 ±485.15 4647.74 ±496.72 17 3703.18 3580.72 ±785.35 3972.45 ±576.08 3044.10 ±65.45 3055.83 ±283.83 2903.73 ±350.81 3352.39 ±514.33 3297.65 ±374.09 2917.49 ±175.23 18 7465.48 5719.70 ±561.44 5780.75 ±886.59 6147.06 ±388.24 6054.04 ±657.44 5706.07 ±296.73 5467.42 ±465.49 5954.54 ±919.65 5812.73 ±361.15 19 4701.47 3161.73 ±440.12 3559.27 ±168.68 3312.39 ±248.78 3259.23 ±209.67 3216.57 ±286.64 3395.24 ±266.54 3617.67 ±495.06 3269.54 ±279.56 20 4349.80 4153.66 ±324.39 4050.97 ±113.20 4302.82 ±235.88 4043.24 ±128.26 4030.14 ±228.55 4275.04 ±572.39 4007.00 ±207.92 4079.78 ±179.66 All 6957.34 6229.43 6649.56 6009.91 6008.46 6074.44 6206.53 6238.49 5788.11 

ARI 0.00% 10.46% 4.42% 13.62% 13.64% 12.69% 10.79% 10.33% 16.81% 

Rnk 9 6 8 3 2 4 5 7 1

Train 8909.21 7937.75 8318.56 7868.41 7938.31 8007.28 8128.80 8149.71 7503.18 

ARI 0.00% 10.90% 6.63% 11.68% 10.90% 10.12% 8.76% 8.52% 15.78% 

Rnk 9 3 8 2 4 5 6 7 1

Test 5005.47 4521.10 4980.56 4151.41 4078.61 4141.59 4284.26 4327.27 4073.03 

ARI 0.00% 9.68% 0.50% 17.06% 18.52% 17.26% 14.41% 13.55% 18.63% 

Rnk 9 7 8 4 2 3 5 6 1

alisation behaviour varies across methods. When the dynamic-feature termi-nal set is incorporated, GP achieves better performance than GEP, improving tardiness by approximately 10.90% and reaching 7937.75. Among the LLM-based approaches, the Repeat-Prompt method attains the best performance, ranking closely behind GP and LLM4DRD. EOH achieves an average tar-diness of 8007.28, corresponding to an improvement of 10.12%. In contrast, ReEvo, which integrates reflective reasoning, exhibits degraded performance with an average tardiness of 8149.73. FunSearch and MCTS-AHD, which utilise island-model exploration and Monte Carlo tree search respectively, yield improvements of 10.90% and 8.76%. LLM4DRD achieves the best performance in all four evaluation categories and obtains the lowest average tardiness on the training set, improving upon EDD by 15.78%. On the test set, FunSearch exhibits slightly lower perfor-33 GP GEP RandSample FunSearch EOH MCTS_AHD ReEvo LLM4DRD 

> 2500
> 5000
> 7500
> 10000
> 12500
> 15000
> 17500
> 20000
> Tardiness (min) Figure 6: The box plot of tardiness performance in different AHDs.

mance than LLM4DRD, with an average tardiness of 4078.61. Notably, GP fails to maintain its favourable training performance and shows substantial degradation on the test set, reaching 4521.10. Compared with EDD and GP, the rules produced by LLM4DRD improve performance by 9.68% and 18.63% respectively. Unlike methods whose performance appears to reflect overfitting to the training set, LLM4DRD benefits from a more consistent exploitation of problem-structure information, thereby generating rules with stronger generalisation ability. The boxplots of the performance of all AHD methods on 20 instances are shown in Fig. 6. Where the red icons represent the mean performance of the different methods and are connected using black lines. Overall, LLM4DRD achieves the best performance across all twenty instances, resulting in an average improvement of 16.81%. In addition to performance levels, the convergence behaviour of the gen-erated PDRs over the ten test instances provides further insight into the relative strengths of the AHD methods. The convergence curves in Fig. 7 are 34 25 50 75 100 125 150 175 200 

> Number of Samples
> 10 4
> 8 × 10 3
> 9 × 10 3
> Average Tardiness of the Training Set
> GP
> GEP
> RandSample
> FunSearch
> EOH
> MCTS_AHD
> ReEvo
> LLM4DRD

Figure 7: Convergence of different AHDs. 

produced by evaluating the best rule discovered after a given number of sam-ples. GP identifies a superior PDR within approximately seventy samples and achieves the best early-stage performance among all methods. GEP, Rand-Sample, and FunSearch also produce strong initial individuals, but similar to other approaches, they converge prematurely around an average tardiness of 8.15 × 10 3, with limited improvement thereafter. In contrast, LLM4DRD, despite starting from weaker initial individuals, surpasses the current best performance on eight occasions within two hundred iterations and contin-ues to improve after one hundred samples. This behaviour demonstrates that LLM4DRD is able to incorporate experience and structural insights from the dynamic dual kitting FAFSP, enabling the continuous generation of high-quality PDRs. 

4.5. Iterative process analysis 

This section aims to provide an interpretability analysis of the proposed framework. Unlike traditional black-box optimization methods, the explicit 35 code generation capability of LLM4DRD allows us to trace the logical evo-lution of PDRs. The primary purpose of this analysis is to validate that the observed performance gains stem from a progressive accumulation of domain-specific scheduling knowledge rather than stochastic search, and to demon-strate how the framework autonomously discovers, refines, and integrates complex adaptive strategies through an interpretable evolutionary path. Throughout this convergence process, the schedule evaluator LLM-S plays a pivotal role in ensuring continuous improvement. LLM-S functions not merely as a selector but as a "semantic navigator" that directs the evolu-tionary search. By analyzing the structural logic and performance feedback of candidate rules, LLM-S generates actionable textual suggestions—such as identifying weight imbalances or logical deficiencies to guide the algorithm generator LLM-A in performing optimization. This mechanism effectively bridges the gap between quantitative objective metrics and qualitative code structures, enabling the optimization process to resolve complex logical con-flicts that numerical fitness alone cannot address. From the perspective of the convergence curve illustrated in Fig. 8, the specific contributions of the proposed modules are evident across different phases of the optimization. In the initial 25% of the process (approximately samples 1-50), the curve exhibits a rapid descent driven by structural ex-ploration, establishing a strong baseline. Notably, even after the optimiza-tion progresses beyond 75% (post-sample 150), a phase where traditional heuristics typically plateau, the curve demonstrates a significant secondary convergence, dropping from an objective value of 7581.21 to 7371.61. This sustained late-stage improvement highlights the critical effectiveness of the Hybrid Evaluation module. By combining quantitative fitness metrics with qualitative expert analysis, the module identifies subtle semantic constraints, such as “ Added a historical performance factor to refine utilization estimates and feedback loops ”, which cannot be revealed by numerical indicators alone. This deep semantic feedback provides the necessary guidance for the Directed Optimization operator to perform precise feature fitting, successfully inject-ing advanced dynamic features like predictive processing times to achieve superior robustness and break through local optima. 

4.6. Comparison under different conditions 

To evaluate the robustness of the rules generated by the algorithm under diverse operational conditions, LLM4DRD is compared with the commonly used PDRs in industrial practice. A total of 24 scenarios are constructed by 36 # LLM4DRD 

This new algorithm combines adaptive scheduling techniques, real -time feedback loops, 

and advanced estimation methods for processing times to dynamically prioritize jobs based 

on urgency, resource availability, and machine utilization. 

Number of samples 

> Performance(objective)

def cal_priority (status , num_qmachines_job, processing_time , arrival _time , delivery_time ,

available_time , num_qjobs_machine , utilization , processing_ at ): 

# Dynamic Prediction 

actual_tm = processing_ at * ( 1 + utilization ) if processing_ at > 0 else 1

pred_tm = actual_tm * ( 1 + utilization )

# Calculate Components (using inline conditionals) 

val_delivery = ( delivery_time / 5) if delivery_time > 0 else 0

val_avail = ( 1 / available_time ) if available_time > 0 else 1

val_pred = ( pred_tm / ( processing_time + 2)) if pred_tm > 0 else 1

val_util = ( 0.5 / ( utilization + 0.1 )) if utilization > 0 else 0.5 

val_neigh_m = ( 1 / ( num_qmachines_job + 2)) if num_qmachines_job > 0 else 1

val_neigh_op = ( 0.2 / ( num_qjobs_machine + 2)) if num_qjobs_machine > 0

else 0.5 

# Aggregate & Return (including buffer=1) 

priority 

= val_delivery + val_avail + val_pred + val_util + val_neigh_m + val_neigh_op + 1

return priority AI-A AI-A 

9996.23 

8058.77 

7371.61 

Strengths: Balances machine utilization and task urgency through real -time feedback. 

Weaknesses : Overlooks specific job -machine efficiencies, potentially causing bottleneck delays. 

Suggestions :

Incorporate Critical Ratio to prioritize tasks with tight deadlines. 

Prioritize machine -job pairs with shorter processing times. 

Implement look -ahead logic to prevent downstream machine starvation. AI-S AI-S 

1 50 100 150 200 AI-S AI-S 

# ... 

7645.20 

Added inverse logic for utilization 

if utilization > 0: 

priority += 1 / utilization 

Added rank -based scoring and neighbor data 

priority += delivery_time * 2 

priority += 1 / ( num_qmachines_job + 1) 

Retuned weights to prioritize delivery 

priority += delivery_time * 3 

priority += 1 / (utilization + 0.1) 

Applied normalization to stabilize calculation 

priority += (delivery_time / 10) 

priority += (processing_ at / (processing_time + 1)) 

Reduced processing time impact 

priority += (processing_ at / (processing_time + 2)) 

Incorporated predictive processing time 

predicted_processing_time = processing_ at * (1 + utilization) 

priority += (predicted_processing_time / (processing_time + 2)) 

Added a historical performance factor to refine utilization estimates 

and feedback loops 

utilization_factor = (utilization + historical_performance) / 2 

predicted_processing_time = processing_tm * (1 + utilization_factor) AI-A AI-A 

The objective of the 

EDD is 8909.21 

7581.21 

8047.25 

7958.59 

7795.20 

7544.92 

Input 

[status ←f1 , processing_ at ←f2 , num_qmachines_job ←f3 ,

start_time ←f4 , delivery_time ←f5 , processing_time ←f6 ,

available_time ←f7 , num_qjobs_machine ←f8 , utilization ←f9 ]

Output 

Priority: j-m Arcs Priority AI-S AI-S AI-A AI-A Figure 8: Convergence analysis for dynamic PDR evolution. 

varying the machine configuration m = m1 × m2 ∈ [3 -6, 5-12] , the flexibility factor φ ∈ [0 .5, 0.7] , the number of newly arrived orders α ∈ [20 , 50] , and the load factor μ ∈ [1 , 2, 4] , resulting in 480 instances (20 instances per scenario). Higher values of μ correspond to more frequent order arrivals. All 24 scenarios are analyzed using independent testing to assess the algorithm under extreme conditions with significant changes in data characteristics. For comparative analysis, EDD rules with significant performance for tardiness optimization are used as benchmarks. In addition, four PDRs for job selection (FIFO, MOPNR, LWKR, MWKR) and two rules for machine assignment (SPT, EET) are combined to form eight hybrid heuristic methods (Lei et al., 2023). These eight combinations, together with the baseline EDD, constitute nine 37 comparative schemes against which LLM4DRD is systematically evaluated. Experimental settings follow the description in Section 4.1 and 4.2, and all results are shown in Table 4.6. 

Table 9: The results of robust experiment. 

m-φ-α-μ EDD FIFO +SPT FIFO +EET MOPNR +SPT MOPNR +EET LWKR +SPT LWKR +EET MWKR +SPT MWKR +EET LLM4DRD 

3-6-0.5-20-1 1675.2 1580.57 1803.07 2024.89 2218 1761.98 2039.19 2096.66 2348.14 930.01 

3-6-0.5-20-2 6850.15 6568.14 6619.29 7417.1 7076.19 5969.4 6223.92 7852.59 7972.87 5349.56 

3-6-0.5-20-4 12722.72 12810.73 12458.52 16115.26 14466.17 12509.85 12413.97 16934.82 16879.16 10960.59 

3-6-0.5-50-1 4036.64 2643.36 3388.03 2864.89 3466.07 2638.62 3267.12 2781.28 3487.18 2320.67 

3-6-0.5-50-2 11913.81 10279.94 10632.81 11581.93 11974.4 9788.22 10342.35 12105 12599.85 8865.12 

3-6-0.5-50-4 29020.88 28887.8 28822.78 36703.24 34635.81 27118.36 27855.39 40960.79 41318.65 23680.27 

3-6-0.7-20-1 1633.23 1510.61 1739.24 1797.58 1900.72 1528.83 1698.24 1795.79 1934.15 990.74 

3-6-0.7-20-2 5268.17 4712.56 4996.77 5862.59 5661.98 4978.33 5231.74 6107.61 6106.94 3804.25 

3-6-0.7-20-4 12886.76 12594.3 12273.12 15132.96 14561.12 11910.25 11961.23 17772.07 17938.49 9636.63 

3-6-0.7-50-1 3090.85 1686.02 2330.64 1705.93 2477.43 1860.31 2393.75 1957.08 2513.05 1618.91 

3-6-0.7-50-2 9775.07 7675.96 8462.56 7787.81 8953.13 7710.19 8410.5 8454.95 9292.1 7316.64 

3-6-0.7-50-4 29824.89 30262.73 29862.71 36003.82 34038.08 27363.59 27465.06 47768.85 47053.8 20162.97 

5-12-0.5-20-1 926.19 254.24 679.37 235.35 638.93 215.46 663.55 226.98 683.09 164.33 

5-12-0.5-20-2 2955.24 1769.55 2521.01 1800.95 2534.27 1820.29 2514.85 1791.22 2491.89 1588.01 

5-12-0.5-20-4 2701.56 2478.9 2577.86 2719.07 2841.15 2416.44 2634.25 2924.05 3231.56 1867.39 

5-12-0.5-50-1 2353.59 448.32 1310.1 464.55 1345.46 466.86 1294.99 471.7 1377.57 400.8 

5-12-0.5-50-2 7153.09 4085.67 5904.95 4078.58 5892.99 4160.15 5867.7 4308.22 6048.34 3979.69 

5-12-0.5-50-4 8072.17 6518.51 7422.89 7141.25 8177.66 6957.79 7600.55 6961.2 7969.85 5945.66 

5-12-0.7-20-1 970.6 131.13 560.85 128.71 526.61 154.62 528.6 154.35 529.44 98.56 

5-12-0.7-20-2 2812.27 1371.31 2260.69 1394.98 2289.56 1416.27 2299.56 1423.43 2305.15 1250.69 

5-12-0.7-20-4 2367.46 2107.12 2351.8 2206.07 2310.66 1954.6 2239.8 2649.31 2718.52 1438.4 

5-12-0.7-50-1 2272.17 240.48 1336.23 240.56 1346.21 271.61 1375.82 258.12 1379.52 189.02 

5-12-0.7-50-2 6693.23 3258.25 5410.21 3260.91 5460.23 3365.8 5423.32 3343.61 5438.45 3071.99 

5-12-0.7-50-4 6255.66 4750.8 5612.14 4671.56 5490.1 4903.84 5538.34 5151.25 6275.12 4304.81 

Avg. 7259.65 6192.79 6722.40 7222.52 7511.79 5968.40 6553.49 8177.12 8745.54 4997.32 

ARI 16.99% 29.19% 23.13% 17.41% 14.11% 31.75% 25.06% 6.50% 0.00% 42.86% 

Across all 24 configurations, LLM4DRD consistently achieves the best average performance metrics, demonstrating its effectiveness in scheduling. Compared to the EDD baseline, LLM4DRD improves performance by ap-proximately 45–65%. For example, under the configuration (3-6-0.5-20-1), LLM4DRD achieves a tardiness of 930.01, whereas EDD results in 1675.20, 38 corresponding to a 44.5% reduction. Under (5-12-0.7-50-1), the improve-ment reaches 91.7% (LLM4DRD: 189.02 vs. EDD: 2272.17). Relative to the eight hybrid heuristics, LLM4DRD achieves average improvements of 30– 50% and consistently outperforms all rule combinations, such as FIFO+SPT, MOPNR+SPT, and LWKR+EET. The boxplots of the performance of all the methods under different con-ditions are shown in Fig. 9. Under identical resource configurations, higher load factors μ lead to more frequent order arrivals, increasing the difficulty of completing synchronized deliveries and resulting in higher tardiness. For instance, in experiments with m1 = 3 , m2 = 6 , φ = 0 .5, α = 20 , and μ

values of 1, 2, and 4, average tardiness increases from 930 to 10,961, with similar trends observed in other scenarios. This indicates that higher order arrival frequency imposes greater demands on the algorithm’s responsiveness to disturbances. LLM4DRD demonstrates strong robustness under high-load conditions. For example, under (3-6-0.7-50-4), LLM4DRD achieves a tardi-ness of 20,162.97, reducing total tardiness by 6,200.62 (26.31%) compared to the best-performing rule in the same scenario (LWKR+SPT: 27,363.59). This suggests that LLM4DRD effectively manages resource contention and mitigates performance degradation under frequent order arrivals. The performance of the eight hybrid heuristics varies across scenarios. For example, FIFO+SPT performs better under low-load conditions, whereas MOPNR+EET exhibits large fluctuations under high-load conditions. How-ever, none consistently outperforms LLM4DRD. On average, LLM4DRD re-duces tardiness by 10% to 30% relative to the best-performing hybrid rule (e.g., LWKR+SPT or MOPNR+SPT), and the advantage becomes more pronounced under extreme conditions with high U and low f . For instance, under (3-6-0.5-50-4), LLM4DRD achieves 23,680.27 compared to 36,703.24 for MOPNR+SPT, a difference of 35.4%. These results indicate that rule-based heuristics are sensitive to parameter variations, whereas LLM4DRD maintains stable performance across diverse and complex scenarios. Overall, the experiments demonstrate that LLM4DRD exhibits robust performance in dynamic flexible assembly flow shop scheduling. Even under extreme variations in resource scale, flexibility, load intensity, and order vol-ume, LLM4DRD consistently outperforms baseline rules and hybrid heuris-tics while maintaining lower performance variability, confirming its reliability and adaptability for practical applications. 39 0.5-20 0.5-50 0.7-20 0.7-50 

0

1000 

2000 

3000 

4000 

5000 

6000 

> Tardiness (min)

(a) machine configuration 2-6 and load factor 1    

> 0.5-20 0.5-50 0.7-20 0.7-50

0

5000 

10000 

15000 

20000 

25000 

30000 

35000 

> Tardiness (min)

(b) machine configuration 2-6 and load factor 2    

> 0.5-20 0.5-50 0.7-20 0.7-50

10000 

20000 

30000 

40000 

50000 

60000 

70000 

> Tardiness (min)

(c) machine configuration 2-6 and load factor 4    

> 0.5-20 0.5-50 0.7-20 0.7-50

0

500 

1000 

1500 

2000 

2500 

3000 

3500 

> Tardiness (min)

(d) machine configuration 5-12 and load factor 1    

> 0.5-20 0.5-50 0.7-20 0.7-50

1000 

2000 

3000 

4000 

5000 

6000 

7000 

8000 

9000 

> Tardiness (min)

(e) machine configuration 5-12 and load factor 2    

> 0.5-20 0.5-50 0.7-20 0.7-50

0

2500 

5000 

7500 

10000 

12500 

15000 

17500 

> Tardiness (min)

(f) machine configuration 5-12 and load factor 4 

EDD 

FIFO+SPT 

FIFO+EET 

MOPNR+SPT 

MOPNR+EET 

LWKR+SPT 

LWKR+EET 

MWKR+SPT 

MWKR+EET 

LLM4DRD Figure 9: The box plot of tardiness performance under different conditions. 

40 5. Conclusion 

This study investigates the automatic design of PDRs for the FAFSP with dynamic order arrivals under dual kitting constraints arising from as-sembly and multi product delivery. An LLM assisted dynamic PDRs De-sign framework named LLM4DRD is proposed to integrate algorithm design knowledge and scheduling analysis expertise for generating rules that adapt to evolving dynamic scheduling features. Multi-level supply decisions associ-ated with processing, assembly, and delivery are jointly modeled as feasible directed edge selections on a heterogeneous graph, which effectively miti-gates decision preference inconsistencies and conflicts across stages. In the initialization stage, high level knowledge extracted from classical dispatch-ing rules is leveraged to guide population construction, thereby improving initial solution quality and accelerating performance convergence. Further-more, a dual-expert mechanism is established by coupling an rule design LLM-A with a scheduling evaluation LLM-S, enabling a hybrid assessment that integrates objective fitness evaluation with experiential reasoning. Dur-ing the evolutionary process, improvement knowledge and search directions are dynamically summarized from the population to guide the continual de-sign of dispatching rules that adapt to dynamic scheduling features, thereby sustaining high performance in online scheduling. The effectiveness of the proposed method is validated through exten-sive experiments, including parameter sensitivity analysis and ablation stud-ies. Results show that the fully integrated LLM4DRD consistently outper-forms all its ablated variants, confirming the contribution of each module. In comparative experiments on 20 instances from real production scenarios, LLM4DRD reduces average tardiness by 3.17-12.39% compared to GP, GEP, and state-of-the-art LLM-based AHD methods. Furthermore, robustness ex-periments conducted on 480 instances covering 24 combinations of resource load levels, disturbance intensities, and order conditions demonstrate that LLM4DRD outperforms the second best competitor by up to 11.10%, indi-cating strong generalization and robustness under diverse dynamic environ-ments. Beyond numerical performance improvements, the robustness and com-parative results provide meaningful managerial insights for integrated schedul-ing in dynamic multi stage manufacturing systems with complex kitting con-straints. Constructing dispatching rules that adapt to evolving scheduling states enables enterprises to maintain stable cross scenario performance un-41 der drastic changes in resource availability and disturbance characteristics, thereby enhancing the efficiency and accuracy of part supply and logistics control in highly responsive environments. Moreover, LLM4DRD offers a novel perspective on managing and utilizing high level domain knowledge by transforming expert experience into an explicit evolutionary guidance mecha-nism, which converts tacit knowledge into a sustainable driver for continuous operational improvement. Future research will consider more complex constraint structures and dy-namic response events, including secondary resource and transportation con-straints as well as concurrent multi type disturbances. Attention will also be directed toward the independent design and integrated solution of dispatch-ing rules for different subproblems in multi stage manufacturing systems, with the aim of balancing heterogeneous decision preferences and objectives across stages. In addition, human machine interaction mechanisms will be explored to enable collaborative rule design guided jointly by artificial in-telligence and expert knowledge, ensuring baseline performance guarantees while supporting multidimensional expression of decision maker preferences and advancing toward human centered intelligent scheduling. 

Acknowledgements 

The work described in this paper was supported by the Research Grants Council of the Hong Kong Special Administrative Region, China (GRF Project No. CityU11217325), the Natural Science Foundation of China (Project No: 62276223, 52375489), and the Guangdong Basic and Applied Basic Research Foundation of China (Project No: 2024A1515011211). 

References 

Allahverdi, A., Aydilek, H., Aydilek, A., 2016. Two-stage assembly scheduling problem for minimizing total tardiness with setup times. Applied mathe-matical modelling 40, 7796–7815. Azizi, V., Hu, G., 2020. Multi-product pickup and delivery supply chain design with location-routing and direct shipment. International Journal of Production Economics 226, 107648. 42 Basir, S.A., Mazdeh, M.M., Namakshenas, M., 2018. Bi-level genetic algo-rithms for a two-stage assembly flow-shop scheduling problem with batch delivery system. Computers & industrial engineering 126, 217–231. Baykasoğlu, A., Özbakır, L., 2010. Analyzing the effect of dispatching rules on the scheduling performance through grammar based flexible scheduling system. International Journal of Production Economics 124, 369–381. Bednarski, L., Roscoe, S., Blome, C., Schleper, M.C., 2025. Geopolitical disruptions in global supply chains: a state-of-the-art literature review. Production planning & control 36, 536–562. Branke*, J., Mattfeld, D.C., 2005. Anticipation and flexibility in dynamic scheduling. International Journal of Production Research 43, 3103–3129. Burke, E.K., Gendreau, M., Hyde, M., Kendall, G., Ochoa, G., Özcan, E., Qu, R., 2013. Hyper-heuristics: A survey of the state of the art. Journal of the Operational Research Society 64, 1695–1724. Cai, J., Lei, D., Wang, J., Wang, L., 2023. A novel shuffled frog-leaping algorithm with reinforcement learning for distributed assembly hybrid flow shop scheduling. International Journal of Production Research 61, 1233– 1251. Chang, D., Shi, H., Liu, C., Meng, F., 2025. Scheduling optimization of flexible flow shop with buffer capacity limitation based on an improved discrete particle swarm optimization algorithm. Engineering Optimization 57, 571–597. Chen, Y., Zhong, J., Mumtaz, J., Zhou, S., Zhu, L., 2023. An improved spider monkey optimization algorithm for multi-objective planning and schedul-ing problems of pcb assembly line. Expert Systems with Applications 229, 120600. Elyasi, M., Selcuk, Y.S., Özener, O.Ö., Coban, E., 2024. Imperialist competitive algorithm for unrelated parallel machine scheduling with sequence-and-machine-dependent setups and compatibility and workload constraints. Computers & Industrial Engineering 190, 110086. Fattahi, P., Hosseini, S.M.H., Jolai, F., Tavakkoli-Moghaddam, R., 2014. A branch and bound algorithm for hybrid flow shop scheduling problem with 43 setup time and assembly operations. Applied Mathematical Modelling 38, 119–134. Hao, H., Zhu, H., 2024. A self-learning particle swarm optimization for bi-level assembly scheduling of material-sensitive orders. Computers & Industrial Engineering 195, 110427. Huang, J., Li, X., Gao, L., Liu, Q., Teng, Y., 2024. Automatic programming via large language models with population self-evolution for dynamic job shop scheduling problem. arXiv preprint arXiv:2410.22657 . Komaki, G., Sheikh, S., Malakooti, B., 2019. Flow shop scheduling problems with assembly operations: a review and new trends. International Journal of Production Research 57, 2926–2955. Lei, K., Guo, P., Wang, Y., Zhang, J., Meng, X., Qian, L., 2023. Large-scale dynamic scheduling for flexible job-shop with random arrivals of new jobs by hierarchical reinforcement learning. IEEE Transactions on Industrial Informatics 20, 1007–1018. Leng, J., Wang, X., Wu, S., Jin, C., Tang, M., Liu, R., Vogl, A., Liu, H., 2023. A multi-objective reinforcement learning approach for resequencing scheduling problems in automotive manufacturing systems. International Journal of Production Research 61, 5156–5175. Li, R., Wang, L., Sang, H., Yao, L., Pan, L., 2025. Llm-assisted automatic memetic algorithm for lot-streaming hybrid job shop scheduling with vari-able sublots. IEEE Transactions on Evolutionary Computation . Liu, F., Tong, X., Yuan, M., Lin, X., Luo, F., Wang, Z., Lu, Z., Zhang, Q., 2024a. Evolution of heuristics: Towards efficient automatic algorithm design using large language model, in: Proceedings of the International Conference on Machine Learning, pp. 32201–32223. Liu, F., Yao, Y., Guo, P., Yang, Z., Zhao, Z., Lin, X., Tong, X., Yuan, M., Lu, Z., Wang, Z., et al., 2024b. A systematic survey on large language models for algorithm design. arXiv preprint arXiv:2410.14716 . Liu, T., Liu, J., Qiu, J., Lai, C., Zhang, Z., 2025. Recent advances in assembly flow shop scheduling and its extensions to distributed manufacturing and integrated supply chain. Computers & Industrial Engineering , 111711. 44 Lu, C.C., Lin, S.W., Ying, K.C., 2012. Robust scheduling on a single machine to minimize total flow time. Computers & Operations Research 39, 1682– 1691. Luo, J., Fujimura, S., El Baz, D., Plazolles, B., 2019. Gpu based parallel genetic algorithm for solving an energy efficient dynamic flexible flow shop scheduling problem. Journal of Parallel and Distributed Computing 133, 244–257. Mo, S., Wu, K., Gao, Q., Teng, X., Liu, J., 2025. Autosgnn: automatic propagation mechanism discovery for spectral graph neural networks, in: Proceedings of the AAAI Conference on Artificial Intelligence, pp. 19493– 19502. Nguyen, S., Mei, Y., Zhang, M., 2017. Genetic programming for production scheduling: a survey with a unified framework. Complex & Intelligent Systems 3, 41–66. Novikov, A., V˜ u, N., Eisenberger, M., Dupont, E., Huang, P.S., Wagner, A.Z., Shirobokov, S., Kozlovskii, B., Ruiz, F.J., Mehrabian, A., et al., 2025. Alphaevolve: A coding agent for scientific and algorithmic discovery. arXiv preprint arXiv:2506.13131 . Ouelhadj, D., Petrovic, S., 2009. A survey of dynamic scheduling in manu-facturing systems. Journal of scheduling 12, 417–431. Ozturk, G., Bahadir, O., Teymourifar, A., 2019. Extracting priority rules for dynamic multi-objective flexible job shop scheduling problems using gene expression programming. International Journal of Production Research 57, 3121–3137. O’Neill, M., Vanneschi, L., Gustafson, S., Banzhaf, W., 2010. Open issues in genetic programming. Genetic Programming and Evolvable Machines 11, 339–363. Pandhare, V., Negri, E., Ragazzini, L., Cattaneo, L., Macchi, M., Lee, J., 2024. Digital twin-enabled robust production scheduling for equipment in degraded state. Journal of Manufacturing Systems 74, 841–857. 45 Qin, Z., Lu, Y., 2021. Self-organizing manufacturing network: A paradigm towards smart manufacturing in mass personalization. Journal of Manu-facturing Systems 60, 35–47. Qiu, J., Liu, J., Li, Z., Lai, X., 2024a. A multi-level action coupling re-inforcement learning approach for online two-stage flexible assembly flow shop scheduling. Journal of Manufacturing Systems 76, 351–370. Qiu, J., Liu, J., Peng, C., Chen, Q., 2024b. A novel predictive–reactive scheduling method for parallel batch processor lot-sizing and scheduling with sequence-dependent setup time. Computers & Industrial Engineering 189, 109985. Romera-Paredes, B., Barekatain, M., Novikov, A., Balog, M., Kumar, M.P., Dupont, E., Ruiz, F.J., Ellenberg, J.S., Wang, P., Fawzi, O., et al., 2024. Mathematical discoveries from program search with large language models. Nature 625, 468–475. Sahoo, S., Lo, C.Y., 2022. Smart manufacturing powered by recent techno-logical advancements: A review. Journal of Manufacturing Systems 64, 236–250. Seidgar, H., Kiani, M., Abedi, M., Fazlollahtabar, H., 2014. An efficient imperialist competitive algorithm for scheduling in the two-stage assembly flow shop problem. International Journal of Production Research 52, 1240– 1256. da Silva Santana, J.R., Fuchigami, H.Y., 2024. Production scheduling prob-lem with assembly flow shop systems: mathematical optimisation models. International Journal of Production Research 62, 2483–2498. Tay, J.C., Ho, N.B., 2008. Evolving dispatching rules using genetic program-ming for solving multi-objective flexible job-shop problems. Computers & Industrial Engineering 54, 453–473. Wang, M., Zhang, J., Zhang, P., Cui, L., Zhang, G., 2022. Independent double dqn-based multi-agent reinforcement learning approach for online two-stage hybrid flow shop scheduling with batch machines. Journal of Manufacturing Systems 65, 694–708. 46 Wu, C.C., Bai, D., Azzouz, A., Chung, I.H., Cheng, S.R., Jhwueng, D.C., Lin, W.C., Said, L.B., 2020. A branch-and-bound algorithm and four meta-heuristics for minimizing total completion time for a two-stage assembly flow-shop scheduling problem with learning consideration. Engineering Optimization 52, 1009–1036. Wu, C.C., Gupta, J.N., Cheng, S.R., Lin, B.M., Yip, S.H., Lin, W.C., 2021a. Robust scheduling for a two-stage assembly shop with scenario-dependent processing times. International Journal of Production Research 59, 5372– 5387. Wu, C.C., Zhang, X., Azzouz, A., Shen, W.L., Cheng, S.R., Hsu, P.H., Lin, W.C., 2021b. Metaheuristics for two-stage flow-shop assembly problem with a truncation learning function. Engineering optimization 53, 843– 866. Xie, Z., Liu, F., Wang, Z., Zhang, Q., 2025. Llm-driven neighborhood search for efficient heuristic design, in: 2025 IEEE Congress on Evolutionary Computation (CEC), IEEE. pp. 1–8. Yang, B., Geunes, J., 2008. Predictive–reactive scheduling on a single re-source with uncertain future jobs. European Journal of Operational Re-search 189, 1267–1283. Yao, S., Liu, F., Lin, X., Lu, Z., Wang, Z., Zhang, Q., 2025. Multi-objective evolution of heuristic using large language model, in: Proceedings of the AAAI Conference on Artificial Intelligence, pp. 27144–27152. Ye, H., Wang, J., Cao, Z., Berto, F., Hua, C., Kim, H., Park, J., Song, G., 2024. Reevo: Large language models as hyper-heuristics with reflective evolution. Advances in neural information processing systems 37, 43571– 43608. Zhang, F., Mei, Y., Nguyen, S., Zhang, M., 2020. Evolving scheduling heuris-tics via genetic programming with feature selection in dynamic flexible job-shop scheduling. ieee transactions on cybernetics 51, 1797–1811. Zhang, F., Mei, Y., Nguyen, S., Zhang, M., 2023a. Survey on genetic pro-gramming and machine learning techniques for heuristic design in job shop scheduling. IEEE Transactions on Evolutionary Computation 28, 147–167. 47 Zhang, L., Feng, Y., Xiao, Q., Xu, Y., Li, D., Yang, D., Yang, Z., 2023b. Deep reinforcement learning for dynamic flexible job shop scheduling problem considering variable processing times. Journal of Manufacturing systems 71, 257–273. Zhang, R., Liu, F., Lin, X., Wang, Z., Lu, Z., Zhang, Q., 2024. Understanding the importance of evolutionary search in automated heuristic design with large language models, in: International Conference on Parallel Problem Solving from Nature, Springer. pp. 185–202. Zhang, X., Ming, X., 2023. A smart system in manufacturing with mass personalization (s-mmp) for blueprint and scenario driven by industrial model transformation. Journal of Intelligent Manufacturing 34, 1875–1893. Zhang, Z., Tang, Q., Chica, M., 2021. Maintenance costs and makespan minimization for assembly permutation flow shop scheduling by consid-ering preventive and corrective maintenance. Journal of Manufacturing Systems 59, 549–564. Zheng, Z., Xie, Z., Wang, Z., Hooi, B., 2025. Monte carlo tree search for comprehensive exploration in LLM-based automatic heuristic design, in: Proceedings of the International Conference on Machine Learning. Zhou, Y., Yang, J.j., Huang, Z., 2020. Automatic design of scheduling policies for dynamic flexible job shop scheduling via surrogate-assisted cooperative co-evolution genetic programming. International Journal of Production Research 58, 2561–2580. Zou, P., Rajora, M., Liang, S.Y., 2018. A new algorithm based on evo-lutionary computation for hierarchically coupled constraint optimization: Methodology and application to assembly job-shop scheduling. Journal of Scheduling 21, 545–563. 48