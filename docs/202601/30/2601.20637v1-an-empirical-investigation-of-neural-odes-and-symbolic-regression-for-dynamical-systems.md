---
title: An Empirical Investigation of Neural ODEs and Symbolic Regression for Dynamical Systems
title_zh: 神经常微分方程与符号回归在动力系统中的实证研究
authors: "Panayiotis Ioannou, Pietro Liò, Pietro Cicuta"
date: 2026-01-28
pdf: "https://arxiv.org/pdf/2601.20637v1"
tags: ["keyword:SR", "query:SR"]
score: 10.0
evidence: 直接研究符号回归在动力系统中的应用
tldr: "本研究探讨了利用神经常微分方程（NODEs）和符号回归（SR）对复杂动力系统进行建模与方程发现。通过对阻尼振荡系统的实验，研究发现NODEs在动力学相似的情况下具有良好的外推能力，而SR能从噪声数据中准确恢复控制方程。最重要的是，即使在原始数据极度匮乏（仅10%）的情况下，利用训练好的NODE生成增强数据，SR仍能有效推断出物理定律，为科学发现提供了新路径。"
motivation: 旨在解决复杂动力系统建模及从噪声数据中自动发现其底层控制微分方程的挑战。
method: 通过阻尼振荡系统实验，评估了NODEs的外推性能以及符号回归从原始噪声数据和NODE生成数据中恢复方程的能力。
result: "NODEs能有效外推至新的边界条件，且SR能利用仅由10%原始数据训练的NODE所生成的增强数据成功恢复大部分控制方程。"
conclusion: 结合NODEs的数据增强能力与符号回归的推断能力，是实现从有限观测中发现物理定律的一种极具潜力的新方法。
---

## 摘要
准确建模复杂系统的动力学并发现其控制微分方程是加速科学发现的关键任务。利用来自两个阻尼振荡系统的含噪声合成数据，我们探索了神经常微分方程（NODEs）的外推能力以及符号回归（SR）恢复底层方程的能力。我们的研究得出了三个关键见解。首先，我们证明了只要生成的轨迹与训练数据具有动力学相似性，NODEs 就能有效地外推到新的边界条件。其次，SR 成功地从含噪声的真实数据中恢复了方程，尽管其性能取决于输入变量的正确选择。最后，我们发现，当使用仅在 10% 的完整模拟数据上训练的 NODE 所生成的数据时，SR 恢复了三个控制方程中的两个，并对第三个方程给出了良好的近似。虽然最后这一发现指出了未来工作的方向，但我们的结果表明，利用 NODEs 丰富有限的数据并使符号回归能够推断物理定律，代表了一种极具前景的科学发现新方法。

## Abstract
Accurately modelling the dynamics of complex systems and discovering their governing differential equations are critical tasks for accelerating scientific discovery. Using noisy, synthetic data from two damped oscillatory systems, we explore the extrapolation capabilities of Neural Ordinary Differential Equations (NODEs) and the ability of Symbolic Regression (SR) to recover the underlying equations. Our study yields three key insights. First, we demonstrate that NODEs can extrapolate effectively to new boundary conditions, provided the resulting trajectories share dynamic similarity with the training data. Second, SR successfully recovers the equations from noisy ground-truth data, though its performance is contingent on the correct selection of input variables. Finally, we find that SR recovers two out of the three governing equations, along with a good approximation for the third, when using data generated by a NODE trained on just 10% of the full simulation. While this last finding highlights an area for future work, our results suggest that using NODEs to enrich limited data and enable symbolic regression to infer physical laws represents a promising new approach for scientific discovery.

---

## 论文详细总结（自动生成）

以下是对论文《An Empirical Investigation of Neural ODEs and Symbolic Regression for Dynamical Systems》的结构化深入总结：

### 1. 核心问题与整体含义
本文探讨了在科学发现中如何从有限且含有噪声的观测数据中推断复杂动力系统的底层物理定律。研究的核心动机在于结合两种技术的优势：
*   **神经常微分方程 (NODEs)**：擅长连续时间建模和数据插值/外推，但属于“黑盒”模型，缺乏可解释性。
*   **符号回归 (SR)**：能够发现精确的数学方程，具有高度可解释性，但通常需要大量高质量、低噪声的数据。
论文通过实证研究证明，可以将 NODE 作为一种**数据增强和去噪工具**，为 SR 提供更丰富、更平滑的数据，从而在数据稀缺（仅 10% 原始数据）的情况下恢复系统的控制方程。

### 2. 方法论
论文提出并评估了一个两阶段的管线（Pipeline）：
*   **NODE 建模与数据增强**：
    *   使用基于 JAX 的 `Diffrax` 库构建 NODE。
    *   核心架构：多层感知机（MLP），包含 2 个隐藏层，每层 20 个神经元。
    *   训练过程：在极少量（如模拟时长的 10%）且含噪声（±5% 均匀分布噪声）的初始数据上训练 NODE。
    *   生成数据：利用训练好的 NODE 模型生成覆盖更长时间范围和更多采样点的合成轨迹。
*   **符号回归方程发现**：
    *   使用 `PySR` 库对 NODE 生成的数据进行符号搜索。
    *   关键技术细节：计算状态变量的时间导数作为 SR 的目标值；搜索空间包括基础算术运算（+、-、*、/）和倒数运算。
    *   输入变量选择：研究了包含或不包含中间变量（如生长速率 $\lambda$）对 SR 恢复方程成功率的影响。

### 3. 实验设计
研究采用了两个具有阻尼振荡特性的动力系统作为实验场景：
*   **倒立摆（Cart-pole）**：经典的机械系统，考虑了杆与推车之间的摩擦力。
*   **生物模型（Bio-model）**：模拟大肠杆菌在营养环境变化下的适应性行为，包含三个状态变量：氨基酸比例 ($\psi_A$)、核糖体质量分数 ($\phi_R$) 和基因调节函数 ($\chi_R$)。
*   **Benchmark 与对比方案**：
    1.  **地面真值（无噪声）**：SR 直接作用于理想数据。
    2.  **地面真值（5% 噪声）**：SR 直接作用于原始噪声数据。
    3.  **NODE 生成数据**：SR 作用于由 NODE 学习并增强后的数据。
*   **评估指标**：均方误差（MSE）和方程恢复的准确度（结构相似性）。

### 4. 资源与算力
*   **软件框架**：JAX, Diffrax, PySR, Optax (Adabelief 优化器)。
*   **训练细节**：NODE 模型训练了 100,000 到 150,000 次迭代。
*   **算力说明**：文中**未明确提及**具体的 GPU 型号、数量或总训练时长。但从 MLP 的规模（2层20节点）来看，该实验对算力的需求相对较低，普通的消费级 GPU 或高性能 CPU 即可完成。

### 5. 实验数量与充分性
*   **实验规模**：
    *   针对倒立摆，测试了 35 种不同的边界条件。
    *   针对生物模型，训练了 6 种不同采样频率的模型，并针对 19 种不同的营养转换（Shifts）进行了评估。
    *   每个模型进行了 10 次独立运行以计算平均 MSE 和标准差。
*   **充分性评价**：实验设计较为客观，涵盖了插值、时间外推和初始条件外推。通过对比不同噪声水平和采样频率，验证了模型的鲁棒性。然而，实验仅限于两个特定的阻尼系统，对于更复杂（如混沌系统）的适用性尚待验证。

### 6. 主要结论与发现
*   **动力学相似性决定外推能力**：NODE 能够外推到训练集之外的初始条件，前提是这些新条件的轨迹在相空间中与训练轨迹具有“动力学相似性”。
*   **NODE 的去噪作用**：SR 在直接处理 5% 噪声数据时表现较差，但处理 NODE 生成的数据时效果显著提升。这表明 NODE 在学习过程中起到了非线性平滑和去噪的作用。
*   **数据效率**：即使只使用 10% 的模拟数据进行训练，NODE 也能捕捉到足够的动力学特征，使 SR 能够恢复大部分（3 个中的 2 个）控制方程。
*   **变量敏感性**：SR 的成功高度依赖于输入变量的选择。如果某些关键项（如复杂的合理分式）被主导项掩盖，SR 可能只能找到近似解。

### 7. 优点
*   **创新的管线设计**：将 NODE 作为 SR 的前置处理器，解决了 SR 对高密度、低噪声数据的依赖问题。
*   **深入的相空间分析**：通过相空间轨迹解释了 NODE 泛化能力的来源，而不仅仅是报告误差数字。
*   **实用性强**：针对实验科学中常见的“数据稀疏”和“高噪声”痛点提出了可行的解决方案。

### 8. 不足与局限
*   **系统覆盖面有限**：仅测试了阻尼振荡系统，未探讨该方法在非线性极强或多尺度系统中的表现。
*   **方程恢复不完全**：在生物模型中，SR 未能完全恢复最复杂的方程（方程2），仅得到了结构近似，说明对于高复杂度项的推断仍有挑战。
*   **先验知识依赖**：SR 的效果仍受限于候选算子集和输入变量的选择，缺乏完全自动化的特征工程。

（完）
