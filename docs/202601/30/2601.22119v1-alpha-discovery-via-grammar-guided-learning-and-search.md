---
title: Alpha Discovery via Grammar-Guided Learning and Search
title_zh: 基于语法引导学习与搜索的 Alpha 因子发现
authors: "Han Yang, Dong Hao, Zhuohan Wang, Qi Shi, Xingtong Li"
date: 2026-01-29
pdf: "https://arxiv.org/pdf/2601.22119v1"
tags: ["keyword:SR", "query:SR"]
score: 8.0
evidence: 金融领域的语法引导公式发现
tldr: 本研究针对量化金融中公式化因子自动发现的难题，提出了AlphaCFG框架。该框架利用上下文无关文法（CFG）定义具有语法约束和金融可解释性的树状搜索空间，并将因子发现建模为语言马尔可夫决策过程。通过结合语法感知的蒙特卡洛树搜索（MCTS）与策略/价值网络，AlphaCFG在提高搜索效率的同时，显著提升了因子的交易表现，为符号因子挖掘提供了通用且高效的解决方案。
motivation: 现有的因子发现方法往往忽略语法和语义约束，导致在无界空间中搜索效率低下且结果缺乏可解释性。
method: 提出基于文法引导的AlphaCFG框架，利用树状结构的马尔可夫决策过程和语法感知蒙特卡洛树搜索进行因子挖掘。
result: 在中国和美国股票市场的实验表明，AlphaCFG在搜索效率和交易收益率上均优于现有最先进的基准方法。
conclusion: AlphaCFG为量化金融中的符号因子发现和优化提供了一个兼具解释性、高效性和通用性的新框架。
---

## 摘要
自动发现公式化 Alpha 因子是量化金融中的一个核心问题。现有方法通常忽略语法和语义约束，依赖于在非结构化且无界的空间中进行穷举搜索。我们提出了 AlphaCFG，这是一个基于语法的框架，用于定义和发现符合语法规范、具有金融可解释性且计算高效的 Alpha 因子。AlphaCFG 使用面向 Alpha 的上下文无关语法来定义树状结构、大小受控的搜索空间，并将 Alpha 发现建模为树状结构的语言马尔可夫决策过程，随后利用受语法敏感的价值和策略网络引导的语法感知蒙特卡洛树搜索进行求解。在中国和美国股票市场数据集上的实验表明，AlphaCFG 在搜索效率和交易盈利能力方面均优于最先进的基准方法。除了交易策略，AlphaCFG 还可作为量化金融领域（包括资产定价和投资组合构建）中符号因子发现与优化的通用框架。

## Abstract
Automatically discovering formulaic alpha factors is a central problem in quantitative finance. Existing methods often ignore syntactic and semantic constraints, relying on exhaustive search over unstructured and unbounded spaces. We present AlphaCFG, a grammar-based framework for defining and discovering alpha factors that are syntactically valid, financially interpretable, and computationally efficient. AlphaCFG uses an alpha-oriented context-free grammar to define a tree-structured, size-controlled search space, and formulates alpha discovery as a tree-structured linguistic Markov decision process, which is then solved using a grammar-aware Monte Carlo Tree Search guided by syntax-sensitive value and policy networks. Experiments on Chinese and U.S. stock market datasets show that AlphaCFG outperforms state-of-the-art baselines in both search efficiency and trading profitability. Beyond trading strategies, AlphaCFG serves as a general framework for symbolic factor discovery and refinement across quantitative finance, including asset pricing and portfolio construction.

---

## 论文详细总结（自动生成）

这是一份关于论文《Alpha Discovery via Grammar-Guided Learning and Search》的结构化深入总结：

### 1. 论文的核心问题与整体含义
*   **研究动机**：在量化金融中，自动发现具有预测能力的公式化 Alpha 因子至关重要。然而，现有方法（如遗传算法 GP 或基于强化学习的序列生成）通常在无约束、无边界的符号空间中搜索，导致产生大量语法错误或金融逻辑不通的因子，且搜索效率低下。
*   **核心问题**：如何通过引入形式语言约束，在保证因子可解释性和语法正确性的前提下，高效地从海量组合空间中搜索出高质量的 Alpha 因子？
*   **整体含义**：论文提出了 **AlphaCFG** 框架，将因子发现视为一种“受语法引导的语言生成与搜索”问题，通过结构化的约束显著缩小了搜索空间并提升了因子的质量。

### 2. 论文提出的方法论
*   **核心思想**：利用上下文无关文法（CFG）定义 Alpha 因子的构造规则，将搜索过程建模为树状结构的语言马尔可夫决策过程（TSL-MDP），并结合深度强化学习与蒙特卡洛树搜索（MCTS）。
*   **关键技术细节**：
    *   **分层语法设计**：定义了 $\alpha$-Syn（确保语法正确）、$\alpha$-Sem（引入金融语义约束，如滚动窗口必须为整数）和 $\alpha$-Sem-k（引入长度限制）三层文法。
    *   **TSL-MDP 建模**：将因子的推导过程转化为状态转移，状态是部分生成的表达式树，动作是文法产生式规则。
    *   **语法感知 MCTS**：使用改进的 PUCT 算法进行搜索，引入自适应分支因子以平衡不同深度的搜索宽度。
    *   **语法表示学习**：采用 **Tree-LSTM** 编码器直接处理抽象语法树（ASR），共享策略网络（预测规则概率）和价值网络（估计因子 IC 值）。
    *   **多样性感知奖励**：通过计算新生成因子与现有因子池之间的最大公共子树相似度，惩罚结构冗余，鼓励发现新颖因子。

### 3. 实验设计
*   **数据集**：
    *   **中国市场**：沪深 300 指数成分股（2010-2024 年数据）。
    *   **美国市场**：标普 500 指数成分股（2010-2024 年数据）。
*   **Benchmark 与对比方法**：
    *   **公式化因子挖掘类**：AlphaGen (RPN+PPO), AlphaQCM, gplearn (GP)。
    *   **机器学习预测类**：XGBoost, LightGBM, LSTM, ALSTM, TCN, Transformer。
*   **评估指标**：IC（信息系数）、Rank IC、ICIR、Sharpe Ratio（夏普比率）、Max Drawdown（最大回撤）。

### 4. 资源与算力
*   **算力说明**：论文**未明确列出**具体的 GPU 型号、数量或总训练时长。
*   **参数配置**：附录中提到了 MCTS 每次状态进行 64 次模拟，并行度为 8，训练迭代次数为 100 次，Replay Buffer 大小为 20,000。

### 5. 实验数量与充分性
*   **实验规模**：
    *   在两个主流市场（中、美）进行了完整的对比实验。
    *   所有实验均运行了 **5 个随机种子**以保证结果的统计显著性。
    *   **消融实验**：对比了不同文法等级（Syn vs. Sem vs. Sem-k）以及不同网络架构（Tree-LSTM vs. Transformer/LSTM/CNN）的影响。
    *   **因子优化实验**：展示了该框架如何改进现有的经典因子库（如 GTJA191 和 Alpha101）。
*   **充分性评价**：实验设计较为全面，涵盖了从搜索效率到实盘回测的多个维度，对比了多种类型的基准模型，客观性较强。

### 6. 论文的主要结论与发现
*   **性能领先**：AlphaCFG 在 IC 相关指标和回测收益上均显著优于现有的公式化挖掘方法和黑盒机器学习模型。
*   **文法的重要性**：更严格的文法约束（$\alpha$-Sem-k）能显著加快搜索收敛速度并提升因子质量，证明了领域知识（Inductive Bias）在符号回归中的价值。
*   **结构化编码的优势**：Tree-LSTM 相比线性序列编码能更好地处理因子的同构性（Isomorphism）问题，减少了语义冗余。
*   **存量优化**：该框架不仅能从零发现因子，还能通过“部分掩码”有效修复和增强已有的传统金融因子。

### 7. 优点
*   **理论严谨**：将形式语言理论与强化学习结合，为符号化因子挖掘提供了坚实的数学框架。
*   **可解释性强**：生成的因子是人类可读的数学公式，且通过文法规避了无意义的计算逻辑。
*   **搜索效率高**：通过文法剪枝和 MCTS 引导，避免了在无效空间中的盲目搜索。
*   **通用性**：框架不限于交易因子，可扩展至资产定价、投资组合构建等其他符号回归任务。

### 8. 不足与局限
*   **文法依赖性**：系统的表现高度依赖于预定义的文法规则和算子集，如果文法设计不当（如漏掉关键算子），可能会限制搜索上限。
*   **计算开销**：虽然搜索空间缩小了，但 MCTS 结合 Tree-LSTM 的在线推理和训练可能比简单的遗传算法或线性 RL 具有更高的计算延迟。
*   **回测简化**：实验中的回测采用了较为理想化的 Top-k 策略，未深入讨论高频交易中的滑点、手续费及流动性冲击对这些因子的具体影响。

（完）
