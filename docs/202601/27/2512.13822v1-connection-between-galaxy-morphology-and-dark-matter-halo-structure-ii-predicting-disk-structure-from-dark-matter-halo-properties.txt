Title: Connection between galaxy morphology and dark-matter halo structure II: predicting disk structure from dark-matter halo properties

URL Source: https://arxiv.org/pdf/2512.13822v1

Published Time: Wed, 17 Dec 2025 01:04:36 GMT

Number of Pages: 26

Markdown Content:
> Draft version December 17, 2025
> Typeset using L ATEX twocolumn style in AASTeX7.0.1

Connection between galaxy morphology and dark-matter halo structure II: predicting disk structure from dark-matter halo properties 

Jinning Liang ,1, 2 Fangzhou Jiang ,2 Houjun Mo ,3 Andrew Benson ,4 Philip F. Hopkins ,5

Avishai Dekel ,6 and Luis C. Ho 2

> 1Department of Astronomy, School of Physics, Peking University, Beijing 100871, China
> 2Kavli Institute for Astronomy and Astrophysics, Peking University, Beijing 100871, China
> 3Department of Astronomy, University of Massachusetts, Amherst, MA01003, USA
> 4Carnegie Observatories, 813 Santa Barbara Street, Pasadena, CA 91101, USA
> 5TAPIR, California Institute of Technology, Pasadena, CA 91125, USA
> 6Center for Astrophysics and Planetary Science, Racah Institute of Physics, The Hebrew University, Jerusalem 91904, Israel

ABSTRACT We investigate how galactic disk structures connect to the detailed properties of their host dark-matter halos using the TNG50 simulation. From the hydrodynamic and matched dark-matter‚Äìonly runs, we measure a comprehensive list of halo properties describing density structure, angular momen-tum, shape, assembly history, and environment. Using the morphological decomposition developed in Paper I, we quantify the sizes, scale heights, and mass fractions of the disk components for galaxies at 0 ‚â§ z ‚â§ 4. Random Forest (RF) regression shows halo properties alone predict disk size and thickness with high accuracy, while Symbolic Regression (SR) provides compact empirical relations with slightly lower accuracy. Disk height is consistently easier to predict than disk size, and lower-mass halos yield higher accuracy than massive halos. Predictions based on halo properties measured in the full-physics hydro simulations outperform those based on the matched dark-matter‚Äìonly halos, reflecting the im-print of baryonic restructuring on the inner halo. SHAP analysis reveals that the most informative halo parameters include concentration, Einasto shape, global and inner spin, and recent mass accre-tion, though their importance varies across disk properties. We show that correlations between disk size and the density-profile shape arise primarily from disk-induced modification of the inner halo, rather than a primordial connection. Finally, we point out that disks become more extended with respect to their host halos at higher redshift in low-mass halos, while massive high-redshift halos show the opposite trend. We provide SR-based prescriptions that accurately map halo properties to disk structures, offering practical tools for galaxy‚Äìhalo modeling. 

Keywords: Dark matter halos (1880) ‚Äî Stellar disks (1594) ‚Äî Evolution of galaxies (594) ‚Äî Galaxy formation (595) ‚Äî Hydrodynamical simulations (767) ‚Äî Regression (1914) 

1. INTRODUCTION In the ŒõCDM cosmological framework, galaxies form and evolve within dark-matter (DM) halos (S. D. M. White & M. J. Rees 1978), whose mass, shape, and assembly history imprint on their morphologies. Yet, despite decades of study, the quantitative link between halo properties and galaxy morphology remains un-certain and incomplete (H. J. Mo et al. 1998; R. S. Somerville et al. 2018; F. Jiang et al. 2019; J. Liang et al. 2025). 

> Corresponding author: Fangzhou Jiang Email: jnliang25@stu.pku.edu.cn, fangzhou.jiang@pku.edu.cn

Stellar disks are particularly revealing, as their sizes (e.g. A. V. Kravtsov 2013; K.-H. Huang et al. 2017), thicknesses (e.g. A. V. Zasov et al. 2002; N. Y. Sotnikova & S. A. Rodionov 2006), and mass fractions (e.g. J.-h. Kim & J. Lee 2013) trace the angular-momentum (AM) acquisition and dynamical heating within halos. Pre-vious studies, including Paper I of this series (J. Liang et al. 2025), have shown that, besides halo mass, which is the primary driver of galaxy size, secondary halo proper-ties including spin (e.g. S. M. Fall & G. Efstathiou 1980; S. M. Fall 1983; H. J. Mo et al. 1998), concentration (e.g. F. Jiang et al. 2019), and accretion rate (e.g. Y. Dubois et al. 2016) all affect disk sizes, but a comprehensive, 

> arXiv:2512.13822v1 [astro-ph.GA] 15 Dec 2025

2multidimensional understanding of how halo conditions shape detailed disk structures is still lacking. Our goals in this series of studies are to determine how well disk structure can be predicted from halo properties using cosmological simulations, to identify the most influential parameters, and to derive empiri-cal relations that can be incorporated into semi-analytic galaxy-formation models (e.g. S. Cole et al. 2000; C. G. Lacey et al. 2016; B. M. B. Henriques et al. 2020). To this end, we have developed an algorithm that measures the physical morphologies of simulated galaxies by de-composing them into kinematic components, and we also measure a compressive list of halo structural properties using particle data, which complements the information available from typical halo-finding algorithms (Paper I). In this work, the second paper of this series, we make use of these detailed morphological and structural mea-surements, and apply machine-learning techniques to uncover complex nonlinear relationships in such high-dimensional data. We adopt a framework that combines Random Forest regression (L. Breiman 2001), SHapley Additive Explanations (S. Lundberg & S.-I. Lee 2017), and Symbolic Regression (e.g. J. R. Koza 1992) to quan-tify and interpret the dependence of disk morphology on halo parameters. The paper is organized as follows. Section 2 describes the simulation data, the measurements of galaxy and halo properties, and the algorithms employed in this work. Section 3 presents the connections between galax-ies and dark-matter halos extracted from our measure-ments, and identifies the most important halo parame-ters that regulate disk properties. Section 4 explores the physical reasons for the relations obtained in Section 3, and Section 5 summarizes our finding. Throughout this study, we define halos as spherical over-densities of 200 times the critical density of the Universe, and adopt the cosmological parameters assumed in the TNG simula-tions.  

> 2.

METHOD In this section, we describe the cosmological simula-tion sample, define all the halo and galaxy properties considered in this study, and present the machine learn-ing algorithms applied to these data products. For read-ers who wish to proceed to the results in Section 3 with-out delving into technical details, we provide a summary of our measurements in Table 1 and a workflow of the analysis pipeline in Fig. 1. 2.1. Simulation and sample selection 

We adopt the highest-resolution run of the Illustris-TNG suite (hereafter TNG50, D. Nelson et al. 2019; A. Pillepich et al. 2019), which has a gas particle mass of 10 4.93 M‚äô, a dark matter (DM) particle mass of 10 5.65 M‚äô, and a gravitational softening length of 0.288 (0.074) comoving kpc for collisionless (gas) particles. The simulation includes sub-grid models that capture the key physical processes of gas cooling, star formation, chemical enrichment, and feedback. Halos are identified using the Friends-of-Friends algorithm (FoF, M. Davis et al. 1985) and the SUBFIND algorithm (V. Springel et al. 2001), and are linked across snapshots via the 

SUBLINK merger tree algorithm (V. Rodriguez-Gomez et al. 2015). The corresponding DM-only (DMO) simu-lation shares the same initial conditions, and halos are matched to their hydro-simulation counterparts using the public Subhalo Matching To Dark catalog 7.Our sample selection follows Paper I and includes cen-tral halos at redshift z = 0, 1, 2, and 4 in the public cat-alog 8. We restrict our analysis to well resolved systems, by requiring a half-stellar-mass radius at least twice the collisionless softening length, and at least 1000 stellar particles and 1000 DM particles within the virial ra-dius. For the DM-only runs, we only include halos with matched hydro-simulation counterparts. 2.2. DM halo measurements 

‚Ä¢ Halo mass Mvir is defined as the total mass enclosed within the virial radius Rvir , inside which the mean density is ‚àÜ c = 200 times the critical density œÅc =3H20 /(8 œÄG ), i.e. M200 = 4 œÄ‚àÜcœÅcR3200 /3. We use the fields of Group R Crit200 and Group M Crit200 from the public halo catalog for Rvir and Mvir , respectively. 

‚Ä¢ Halo circular velocity is defined as Vcirc ,DM =pGM DM (< r )/r , where MDM (< r ) is the enclosed DM mass. Its maximum value Vmax ,DM and the corresponding radius rmax satisfy Vcirc ,DM (rmax ) =

Vmax ,DM .

‚Ä¢ Halo concentration is defined as c = Rvir /r ‚àí2,where r‚àí2 is the radius where the density slope equals ‚Äì2. We fit the J. Einasto (1965) profile 

œÅ(r) = œÅ‚àí2 exp 



‚àí 2

Œ±

 rr‚àí2

Œ±

‚àí 1

 

, (1) for concentration and the shape index Œ±. The nor-malization œÅ‚àí2 is linked to Mvir through 

œÅ‚àí2 = Mvir Œ±

4œÄh 3e2/Œ± Œ≥[3 /Œ±, x (Rvir )] ,  

> 7https://www.tng-project.org/data/docs/specifications/#sec5d
> 8https://www.tng-project.org/data/downloads/TNG50-1

337 Halo properties 

‚Ä¢ Mass 

‚Ä¢ Density 

‚Ä¢ AM/Shape 

‚Ä¢ Environment 

> Sec.2.2

9 Disk properties 

‚Ä¢ Total/Thin/Thick Disk 

‚Ä¢ Size 

‚Ä¢ Height 

‚Ä¢ Mass fraction 

> Sec.2.3

Dataset 

> Table.1

Training Set: 80% 

Train/Test 

Split 

Test Set: 20% 

Random Forest 

> App.A.1

SHAP analysis 

> App.A.2

Symbolic Regression 

> App.A.3

Top 10 

Hyperparameter Tuning 

Best Random Forest Models 

Best Equations Table A1,A2 

Scoring Eq.A4 

Analysis: 

Global Sec. 3.1 & Disk Sec. 3.2 

‚Ä¢ Performance metrics Eq.10-12 

‚Ä¢ Random Forest vs Symbolic Regression 

‚Ä¢ The most important properties 

‚Ä¢ Correlation analysis Sec. 4 

‚Ä¢ Comparison with previous relations Sec. 4 

Features 

Top 10 Features 

## Measurements 

## ML 

## Training 

## Evaluation 

Hydro 

DMO 

Figure 1. Analysis pipeline , which contains three parts: measurements (gray), machine-learning training (green), and output evaluation (red). The corresponding sections, figures, tables and equations are indicated by blue texts. 

with h = r‚àí2(Œ±/ 2) 1/Œ± , x = (2 /Œ± )( r/r ‚àí2)Œ±, and 

Œ≥(a, x ) the non-normalized incomplete gamma func-tion. Both c and Œ± are obtained by fitting this model to the Vcirc ,DM /V max ,DM profile. 

‚Ä¢ Halo spin parameter is defined as 

Œª = jvir 

‚àö2Rvir Vvir 

, (2) following J. S. Bullock et al. (2001), where jvir is the specific angular momentum within the virial radius and Vvir the circular velocity at Rvir . We also mea-sure an inner spin, Œªinner = jvir ,inner /(‚àö2Rvir Vvir ), us-ing the specific angular momentum enclosed within 0.1Rvir , jvir ,inner .

‚Ä¢ The mass accretion rate and mass assembly his-tory (MAH) of a dark-matter halo are characterized using two approaches. The MAH is defined as the mass of the main branch as a function of redshift, 

Mvir (z). Following J. McBride et al. (2009), we fit it with 

Mvir (z) = Mvir (1 + z)Œ≤ e‚àíŒ≥z . (3) The accretion rate can be defined as ÀôMnorm ‚â° d ln Mvir 

dz = Œ≤

1 + z ‚àí Œ≥. (4) Alternatively, the MAH can be expressed using the mass variable (F. C. van den Bosch 2002; R. H. Wech-sler et al. 2002; D. H. Zhao et al. 2003), 

s(z) = œÉ(Mvir )

œÉ[Mvir (z)] , (5) where œÉ(M ) is the standard deviation of the linear over-density field on mass scale M . Following Y. Chen et al. (2020), we apply Principal Component Analysis (PCA) to s(z) at fixed redshift to reduce dimension-ality. The first two principal components (PC1 and PC2) accurately capture both the shape and evolution of a typical MAH, with PC1 representing the over-all monotonic growth, while PC2 encodeing a higher-order, non-monotonic deviation. Thus, we use ÀôMnorm 

to trace recent accretion and (PC1, PC2) to describe the global MAH shape over cosmic time. 

‚Ä¢ Halo formation redshift z1/2 is defined as the high-est redshift at which the main branch assembled half of its final mass Mvir (H. Wang et al. 2011). 

‚Ä¢ Halo 3D shape parameters are derived from the eigenvalues of the inertia tensor (B. Allgood et al. 2006), 

Sij = 1

M

X

> k

mk rk,i rk,j , (6) 4

Halo quantities Description 

Mvir (Rvir ) Mass (radius) of a spherical overdensity that is 200 times the critical density 

c Halo concentration, measured by fitting Einasto profile (Eq. 1) 

Œ± Halo profile-shape index, measured by fitting Einasto profile (Eq. 1) 

Œª (Œªinner ) The spin parameter (Eq. 2), measured at Rvir (0 .1Rvir )

q (qinner ) Axis ratio between intermediate axis and major axis (Eq. 7), measured from the 3D inertia tensor within Rvir (0 .1Rvir )

p (pinner ) Axis ratio between minor axis and intermediate axis 

s (sinner ) Axis ratio between minor axis and major axis 

T (Tinner ) Triaxiality, (Eq. 8), measured within Rvir (0 .1Rvir )ÀôMnorm The normalized accretion rate (Eq. 4) PC1 The first principal component of the mass assembly history PC2 The second principal component of the mass assembly history 

z1/2 The highest redshift when the main branch of a halo assembled half of its final mass Environment Cosmic web classification, which categorizes halos as voids, sheets, filaments, or knots using eigenvalues of the deformation tensor 

n1,3,5 (Œ¥1,3,5) Local number density (overdensity) of all the halos with mass exceeding 0.1% of the target halo mass (Eq. 9), measured within 1, 3, or 5 Mpc 

zMinor /Major /Total Redshift of the last merger within the latest four dynamical times, for minor, major, or total mergers 

‚ü®z‚ü©Minor /Major /Total Mean redshift of mergers within the latest four dynamical times 

‚ü®R‚ü©Minor /Major /Total Mean mass ratio for the mergers within the latest four dynamical times 

NMinor /Major /Total Number of mergers within the latest four dynamical times Galaxy quantities Description 

M‚ãÜ Stellar mass (measured within 5 r1/2, excluding wind particles) SFR Star formation rate (sum of the star formation rates of all the gas cells in the halo) 

r1/2 3D radius within which the stellar mass equals half of the total stellar mass in the halo 

R1/2,Disk /ThinDisk /ThickDisk Projected radius enclosing half the mass of the total/thin/thick disk 

Z1/2,Disk /ThinDisk /ThickDisk Vertical distance enclosing half the total/thin/thick disk mass 

fDisk /ThinDisk /ThickDisk Mass fraction of the galaxy in the total/thin/thick disk 

Table 1. Structural and environmental properties of DM halos and morphological measurements of galaxies used in this study. 

where the sum runs over all DM particles within the ellipsoid, and M = P 

> k

mk is the enclosed mass. The eigenvalues of S correspond to the squared semi-axes (a ‚â• b ‚â• c), obtained iteratively from the virial sphere until convergence (M. Tomassetti et al. 2016). We define the 3D axis ratios 

q = b/a, p = c/b, s = c/a, (7) and the triaxiality parameter 

T = (1 ‚àí q2)/(1 ‚àí s2). (8) Analogous quantities measured within 0 .1Rvir are de-noted as qinner , pinner , sinner , and Tinner .

‚Ä¢ Environment classification is based on a halo‚Äôs location within the cosmic web. We identify web types using the eigenvalues of the deformation ten-sor (e.g., O. Hahn et al. 2007; J. E. Forero-Romero et al. 2009): the number of eigenvalues exceeding a threshold Œªth = 0 .4 determines the environment, with 0, 1, 2, and 3 corresponding to voids, sheets, filaments, and knots, respectively. The overdensity field is com-puted on a 512 3 grid via a cloud-in-cell interpolation, smoothed with a Gaussian filter of RG = 0 .5 h‚àí1ckpc. These parameter choices yield a visually consistent web morphology and agree with previous studies (e.g., D. Martizzi et al. 2019). 

‚Ä¢ Local densities quantify a halo‚Äôs immediate environ-ment. We measure both the number density n1,3,5 and overdensity Œ¥1,3,5 within spheres of radius R = 1, 3, and 5 Mpc. Only neighboring halos with total mass 

> 0.1% of the target‚Äôs mass are included: 

nR = X

> Di<R

34œÄR 3 , Œ¥R = 1

œÅm

X

> Di<R

3Mi

4œÄR 3 ‚àí1, (9) where Di is the distance and Mi the mass of each neighbor, and œÅm is the mean cosmic matter density at that redshift. 5

‚Ä¢ Merger statistics are extracted from the SUBLINK 

merger trees. To ensure relevance to instantaneous properties, only mergers within the latest four dy-namical times are considered, where the halo‚Äôs dy-namical time is given by tdyn = 1/[10 H(z)], with 

H(z) the Hubble constant at redshift z. We include events where the secondary progenitor contains ‚â• 50 DM particles, and define the merger mass ratio R

as the mass ratio of the secondary halo to the pri-mary, evaluated at the epoch when the secondary reaches its maximum DM mass. Mergers are classi-fied as major if R > 0.25 or minor if 0 .1 < R < 0.25; smaller ratios are ignored. For each halo, we record the most recent merger redshift ( zMinor /Major /Total ), mean mass ratio (‚ü®R‚ü©Minor /Major /Total ), number of mergers ( NMinor /Major /Total ), and mean merger red-shift ( ‚ü®z‚ü©Minor /Major /Total ) for minor, major, and all mergers. 2.3. Galaxy Quantities 

‚Ä¢ Half-stellar-mass radius r1/2 is the 3D radius within which the enclosed stellar mass is equal to half of the total stellar mass within the halo. 

‚Ä¢ Stellar mass M‚ãÜ is defined as the sum of stellar par-ticle mass within 5 r1/2. This excludes most of satel-lite galaxies while retaining most of the smooth stellar halo of the central galaxies. 

‚Ä¢ Star formation rate (SFR) is the sum of the star formation rates of all the gas cells in a halo, as in the 

SubhaloSFR field of the public SUBFIND catalog. 

‚Ä¢ Disk mass fraction is calculated using the kinematic morphological decomposition algorithm introduced in Paper I 9. This method splits the stellar particles in a galaxy into bulge, stellar halo, thin disk, and thick disk, using automatically detected thresholds in the energy-angular-momentum space. Disk mass fraction is then defined as fX = M‚ãÜ,X /M ‚ãÜ where M‚ãÜ,X is the mass of component X, with X being the total disk, thin disk, or thick disk. 

‚Ä¢ Scale radius Rdisk and scale height Zdisk of disks 

are defined as the projected radius or height enclosing half of the stellar mass of the corresponding compo-nent (total disk, thin disk, or thick disk), computed in the coordinate frame whose vertical axis is aligned with the galaxy‚Äôs angular-momentum vector.  

> 9https://github.com/JinningLianggithub/MorphDecom

2.4. Machine Learning Algorithms 

While (semi-)analytical and empirical models have used connections between disk size and halo spin (e.g. S. Cole et al. 2000; C. G. Lacey et al. 2016; B. M. B. Hen-riques et al. 2020) or concentration (e.g. E. O. Nadler et al. 2020; P. Behroozi et al. 2022; R. S. Somerville et al. 2025), it remains an open question which one is more influential (F. Jiang et al. 2019) and whether incor-porating a broader range of halo properties can enhance prediction accuracy (J. Liang et al. 2025). Moreover, it is not yet known whether disk vertical height and mass fraction, can be robustly inferred from halo properties. Addressing these issues necessitates a systematic inves-tigation of correlations across a large set of halo condi-tions, a task that can be effectively done by supervised machine-learning (ML) algorithms. In this study, we use ML algorithms to uncover rela-tions between disk parameters and halo conditions. The targets and features are galaxy quantities and halo quan-tities, respectively, which are summarized in Table 1. We consider two ML algorithms. We first train the ran-dom forest (RF) regressor (L. Breiman 2001) for all halo conditions to predict our targets. Then we use SHap-ley Additive Explanations (SHAP) values (S. Lundberg & S.-I. Lee 2017) to identify important halo properties that affect each prediction. Finally we use symbolic re-gression (SR, e.g. J. R. Koza 1992) with the most impor-tant 10 halo properties as identified by the RF regres-sor as input to derive empirical functions relating the targets and features. The technical details and hyper-parameters that we tune are described in Appendix A. The workflow in this work is presented in Fig. 1. For both RF and SR, we use 80% of the total sam-ples as the training set and the remaining 20% as the test set. All features and target variables are scaled to dimensionless quantities. For the targets such as disk scale radii, disk scale heights, and galaxy sizes, they are normalized by the virial radius, and the dimensionless quantities are referred to as compactness or thickness .The stellar mass is normalized by the virial mass, while the SFR is normalized by the average halo growth rate over Hubble time. For the features, the virial mass is scaled by 10 10 M‚äô, and the other properties are already dimensionless. Except for disk mass fractions, a base-10 logarithm is applied to the target variables. We emphasize and caution that with SR, we do not aim at achieving a physically interpretable expressions, but instead, we aim at accurate and practical formula for predicting galaxy properties using purely halo mea-surements. We experiment with the complexity of the formula to achieve minimal set of quantities and low 610 3 10 2 10 1

M /Mvir (Pred) 

10 3

10 2

10 1

> M /Mvir (Test)

All 

Hydro RF (SR) 

DMO RF (SR) 

> MAE=
> R2=
> RMSE=
> 0.09
> 0.87
> 0.12
> 0.12
> 0.80
> 0.16
> (0.12)
> (0.78)
> (0.16)
> (0.14)
> (0.73)
> (0.19)

0 20 40 60 80 100 

Percentage of total |SHAP values| 

Mvir, 10 

c

z1/2 

Mnorm 

s

q

sinner 

> 1

qinner 

Mvir, 10 

Mnorm 

c

z1/2 

s

> 1

q

> 3

10 10 10 11 10 12 10 13 

Mvir [M ]

10 8

10 9

10 10 

10 11 

10 12         

> M [M  ] Hydro
> DMO
> TNG z= 0
> TNG z= 4 (1.5 dex)
> SR z= 0
> SR z= 4 (+1.5 dex)

10 3 10 2 10 1

SFR√ó tH/Mvir (Pred) 

10 3

10 2

10 1

> SFR√ó tH/Mvir  (Test)

SFR/ M 10 11 yr 1

> MAE=
> R2=
> RMSE=
> 0.16
> 0.69
> 0.21
> 0.18
> 0.64
> 0.24
> (0.18)
> (0.58)
> (0.25)
> (0.21)
> (0.54)
> (0.28)

0 20 40 60 80 100 

Percentage of total |SHAP values| 

Mvir, 10 

z1/2 

z

c

s

sinner 

> 1
> inner

q

Mvir, 10 

z

z1/2 

s

> 1
> inner

c

q

p

10 8 10 9 10 10 10 11 10 12 

M [M ]

10 2

10 1

10 0

10 1

10 2        

> SFR [M  /yr]
> SR z= 0
> SR z= 4
> TNG z= 0
> TNG z= 4

10 2 10 1

r1/2 /Rvir (Pred) 

10 2

10 1

> r1/2 /Rvir  (Test)

All 

> MAE=
> R2=
> RMSE=
> 0.09
> 0.76
> 0.12
> 0.12
> 0.62
> 0.16
> (0.11)
> (0.65)
> (0.15)
> (0.13)
> (0.54)
> (0.17)

0 20 40 60 80 100 

Percentage of total |SHAP values| 

z

c

> inner

Mvir, 10 

z1/2 

Mnorm 

PC2 

> 1

z

Mvir, 10 

c

> inner

s

q

Mnorm 

PC2 

z1/2 

10 8 10 9 10 10 10 11 10 12 

M [M ]

10 0

10 1

> r1/2  [kpc]

Figure 2. Performance of the regression models for global galaxy properties in the TNG50 simulation, and the scaling relations predicted by the symbolic-regression (SR) models. The global galaxy properties shown are stellar mass ( top ), SFR ( middle ), and half-stellar-mass radius ( bottom ). Left : Comparison of RF (contours) and SR (dashed curves with 16‚Äì84% ranges) predictions against test data, using measurements from the hydro (blue) and DMO (red) runs. Performance is evaluated with MAE, R2, and RMSE. Middle : SHAP scores that indicate the relative contributions of the top 10 RF features, with blue (left axis) and red (right axis) labels corresponding to the hydro and DMO results, respectively. Error bars show the 16‚Äì84% ranges. Feature categories are indicated by the color of the text boxes: mass (black), density profile (green), angular momentum or trivial shape (purple), and environment (gray). Right : Scaling relations predicted by SR, where cyan and red curves show median relations for hydro halos and DMO halos, respectively, at z = 0 (solid) and z = 4 (dashed). Gray and black squares show the corresponding medians measured directly from the hydro simulation at z = 0 and 

z = 4. Shaded regions and error bars denote 16‚Äì84% ranges. The sample in the SFR row includes only star-forming galaxies. For clarity, the z = 4 relations in the M‚ãÜ‚ÄìMvir panel are shifted horizontally by 1.5 dex. 

complexity while keeping a decent accuracy comparable to the full RF models. To evaluate the performance of the functions derived by RF and SR, we use three different metrics defined as follows. First, the mean absolute error (MAE), MAE = 1

N

NX

i

|ytrue ,i ‚àí ypred ,i |. (10) Second, the coefficient of determination ( R2), 

R2 = 1 ‚àí

PNi (ytrue ,i ‚àí ypred ,i )2

PNi (ytrue ,i ‚àí ¬Øytrue )2 (11) Thrid, the root mean squared error (RMSE), RMSE = 

s PNi (ytrue ,i ‚àí ypred ,i )2

N . (12) 7Here, ypred ,i and ytrue ,i are the predicted value and the true (measured) value of the i-th data point, respec-tively. N is the length of the data. ¬Øytrue is the mean value of the true data. Throughout, we mainly use R2

while showing the other two metrics for reference.  

> 3.

GALAXY-HALO CONNECTIONS In this section, we present the models for predicting galaxy quantities with DM-halo quantities, as identified with the random-forest (RF) and symbolic-regression (SR) algorithms. We first test the performance of the re-gression models for global properties, specifically, stellar mass, star formation rate (SFR), and size, as a valida-tion of the methods in Section 3.1, and then extend the analysis to disk properties in Section 3.2. For each rela-tion, we first show the accuracy of our prediction, and then discuss the correlation between the target and the features. 3.1. Predicting galaxy global properties with halo parameters 

3.1.1. Stellar mass 

Model accuracy: Reassuringly, the stellar-mass-to-total-mass ratio is accurately predicted. RF attains high scores of R2 = 0 .87 using halo properties from the hydro runs, and 0 .80 using DMO halos, as shown in the upper panels of Fig. 2. 

Feature importance: The upper middle panel of Fig. 2 presents the relative importance of the halo prop-erties in predicting M‚ãÜ/M vir : halo mass Mvir dominates, followed by concentration c, formation redshift z1/2, and accretion rate ÀôMnorm , consistent across both hydro and DMO predictions. Some additional higher-order proper-ties, including spin, shape parameters, and environment, may also contribute, with much smaller SHAP values. 

Symbolic regression: Using the top 10 features, an empirical relation is obtained by training SR. It is worth noting that not all features remain in the final SR results after training. While the performance of SR model is not on par with the RF model, the resulting relations are simple and involve only four halo parameters, mass 

Mvir ,10 , formation redshift z1/2, concentration c, and short-to-long axis ratio s, consistent across both hydro and DMO versions. The explicit form for the DMO version is log 

 M‚ãÜ

Mvir 



= 0 .081 z1/2 ‚àí 1.375 e‚àí0.089 Mvir ,10 s

+ 0 .042 c ‚àí 1.9.

(13) This means that the scatter in the stellar-mass-halo-mass relation is linked to halo structure and formation history. Table A.1 and Table A.2 lists the functional forms of all the SR models involved in this study, for the hydro and DMO halos, respectively. To further test the relations learned from SR, we show the stellar mass‚Äìhalo mass relations at z = 0 and z = 4 in the upper right panel of Fig. 2. Excellent agreement exists between the SR predictions and the direct measurements from the TNG50 simulation. Remarkably, the relations based on the DMO halos are nearly identical to those based on the hydro halos. 3.1.2. Star formation rate 

Model accuracy: The middle panels of Fig. 2 assess the models for the dimensionless star formation rate, SFR tH/M vir . The model training and validation are both limited to the star-forming galaxies, i.e., with spe-cific star formation rate higher than 10 ‚àí2 Gyr ‚àí1 (e.g. A. R. Wetzel et al. 2013). RF regression using the hy-dro and DMO halo measurements achieves R2 values of 0.69 and 0.64, respectively. 

Feature importance: The most important parame-ter remains the virial mass. Other important halo prop-erties, shared between the hydro and DMO versions, include formation redshift z1/2, redshift z, spin Œª, and the minor-to-major axis ratio s.

Symbolic regression: SR gives an R2 score that is slightly lower, and consistently picks up mass Mvir ,10 ,formation redshift z1/2, and short-to-long axis ratio s as the leading factors. The model based on the DMO halos is log 

 SFR 

Mvir /t H



= 0 .101 z1/2 ‚àí 1.296 + e‚àí0.146 Mvir ,10 s

√ó (0 .014 M ‚àí2.337 vir ,10 ‚àí 1.334) .

(14) Using the SR models, we compare the predicted star-forming main sequence against the simulation results in the right panel of Fig. 2. The SR predictions gener-ally match the simulation result well, except for a slight excess at M‚ãÜ ‚â≥ 10 10 M‚äô at z = 0. 3.1.3. Galaxy size 

Model accuracy: The lower panels of Fig. 2 evalu-ate the accuracy of the regression models for the galaxy compactness, r1/2/R vir . RF regression using the hydro and DMO measurements achieve high R2 scores of 0.76 and 0.62, respectively. 

Feature importance: Unlike stellar mass or SFR, the most important halo property for galaxy compact-ness is not virial mass but redshift. In addition, the importance of virial mass is much smaller for the hydro halos compared to the DMO halos. For the hydro halos, the role of the Einasto shape index ( Œ±) is significant, 810 3 10 2 10 1

R1/2, Disk /Rvir (Pred) 

10 3

10 2

10 1

> R1/2, Disk /Rvir  (Test)

fDisk > 0.3 

Hydro RF (SR) 

DMO RF (SR) 

> MAE=
> R2=
> RMSE=
> 0.12
> 0.63
> 0.16
> 0.15
> 0.52
> 0.19
> (0.15)
> (0.44)
> (0.20)
> (0.16)
> (0.41)
> (0.21)

All 

10 3 10 2 10 1

R1/2, Disk /Rvir (Pred) 

> 0.12
> 0.56
> 0.15
> 0.14
> 0.43
> 0.18
> (0.13)
> (0.46)
> (0.17)
> (0.16)
> (0.29)
> (0.20)

10 10.6 Mvir /M < 10 11.6 

10 3 10 2 10 1

R1/2, Disk /Rvir (Pred) 

> 0.17
> 0.58
> 0.23
> 0.22
> 0.34
> 0.28
> (0.16)
> (0.62)
> (0.22)
> (0.23)
> (0.27)
> (0.29)

10 11.6 Mvir /M

0 20 40 60 

Percentage of total |SHAP values| 

c

Mvir, 10 

> inner

z

pinner 

z1/2 

Tinner 

n1

z

Mvir, 10 

q

c

> inner

s

Mnorm 

z1/2 

PC1 

0 20 40 60 

Percentage of total |SHAP values| 

c

> inner

z1/2 

Mvir, 10 

pinner 

s

n1

sinner 

z

Mvir, 10 

q

> inner

c

Mnorm 

PC1 

s

PC2 

0 20 40 60 

Percentage of total |SHAP values| 

> inner

Mnorm 

z1/2 

c

Mvir, 10 

s

PC2 

z

Mvir, 10 

z1/2 

PC1 

c

s

q

PC2 

z

Mnorm 

Figure 3. Performance of regression models for disk compactness, R1/2,Disk /R vir , and the most predictive halo properties ‚Äì for galaxies with significant disk components ( fDisk > 0.3). Formatting follows Fig. 2. Columns correspond to different halo mass ranges: all ( left ), low-mass (10 10 .6M‚äô ‚â§ Mvir < 10 11 .6M‚äô, middle ), and high-mass ( Mvir ‚â• 10 11 .6M‚äô, right ). 

ranking the second, whereas it is not in the top 10 in the DMO case. This difference persists in predictions for disk structures (Section 3.2), and implies that Œ± is significantly influenced by the galaxy rather than be-ing a driver of galaxy size. Other commonly important properties across both hydro halos and DMO halos are concentration c, spin Œª, and the inner-halo spin Œªinner . A few environmental and assembly-history properties also weakly contribute to the prediction. 

Symbolic regression: SR achieves performance scores that are slightly lower than RF, at R2 = 0 .65 (0.54) for the hydro (DMO) halos. The functional form for the DMO halos is log 

 r1/2

Rvir 



= log( Œª + 0 .162) log( Mvir ,10 + c) + log( z + s)+ (0 .643 ‚àí 0.201 z0.463 )(log Mvir ,10 + 0 .374) 

‚àí 1.474 + Œªinner + e‚àí1.272 Mvir ,10 +0 .642 .

(15) The lower right panel of Fig. 2 compares the size - stellar mass relations predicted by SR with those directly form the simulation. The regression models reproduce the data well at z = 0. They also match the low-mass end (M‚ãÜ ‚â≤ 10 9 M‚äô) at z = 4 but exhibit a flatter high-mass end. 3.2. Predicting disk properties with halo properties 

3.2.1. Disk size 

Model accuracy: Fig. 3 presents the regression mod-els for disk compactness, R1/2,disk /R vir , where we have focused on galaxies with substantial disks, defined as 

fDisk > 0.3. RF attains an R2 core of 0.63 (0.52) with the hydro (DMO) halos. The regression results are con-sistently more accurate for the disks that are larger with respect to their host halos. 

Feature importance: The importance rankings dif-fer between the hydro and DMO cases. In the hydro case, the Einasto shape index Œ± is the dominant factor for disk size, while it does not even appear in the top 10 in the DMO case. Some features are consistently influ-ential for both hydro and DMO halos, including concen-tration c, spin Œª, virial mass Mvir , redshift z, and inner-halo spin Œªinner . The most important halo properties align with those used in previous disk-size models (e.g. H. J. Mo et al. 1998; F. Jiang et al. 2019). Inner-halo pa-rameters frequently emerge as important features when using the hydro halos, whereas global halo parameters tend to be more important when using the DMO halos. This difference arises mainly because the disk interacts via gravity with the surrounding DM that constitutes the inner halo, altering its structure, as will be further 910 3 10 2           

> Z1/2, Disk /Rvir (Pred)
> 10 3
> 10 2
> Z1/2, Disk /Rvir  (Test)
> fDisk > 0.3
> Hydro RF (SR)
> DMO RF (SR)
> MAE=
> R2=
> RMSE=
> 0.10
> 0.83
> 0.13
> 0.11
> 0.77
> 0.15
> (0.11)
> (0.79)
> (0.15)
> (0.13)
> (0.68)
> (0.18)
> All
> 10 310 2
> Z1/2, Disk /Rvir (Pred)
> 0.09
> 0.79
> 0.12
> 0.11
> 0.70
> 0.14
> (0.10)
> (0.74)
> (0.13)
> (0.11)
> (0.66)
> (0.15)

10 10.6 Mvir /M < 10 11.6     

> 10 310 2
> Z1/2, Disk /Rvir (Pred)
> 0.14
> 0.57
> 0.21
> 0.16
> 0.33
> 0.20
> (0.13)
> (0.70)
> (0.17)
> (0.17)
> (0.23)
> (0.22)

10 11.6 Mvir /M         

> 020 40 60
> Percentage of total |SHAP values|
> Mvir, 10
> c
> z
> inner
> Mnorm
> pinner
> z1/2
> n1
> Mvir, 10
> z
> c
> Mnorm
> z1/2
> inner
> n1
> s
> pinner
> 020 40 60
> Percentage of total |SHAP values|
> c
> Mvir, 10
> z
> inner
> n1
> Mnorm
> 3
> 1
> z
> Mvir, 10
> c
> Mnorm
> inner
> n1
> s
> PC2
> q
> 020 40 60
> Percentage of total |SHAP values|
> inner
> c
> z1/2
> Mvir, 10
> Mnorm
> p
> PC2
> s
> Mvir, 10
> z1/2
> Mnorm
> inner
> PC2
> PC1
> c
> s

Figure 4. Performance of regression models for disk thickness, Z1/2,Disk /R vir , for galaxies with significant disk components ( fDisk > 0.3). Formatting follows Fig. 2. Columns correspond to different halo mass ranges: all (left), low-mass (10 10 .6 ‚â§ Mvir /M ‚äô < 10 11 .6, middle), and high-mass ( Mvir /M ‚äô ‚â• 10 11 .6, right). 

illustrated in Section 4.5. Halo shape parameters are always among the top 10 features. As discussed in F. Jiang et al. (2025) and J. Liang et al. (2025), this is likely because rounder shapes are indicative of more relaxed halos in which extended disks can more easily develop. Environment and assembly-history parameters (e.g., n1,PC1, PC2, ÀôMnorm ) have limited impact. 

Symbolic regression: After training with the top 10 features, the SR algorithm reduces the inputs to only 4 parameters: inner-halo spin Œªinner , total spin Œª, Einasto shape Œ±, and concentration c, using the hydro halos. With the DMO halos, SR picks up 5 features ‚Äì virial mass Mvir ,10 , redshift z, total spin Œª, concentration c,and intermediate-to-long axis ratio q ‚Äì and finds the following functional form log 

 R1/2,Disk 

Rvir 



= log Mvir ,10 (Œª0.251 ‚àí 0.339) + z(Œª + 0 .088) + 0 .343 q ‚àí 2.696 + e‚àí0.021 c‚àí0.007 zM vir ,10 +0 .045 ,

(16) which is more complex and also less accurate than that based on the hydro halos. This again indicates that predicting disk structures using halo properties from N -body simulations is challenging, and suggests that the strong disk-halo connection in the hydro simulations is largely driven by baryonic processes. 

Mass dependence: To better isolate secondary halo properties and assess potential mass dependence in the regression models, we divide the sample into two mass bins: Mvir = 10 10 .6‚àí11 .6M‚äô and Mvir > 10 11 .6M‚äô. The model behaviors for the two mass bins are illustrated in the middle and right columns of Fig. 3. Once halo mass is fixed, its relative importance naturally diminishes. In the low-mass bin, the leading features are concentra-tion c, Einasto shape Œ±, inner-halo spin Œªinner , and total 

Œª with the hydro halos; and redshift z, spin Œª, inner-halo spin Œªinner , axis ratio q, and concentration c with the DMO halos. The high-mass bin exhibits a stronger dependence on assembly-history parameters: accretion rate ÀôMnorm and formation redshift z1/2 rank fourth and fifth with the hydro measurements, while z1/2 and PC1 rank third and fourth with the DMO measurements. Pa-per I demonstrated that, at fixed mass, faster-accreting halos tend to host slightly larger disks. The present re-sults align with this trend: because higher-mass halos generally grow more rapidly, accretion-related parame-ters exert a stronger influence on disk size in the high-mass sample. Despite the mass-dependence of feature importance, SR basically identifies a consistent set of informative parameters. For the hydro halos, the fea-tures found by SR are inner-halo spin Œªinner , spin Œª,Einasto shape Œ±, and concentration c (and also redshift 10 

z for the high-mass bin). For the DMO halos, the use-ful features are virial mass Mvir ,10 , redshift z, inner-halo spin Œªinner , spin Œª, concentration c, and axis ratio q (and also accretion rate ÀôMnorm for the high-mass bin). 3.2.2. Disk scale height 

Model accuracy: The scale height Z1/2, or thickness 

Z1/2/R vir , has not been linked to DM halo properties in previous studies. Interestingly as Fig. 4 reveals, RF regression using halo properties attains accurate predic-tions for disk height, even more so than for disk com-pactness, with R2 scores reaching 0.83 (0.77) with the hydro (DMO) halos. 

Feature importance: The halo properties most rele-vant for predicting disk thickness, as shown in the lower panels of Fig. 4, are nearly identical to those for disk compactness: they are Einasto shape Œ±, concentration 

c, virial mass Mvir ,10 , and inner spin Œªinner for the hy-dro halos; and virial mass Mvir ,10 , redshift z, spin Œª, and concentration c for the DMO halos. Environmental and assembly-history properties consistently rank higher in the DMO case than in the hydro case. For both cases, redshift z, formation redshift z1/2, and accretion rate ÀôMnorm are among the most influential top 10 features. 

Symbolic regression: The SR model for disk height is also more accurate than that for disk size. The explicit functional form for the DMO halos is log 

 Z1/2,Disk 

Rvir 



= Œª0.435 ‚àí 0.461 log c ‚àí 2.219 + ( pinner + z0.596 )(0 .534 ‚àí 0.237 M 0.224 vir ,10 ).

(17) 

Mass dependence: For the hydro halos, Einasto shape Œ±, concentration c, spin Œª, inner spin Œªinner , and redshift z are always important predictors irrespective of the mass scale ‚Äì only the relative importance changes between the mass bins. For the DMO measurements, however, the top features differ for different mass scales: redshift z, virial mass Mvir ,10 , spin Œª, concentration c,and accretion rate ÀôMnorm are the most informative pa-rameters for low-mass halos; whereas spin Œª, virial mass 

Mvir ,10 , formation redshift z1/2, accretion rate ÀôMnorm ,and Einasto shape Œ± are the top factors for high-mass halos. Overall, spin Œª, inner spin Œªinner , concentration c,mass Mvir ,10 , and accretion rate ÀôMnorm are the most important features for disk thickness. Triaxial shape pa-rameters are generally less influential for disk thickness than for disk compactness. 0.2 0.4 0.6 0.8 

fDisk (Pred) 

0.2 

0.4 

0.6 

0.8 

> fDisk  (Test)

fDisk > 0.3 

Hydro RF (SR) 

DMO RF (SR) 

> MAE=
> R2=
> RMSE=
> 0.09
> 0.63
> 0.11
> 0.09
> 0.59
> 0.11
> (0.10)
> (0.48)
> (0.13)
> (0.10)
> (0.43)
> (0.13)

0 25 50 75 100 

Percentage of total |SHAP values| 

Mvir, 10 

c

qinner 

> inner

sinner 

z1/2 

s

Mnorm 

zTotal 

Mvir, 10 

c

qinner 

s

sinner 

Mnorm 

> inner

q

z1/2 

Figure 5. Performance of regression models for disk mass fraction, fDisk , for galaxies with significant disk com-ponents ( fDisk > 0.3). Formatting follows Fig. 2. 

3.2.3. Disk mass fraction 

Model accuracy: For disk mass fractions, the sam-ple is not divided into different halo mass bins, because the virial mass is by far the most dominant factor in reg-ulating whether a significant disk can develop. With the full sample, as shown in Fig. 5, RF attains an accuracy of R2 ‚âÉ 0.6. 

Feature importance: Except for halo mass and con-centration, the other halo properties have rather weak contributions. The relatively important features for both the hydro halos and the DMO halos are virial mass 

Mvir ,10 , concentration c, inner shapes qinner and sinner ,as well as accretion rate ÀôMnorm .

Symbolic regression: The useful features picked up by SR are c and Mvir ,10 for the hydro halo, and Mvir ,10 

and qinner for the DMO halos. The explicit form of the SR model for DMO halos is 

fDisk = 0 .16 qinner + c0.476 Mvir ,10 (Mvir ,10 + 35 .67) ‚àí1.31 

+ 0 .172 .

(18) 11 

Figure 6. Comparison of models relating disk size to halo properties. Disk half-mass radii R1/2,Disk measured from the TNG50 hydro simulation are compared with predictions from several models.The first panel shows our SR-based model, written for simplicity as R1/2,Disk = f (X)Rvir , where f (X) denotes the SR formula as a function of halo parameters X. The cyan and red curves correspond to the SR relations calibrated on hydro halos and DMO halos, respectively, with the DMO version given by eq. (16) and the hydro version by f (X) = Œªinner + ( Œª + c‚àí0.125 )(log Œ± + 3 .010) ‚àí 3.210. The second panel shows the relation of A. V. Kravtsov (2013), R1/2 = 0 .02 Rvir .The third panel shows a simplified version of the spin-based model of H. J. Mo et al. (1998), R1/2 = 0 .5ŒªR vir .The fourth panel shows the concentration-based empirical model of F. Jiang et al. (2019), R1/2 = 0 .02(1 + z)‚àí0.2(c/ 10) ‚àí0.7Rvir . Median relations using hydro (DMO) halos are shown as solid cyan (dashed red) lines, with shaded regions indicating the 16‚Äì84th percentiles. Spearman correlation coefficients are listed in each panel, and the diagonal line marks the one-to-one relation. This analysis is limited to the galaxies with significant disks ( fDisk > 0.3). Our SR models provide the highest correlation and lowest scatter, outperforming all previous prescriptions. 4. DISCUSSION In this section, we compare our new disk-size predic-tors with previous prescriptions, and interpret a few in-teresting aspects of the aforementioned disk-halo con-nections. 4.1. New size predictors based on symbolic regression 

Simple analytic prescriptions have long been used to link galaxy size to halo properties. A. V. Kravtsov (2013) derived a linear relation R1/2 = 0 .02 Rvir from abundance matching, applicable to both disks and spheroids. H. J. Mo et al. (1998) modeled thin expo-nential disks that inherit the halo‚Äôs specific angular mo-mentum, yielding a size‚Äìspin scaling. Following R. S. Somerville et al. (2018), we adopt a much simplified form of the original H. J. Mo et al. model, R1/2 = 0 .5 Œª R vir .In contrast, F. Jiang et al. (2019) found marginal cor-relation between halo spin and galaxy size in cosmolog-ical zoom-in simulations and proposed a concentration-based scaling, R1/2 = 0 .02(1 + z)‚àí0.2(c/ 10) ‚àí0.7Rvir .Fig. 6 contrasts previous analytic prescriptions with our SR-based models (see the R1/2,Disk /R vir entries in Table A.1 and Table A.2) by comparing their predicted disk sizes against the actual TNG50 measurements. Our SR models deliver the highest fidelity, achieving Spear-man coefficients R ‚â≥ 0.6‚Äînotably higher than the ‚â≤ 0.5typical of earlier prescriptions. Our models also exhibit reduced scatter and lie much closer to the 1:1 relation, whereas previous models systematically overpredict the sizes of compact disks. With only a modest increase in input halo parameters compared to previous prescrip-tions, the SR relations achieve substantially higher ac-curacy, making them a practical choice for semi-analytic or empirical models built on N -body simulations. 4.2. Understanding the relation between disk size and Einasto shape index 

In Section 3, the SHAP analysis shows that the den-sity‚Äìprofile shape index, Œ±, is a key predictor of disk compactness, R1/2,Disk /R vir ‚Äì but only when using halo properties measured from the hydrodynamic simulation. In the DMO case, Œ± carries far less predictive power. This contrast suggests that the apparent link between disk size and Œ± arises from baryonic effects, rather than from the primordial structure of DMO halos. This is further explored in Fig. 7, which shows a clear positive correlation between R1/2,Disk /R vir and Œ± in the hydro halos, but almost no correlation or weakly negative cor-relation in the DMO counterparts. To directly test whether the Œ±‚Äìdependence of disk compactness is indeed driven by baryons, we define ÀúŒ± ‚â° (Œ±Hydro ‚àí Œ±DMO )/Œ± DMO , (19) which quantifies the halo‚Äôs structural response to bary-onic processes. Here, Œ±Hydro is the Einasto index mea-sured in the hydro halo, and Œ±DMO is that of the matched DMO halo. By construction, ÀúŒ± < 0 corre-sponds to halo contraction (G. R. Blumenthal et al. 1986; O. Y. Gnedin et al. 2004), whereas Àú Œ± > 0 indicates expansion. We also examine the stellar-to-halo mass ra-tio, M‚ãÜ/M vir , as a proxy for the strength of baryonic 12 10 2                            

> 10 1
> R1/2, Disk /Rvir
> (, log 10 p)
> (0.30, < 10 10 )
> (-0.17, < 10 10 )
> (0.37, < 10 10 )
> (-0.16, < 10 10 )
> (0.63, < 10 10 )
> (-0.15, -2.45)
> z= 0
> All
> 10 10.6 Mvir /M< 10 11.6
> 10 11.6 Mvir /M
> 0.6
> 0.4
> 0.2
> 0.0
> 0.2
> 0.4
> 0.6
> ( Hydro  DMO )/  DMO
> (-0.15, < 10 10 )
> (-0.06, -2.25)
> (0.20, -3.72)
> z= 0
> 10 1
> 10 2
> 10 1
> R1/2, Disk /Rvir
> (0.25, < 10 10 )
> (-0.09, -1.57)
> (0.20, -4.50)
> (-0.22, -4.60)
> Hydro
> DMO
> z= 4
> 10 310 210 1
> M/Mvir
> 0.6
> 0.4
> 0.2
> 0.0
> 0.2
> 0.4
> 0.6
> ( Hydro  DMO )/  DMO
> (-0.44, < 10 10 )
> (-0.40, < 10 10 )
> z= 4 2.4
> 2.2
> 2.0
> 1.8
> 1.6
> 1.4
> 1.2
> log 10 R1/2, Disk /Rvir

Figure 7. Halo structural response to disks. The left panels show the relation between disk compactness, R1/2,Disk /R vir ,and the Einasto shape index Œ± of the host halo. The right panels show the ratio Àú Œ± ‚â° (Œ±Hydro ‚àí Œ±DMO )/Œ± DMO ‚Äì a measure of halo structural response to baryons ‚Äì as a function of the stellar-to-halo mass ratio, M‚ãÜ/M vir . Here Œ±Hydro is measured in the hydro run, and Œ±DMO is that of the matched DMO counterpart. The top and bottom rows correspond to z = 0 and z = 4, respectively. In the left panels, hydro and DMO measurements are plotted in cyan and red, with dashed, solid, and dotted lines showing the low-mass, total, and high-mass samples (from light to dark colors). Spearman correlation coefficients R and log p

values are indicated, and shaded regions denote the 16‚Äì84th percentiles for the total sample. In the right panels, individual points are colored by disk compactness. This analysis is limited to the galaxies with significant disks ( fDisk > 0.3). 

impact (A. Di Cintio et al. 2014; J. Freundlich et al. 2020). As shown in the right panels of Fig. 7, most halos have Àú Œ± < 0, demonstrating that contraction is the dominant response in TNG50. Moreover, the mean value of Àú Œ± decreases with increasing M‚ãÜ/M vir , indicat-ing that halos in more massive galaxies tend to contract more strongly. At fixed stellar-to-halo mass ratio ‚Äì for example, around M‚ãÜ/M vir ‚âÉ 0.03, where systems are comparably disk-dominated ‚Äì we find a clear trend that disk compactness governs the degree of halo contraction. The most extended disks (the yellow points in Fig. 7) can even drive halo expansion rather than contraction. 4.3. Redshift trend of disk compactness 

Here we discuss how disk size relative to halo size evolves with mass and redshift. As shown in the up-per panel of Fig. 8, low-mass systems exhibit a strong redshift dependence: their R1/2,Disk /R vir increases sig-nificantly from ‚àº 0.02 at z = 0 to ‚àº 0.08 at z = 4. However, above a critical mass of Mvir ‚âÉ 2 √ó 10 11 M‚äô,the trend reverses. Thus, the redshift evolution of disk compactness R1/2,Disk /R vir is mass dependent. A related trend is in the physical disk size R1/2,Disk ,as shown in the lower panel of Fig. 8: it increases mono-tonically with halo mass at z = 0, but at higher redshift it grows with halo mass below the critical mass and de-clines toward higher masses. To understand these redshift trends, we first focus on the low-mass regime and ask what drives the strong evolution with redshift. A simple and intuitive pic-ture emerges when one approximates the disk size as the radius at which gas first crosses the star-formation density threshold, and considers how the virial radius evolves at fixed halo mass. In the TNG model, star formation begins once the hydrogen number density ex-ceeds 0 .13cm ‚àí3. Using a toy model with an NFW halo and a self-similar gas distribution containing the cosmic baryon fraction, we find that this star-forming radius remains roughly constant across redshift, primarily be-cause typical halo concentrations decrease toward high 13 10 2              

> 10 1
> R1/2, Disk /Rvir
> 0.26
> -0.27
> -0.41
> -0.35
> z= 0
> z= 1
> z= 2
> z= 4
> 10 10 10 11 10 12
> Mvir /M
> 10 0
> 10 1
> R1/2, Disk
> log 10 p)(,
> (0.69, < 10 10 )
> (0.35, < 10 10 )
> (0.11, -7.33)
> (0.02, -0.19)

Figure 8. Disk compactness ( R1/2,Disk /R vir ) and phys-ical size ( R1/2,Disk ) as functions of halo mass and red-shift. Results at different redshifts are shown using distinct colors and line styles. The Spearman correlation coefficient 

R and the corresponding p-value are reported. Shaded re-gions denote the 16‚Äì84th percentiles at z = 0 and z = 4. 

z. By contrast, the virial radius, Rvir ‚àù (Mvir /œÅ crit )1/3,becomes much smaller at early times due to the rapid rise of the critical density. As a result, even if the physi-cal disk size evolves only weakly, the ratio R1/2,Disk /R vir 

increases steeply toward high redshift. This picture is most applicable to low-mass halos, which predominantly grow via cold-mode accretion (A. Dekel et al. 2009), where cooling is efficient and disk size closely tracks the extent of star-forming gas. For more massive systems ( Mvir ‚â≥ 2 √ó 10 11 M‚äô), the processes that shape disk size differ markedly with red-shift. At high z, these galaxies experience rapid mass assembly and frequent gas-rich mergers, which trigger centrally concentrated starbursts and produce compact stellar components (A. Zolotov et al. 2015; S. Lapiner et al. 2023). Although often described as star-forming nuggets with spheroidal morphologies, these systems can still retain substantial angular momentum inher-ited from merger orbits or inflowing filaments. Be-cause our morphological decomposition identifies disks via the angular-momentum distribution of stellar par-ticles, rapidly rotating nuggets are naturally classified as disks. This is not specific to our method ‚Äì most kinematics-based decomposition schemes behave simi-larly (e.g., M. Du et al. 2019; T. Zana et al. 2022) ‚Äì reflecting the broader fact that high-z disks and fast ro-tators are not cleanly separable. Consequently, the ro-tating stellar components in massive high-redshift halos tend to be compact. At low redshift ( z ‚â≤ 1), by contrast, galaxy growth is more quiescent and proceeds inside-out (S. Genel et al. 2018). Halos of a given mass are also more dynamically settled, providing favorable conditions for the formation of extended disks (F. Jiang et al. 2025). This naturally explains the monotonic increase of disk size with halo mass at low redshift. 4.4. Drivers of disk thickness: mass, size, and halo growth history 

As shown in Fig. 4 and discussed in Section 3.2.2, halo properties exhibit unexpectedly strong predictive power for disk thickness, stronger, in fact, than for disk com-pactness. Here we explore clues to the physical origin of this behavior. We begin by examining how disk thickness depends on halo mass and redshift. As shown in Fig. 9, disks become progressively thinner (relative to the virial radius) as halo mass increases from the dwarf regime up to the Milky Way scale, with the trend especially pronounced at high redshift. The disk flattening ratio, Z1/2,Disk /R 1/2,Disk , reaches a minimum of ‚àº 0.1 near Mvir ‚àº 10 12 M‚äô and rises at both lower and higher masses. At any fixed mass, disks are systematically thicker at earlier cosmic times. This reflects enhanced turbulence and elevated vertical veloc-ity dispersion in high-redshift galaxies, consistent with vertical Jeans equilibrium, where Z1/2 ‚àù œÉ2 

> z

/(œÄG Œ£). These strong mass and redshift dependencies agree with the SHAP rankings in Fig. 4, which consistently identify halo mass and redshift as the dominant predic-tors of disk thickness. A second key finding is the tight correlation between disk height and disk size. As shown in the middle and right panels of Fig. 9, disk height increases almost lin-early with disk size at fixed halo mass. This implies that many halo properties influence disk thickness primarily through their regulation of disk size‚Äîso the factors that set disk extent also tend to set disk thickness. We then examine in Fig. 10 the correlations of thick-ness with halo structural parameters, spin and con-centration, which are the most important factors af-ter mass and redshift according to the SHAP scores. Here we fix the halo mass to the Milky-Way scale (Mvir = 10 11 .7‚àí12 .3M‚äô) to better focus on the trend 14 10 10 10 11 10 12 10 13                  

> Mvir /M
> 10 3
> 10 2
> Z1/2, Disk /Rvir
> Hydro
> -0.42
> -0.65
> -0.64
> -0.45
> z= 0
> z= 1
> z= 2
> z= 4
> 10 10 10 11 10 12 10 13
> Mvir /M
> 10 1
> Z1/2, Disk /R1/2, Disk
> -0.67
> -0.55
> -0.53
> -0.43
> 10 010 1
> R1/2, Disk /kpc
> 10 1
> 10 0
> Z1/2, Disk /kpc
> 0.80
> 0.69
> 0.73
> 0.86
> 10.6 Mvir /M< 11.6
> 10 010 1
> R1/2, Disk /kpc
> 10 1
> 10 0
> Z1/2, Disk /kpc
> 0.78
> 0.82
> 0.87
> 0.94
> 11.6 Mvir /M

Figure 9. Upper left : Disk thickness as a function of halo mass and redshift. Upper right : Disk flattening, quantified by the ratio between height and size, Z1/2,Disk /R 1/2,Disk , as a function of halo mass and redshift. Middle and right : Disk height 

Z1/2,Disk versus size R1/2,Disk for two halo-mass bins, Mvir = 10 10 .6‚àí11 .6M‚äô and Mvir > 10 11 .6M‚äô. Line styles and colors indicate different redshifts. Spearman correlation coefficients R are listed in each panel. Shaded regions show the 16‚Äì84% ranges at z = 0 and z = 4. Milky-Way mass halos host the thinnest and most flattened disks. At fixed mass (focusing on the dwarf regime of Mvir ‚â§ 10 11 .3M‚äô), disks thicken towards higher redshift. Disk size and height are strongly correlated, implying that the halo factors that drive disk size also regulate disk height. 

with the structural parameters. Disk thickness increases with spin for both hydro halos and DMO halos, while a dependence on concentration appears only in the hydro case. Interestingly, once disk compactness is fixed, as for the lower panels of Fig. 10, these correlations largely dis-appear. This suggests that spin and concentration affect thickness indirectly ‚Äì through their impact on disk size and compactness ‚Äì rather than by directly regulating the vertical velocity dispersion. Finally, we examine disk thickness versus halo as-sembly‚Äìhistory parameters in Fig. 11. At fixed halo mass, lower formation redshift z1/2 and lower normal-ized accretion rate ÀôMnorm ‚Äì corresponding to more re-cent or more rapid mass growth ‚Äì produce systemat-ically thicker disks at all redshifts. This is a natural consequence of dynamical heating from mergers and ac-cretion. Taken together, these results indicate that ac-tive mass assembly is the primary driver of disk thick-ness, whereas the apparent correlations with halo spin and concentration arise indirectly through their shared impact on disk compactness. Although a full explana-tion of how halo structure governs disk compactness and why disk size and height correlate so tightly lie beyond the scope of this work, these results provide a clear clue as to why halo properties predict disk thickness better than disk size. The additional predictive power comes from mass-assembly parameters, which exert a stronger influence on disk thickness than on disk compactness. 4.5. Do inner halo properties improve disk‚Äìhalo modeling? 

As shown earlier in Section 3, inner-halo parameters emerge as highly important predictors of disk struc-ture‚Äîbut only when measured from the hydrodynami-cal simulation. To clarify this difference, Fig. 12 com-pares the predictive power of the global spin Œª and the inner-halo spin Œªinner for both disk compactness and disk thickness. 15 10 3

10 2                

> Z1/2, Disk /Rvir
> Hydro
> DMO
> (,log p)
> -0.55
> (-0.15, -1.60)
> -0.58
> (-0.13, -1.19)
> -0.41
> (-0.29, -3.07)
> z= 0
> z= 1
> z= 2
> Hydro
> DMO
> (,log p)
> 0.46
> (0.54, < 10 10 )
> 0.42
> (0.43, -9.80)
> 0.41
> (0.38, -5.19)

10 0 10 1

c

10 3

10 2

> Z1/2, Disk /Rvir

0.015 R1/2, Disk /Rvir < 0.025          

> (-0.24, -1.04) (-0.20, -0.79)
> (-0.53, -5.79) (-0.21, -0.96)
> (-0.62, -5.30) (-0.37, -1.44)

10 2 10 1         

> (0.19, -0.70) (0.33, -1.68)
> (0.11, -0.47) (0.19, -0.85)
> (0.16, -0.55) (-0.02, -0.05)

Figure 10. Relations between disk thickness and halo concentration ( left ) and spin ( right ), evaluated at fixed halo mass (10 11 .7 < M vir /M ‚äô < 10 12 .3, basically the Milky-Way scale). The lower row further restricts the sample to a narrow range of disk compactness (0 .015 ‚â§ R1/2,Disk /R vir < 0.025). Line styles denote different redshifts, while warm and cool colors distinguish results from the hydro and DMO halos. Spearman correlation coefficients R and the corresponding p-values are quoted. Shaded regions show the 16‚Äì84% ranges at z = 0 and z = 2. 

Two key trends appear. First, for the hydro ha-los, Œªinner correlates more strongly with both disk size and thickness than the global spin, with the effect be-ing particularly pronounced in the high-mass sample (Mvir > 10 11 .6M‚äô). Second, for the matched DMO ha-los, the situation reverses: correlations with the global spin are marginally stronger than those with Œªinner .This contrast highlights the role of baryonic physics. In the hydro run, the disk exchanges angular momentum with the surrounding dark matter and reshapes the inner halo, creating a tighter disk ‚Äì inner halo coupling. In the DMO run, no such interaction occurs, and the inner-halo quantities do not carry additional predictive power beyond the global ones. Thus, for semi-analytic models or empirical galaxy‚Äìhalo frameworks built on N -body‚Äìonly halos, global halo properties are not only sufficient but may in fact be more robust predictors than inner-halo quanti-ties. 4.6. Model applicability to subsamples 

One may ask whether the regression relations remain robust when the subgrid physics prescriptions are var-ied. In principle, this could be tested by applying the models to a different simulation suite with alternative subgrid implementations. While such a comparison is beyond the scope of the current work, we can perform a related internal test within the TNG sample by exam-ining whether the models hold for subsamples selected by specific star formation rate (sSFR). A primary ef-fect of modifying subgrid prescriptions is to alter the global star-formation activity of galaxies. Therefore, if the model performs well for subsamples split by sSFR, this would suggest that it is relatively insensitive to such recipe variations. In Fig. 13, we evaluate our size predictors for quies-cent galaxies (SFR /M ‚ãÜ ‚â§ 10 ‚àí11 yr ‚àí1) and for starburst galaxies (SFR /M ‚ãÜ ‚â• 10 ‚àí8.5 yr ‚àí1). These two popula-tions lie in the ‚àº 2% tails of the sSFR distribution 16 0 1 2 3 4 5                            

> z1/2
> 10 3
> 10 2
> Z1/2, Disk /Rvir
> (,log p)
> Hydro
> DMO
> (,log p)
> (-0.24, -6.13)
> (-0.25, -6.14)
> (-0.25, -6.49)
> (-0.24, -4.88)
> (-0.30, -6.45)
> (-0.36, -6.20)
> z= 0
> z= 1
> z= 2
> 2.0 1.5 1.0 0.5 0.0
> Mnorm
> (-0.33, < 10 10 )
> (-0.32, -9.46)
> (-0.19, -4.02)
> (-0.18, -2.90)
> (-0.27, -5.37)
> (-0.29, -4.35)

Figure 11. Relations between disk thickness Z1/2,Disk /R vir and halo assembly-history parameters: formation redshift z1/2

(left ), and accretion rate ÀôMacc (right ). Formatting follows Fig. 10. 

in our dataset. The SR relations continue to perform well for starburst galaxies in both the hydro and DMO runs, achieving correlations of R ‚â≥ 0.6. For quenched galaxies, the hydro-based model also attains R = 0 .61, whereas the DMO version performs less well ( R = 0 .42). These results indicate that the hydro SR relations are likely not very sensitive to details of the subgrid physics and remain effective predictors of disk sizes even for quenched subsamples. In contrast, the weak perfor-mance of the DMO model implies that baryonic pro-cesses associated with quenching might substantially al-ter halo properties ‚Äì such information is missing in the DMO halos. 

5. CONCLUSION This work presents a comprehensive investigation of the connections between galaxy properties and host dark-matter halo properties in the TNG50 cosmologi-cal simulation, focusing on predicting disk structure us-ing halo properties. We measure 37 halo properties ‚Äì capturing density structure, angular momentum, shape, formation history, and environment ‚Äì from both the full-physics (hydro) simulations and dark-matter-only (DMO) runs. Using the morphological decomposition method developed in Paper I, we obtain disk properties (size, scale height, and mass fraction), and also analyze global galaxy quantities including stellar mass, SFR, and size. Random Forest (RF) and Symbolic Regression (SR) are then used to assess predictability, determine the most informative halo features, and derive empirical relations. Our main conclusions are the following. Regression models predict global galaxy properties with very high accuracy. Simple SR expressions suc-cessfully reproduce the stellar‚Äìhalo mass relation, the star-forming main sequence, and the size‚Äìmass rela-tions across redshifts. These relations offer valuable pre-scriptions for empirical modeling and demonstrate the promise of machine-learning-based approaches for pre-dicting more complex disk structures from halo infor-mation. Regarding the predictability of disk structure, we find 

‚Ä¢ Disk properties are predictable with good accuracy. SR performs slightly worse but still captures the major trends. 

‚Ä¢ Disk height is easier to predict than disk size, and predictions are more accurate for dwarfs ( Mvir <

10 11 .6M‚äô) than for more massive systems. 

‚Ä¢ Models based on hydro halos consistently outperform DMO-based ones, and the DMO-based SR relations are more complex. Different aspects of disk structure depend on different halo parameters. 

‚Ä¢ Disk compactness, defined as the half-mass size in units of the halo virial radius, is strongly linked to the Einasto shape index Œ±, concentration c, inner-halo spin Œªinner , total spin Œª, as well as the formation red-shift z1/2, using hydro halos. Using the DMO halos, which are typically what semi-analytical models work with, the most predictive halo parameters are spin Œª,halo mass Mvir , redshift z, concentration c, and the short-to-long axis ratio s.

‚Ä¢ Disk thickness, defined as the half-mass height in units of the halo virial radius, can be accurately predicted by halo mass Mvir , concentration c, inner-halo spin 

Œªinner , total spin Œª, and accretion rate ÀôMnorm , together with the Einasto shape index Œ± or redshift z for the hydro halos and DMO halos, respectively. 17 10 2                        

> R1/2, Disk /Rvir
> 0.31 0.30
> 0.38 0.36
> 0.44 0.44
> Hydro DMO
> All
> 10 10.6 Mvir /M< 10 11.6
> 10 11.6 Mvir /M
> 0.34 0.18
> 0.42 0.24
> 0.58 0.36
> 10 210 1
> 10 3
> 10 2
> Z1/2, Disk /Rvir
> 0.28 0.31
> 0.41 0.41
> 0.46 0.49
> 10 210 1
> inner
> 0.35 0.30
> 0.45 0.31
> 0.62 0.42

Figure 12. Disk compactness R1/2,Disk /R vir (top ) and thickness Z1/2,Disk /R vir (bottom ) as functions of the global halo spin 

Œª (left ) and inner-halo spin Œªinner (right ). Formatting follows Fig. 7. Spearman correlation coefficients R are indicated. In-ner-halo spin exhibits a noticeably stronger correlation with disk properties in the hydro halos, especially in the high-mass regime, whereas for the DMO halos the global-spin correlations are marginally stronger. 

‚Ä¢ Disk mass fraction is largely determined by halo mass, with secondary dependence on concentration and inner-halo shape. Across all targets, RF and SR consistently identify con-centration, spin, mass, and assembly history as the most predictive features. Despite lower accuracy, DMO-based predictions broadly agree with hydro-based trends, sug-gesting that many disk-halo relations are robust to bary-onic differences. The SR relations presented here out-perform previous analytic prescriptions (A. V. Kravtsov 2013; H. J. Mo et al. 1998; F. Jiang et al. 2019). We try to understand the origins of these correlations. 

‚Ä¢ We find evidence of disks altering halo structure, in the sense that disk compactness influences the Einasto slope index Œ±.

‚Ä¢ Disk compactness evolves with redshift in a strongly mass-dependent way: low-mass halos become substan-tially more compact relative to their virial radii to-ward high redshift because the star-forming radius stays roughly constant while the virial radius shrinks rapidly; whereas in high-mass halos this trend re-verses. 

‚Ä¢ Disk thickness is primarily driven by halo mass and recent halo growth. Disks are thinnest in Milky Way‚Äìmass halos, thicken toward both lower and higher masses, and become systematically thicker at higher redshift. Recent and rapid halo assembly pro-duce strong dynamical heating and thicker disks. Disk height scales tightly with disk size, so the correlations of disk height with halo spin and concentration are largely indirect through their influence on disk size. 

‚Ä¢ Inner halo properties improve disk predictions only in hydro simulations. Inner-halo spin correlates more strongly with disk size and thickness than global spin in the hydro run because baryonic disks reshape the inner dark matter. In DMO halos, this coupling does not exist, and global halo properties more robust pre-dictors for models based solely on N -body simulations. We provide simple analytic prescriptions that use halo properties to predict a wide range of galaxy and disk 18 10 0

10 1

> R1/2, Disk

Hydro 

DMO 

=0.61 

=0.42 

Quenched 

10 0 10 1

f(X)Rvir 

10 0

10 1

> R1/2, Disk

=0.57 

=0.68 

Starburst                

> Figure 13. Evaluation of the applicability of the SR size predictors to galaxy subsamples. Similar to Fig. 6, but the SR relations are applied only to quenched galaxies (SFR /M ‚ãÜ‚â§10 ‚àí11 yr ‚àí1) or to starburst galaxies (SFR /M ‚ãÜ‚â•10 ‚àí8.5yr ‚àí1). The Hydro SR relations remain highly effective even for quenched galaxies (and are thus likely insensitive to subgrid physics, which primarily affects the star-formation status), whereas the weaker DMO per-formance indicates that baryonic processes associated with quenching substantially modify halo properties in ways not captured by DMO size predictor.

properties, in Table A.1 and Table A.2. These re-lations offer computationally efficient tools for semi-analytic and empirical modelers wishing to populate ha-los with galaxies. Although the results here are specific to TNG50 physics, our analysis pipeline is public and modular, enabling straightforward extension to other simulations and subgrid models. ACKNOWLEDGMENTS We dedicate this work to the memory of our coauthor Avishai Dekel, whose insight, generosity, and vision con-tinue to inspire our research. FJ and JL thank the helpful discussion with Yangyao Chen. FJ acknowl-edges support by the National Natural Science Foun-dation of China (NSFC, 12473007) and China Manned Space Program with grant no. CMS-CSST-2025-A03. LCH was supported by the National Science Founda-tion of China (12233001) and the China Manned Space Program (CMS-CSST-2025-A09). APPENDIX  

> A.

MACHINE LEARNING ALGORITHMS In this work, we use different ML algorithms to explore relations between halo properties and disk properties. We describe their details here. A.1. Random Forest 

The RF algorithm is an ensemble-based ML method that aggregates outputs of multiple decision trees, each trained individually. A decision tree is constructed by recursively partitioning the feature space. At each node, the algorithm selects features and split points that min-imize regression error. This continues until leaf nodes are reached, which give the final prediction. Although decision trees are interpretable, they often overfit. RF mitigates this by adding controlled random-ness where each tree is trained on a bootstrap sample, and at each split only a random subset of features is considered. After all trees are built, RF averages their outputs, producing more robust predictions and reduc-ing overfitting. We use the RF regressor from scikit-learn (F. Pe-dregosa et al. 2011). The hyperparameters tuned in the module are listed below while other hyperparameters re-main default settings: 19 

Table A.1. Predicted empirical relations from SR for different targets using hydro simulation with œâ = 0 .7Target ‚àó R2 Model 

M‚ãÜ/M vir (All) 0.78 (0 .053 c ‚àí 1.673) e‚àí0.063 Mvir ,10 s + 0 .066 z1/2 ‚àí 1.515 SFR √ótH/M vir (All) 0.58 0.092 z1/2 ‚àí 1.217 e‚àí0.142 Mvir ,10 s ‚àí 1.297 

r1/2/R vir (All) ‚Ä† 0.65 log Œ± + e‚àí0.274 c + Œª0.597 inner log Mvir ,10 + 4 .643 ŒªzM ‚àí1.294 vir ,10 ‚àí 1.000 

fDisk (All) 0.48 (Œªinner + 0 .094) sinner ‚àí 0.396 e‚àí0.0043 Mvir ,10 c + 0 .635 

fThinDisk (All) 0.25 ‚àí1.292 M 0.665 vir ,10 c/ 10 4 ‚àí 0.215 log Œ± + 0 .040 ÀôMnorm + Œ± log Mvir ,10 log( cq inner ) ‚àí

0.428 ŒªfThickDisk (All) 0.30 0.077 sinner ‚àí0.173 e‚àí0.037 Mvir ,10 +Œª1.209 inner +0 .251+0 .014( Œ±c ‚àí3.428) log Mvir ,10 

R1/2,Disk /R vir (All) 0.44 Œªinner + ( Œª + c‚àí0.125 )(log Œ± + 3 .010) ‚àí 3.210 

R1/2,Disk /R vir (Low mass) 0.46 Œªinner + e‚àí0.324 c + log Œ± + Œª0.203 ‚àí 1.215 

R1/2,Disk /R vir (High mass) 0.62 1.858 Œªinner + 0 .263 log Œª + e‚àí0.231 c‚àí0.291 + 1 .253 log Œ± ‚àí 0.626 log( z + 1 .407) 

R1/2,ThinDisk /R vir (All) 0.40 2.731 Œª + ( c + 0 .036 Mvir ,10 )‚àí0.730 + log( Œ± + Œªinner ) ‚àí 0.943 

R1/2,ThinDisk /R vir (Low mass) 0.37 (c + 0 .408) ‚àí0.643 + log( Œª + 0 .099) + log( Œªinner + Œ±)

R1/2,ThinDisk /R vir (High mass) 0.56 Œª0.119 + log Œ± + e‚àí0.375 z (2 .618 Œªinner + 0 .327) ‚àí 0.231 log c ‚àí 1.323 

R1/2,ThickDisk /R vir (All) 0.60 log( Œªinner + Œ±) ‚àí 0.672 log(0 .043 Mvir ,10 + c) ‚àí 0.188 

R1/2,ThickDisk /R vir (Low mass) 0.59 0.722 z1/2Œª + log( Œªinner + Œ±) ‚àí 0.512 log c ‚àí 0.416 

R1/2,ThickDisk /R vir (High mass) 0.68 Œª0.421 ‚àí 0.303 log c ‚àí 0.069 z1/2 log(0 .105 Mvir ,10 ) + log( Œ±Œª inner + 0 .162) 

Z1/2,Disk /R vir (All) 0.79 Œªinner ‚àí (1 .681 Œ± + 0 .378) log c + log Œ± ‚àí 0.386 z log(0 .030 Mvir ,10 + 0 .750) + 0.112 log n1

Z1/2,Disk /R vir (Low mass) 0.74 Œ± + 0 .097( Œªinner ‚àí 0.123) Mvir ,10 + n0.087 1 + zŒª ‚àí 2.052 c0.093 

Z1/2,Disk /R vir (High mass) 0.70 1.967 Œªinner + 0 .241( Œ± ‚àí 0.013) c ‚àí 2.403 + ez1/2(Œª‚àí0.147) ‚àí

10 .667 Œ± log(0 .186 c) + log Œ±Z1/2,ThinDisk /R vir (All) 0.72 (Œªinner ‚àí 0.253) log Mvir ,10 + e‚àí0.191 c ‚àí 0.082 Œ±‚àí0.753 + zŒª ‚àí 1.912 

Z1/2,ThinDisk /R vir (Low mass) 0.70 Œ± + ( zŒª )0.694 ‚àí 1.939 c0.087 + 0 .109( Œªinner ‚àí 0.128) Mvir ,10 

Z1/2,ThinDisk /R vir (High mass) 0.58 log Œ± ‚àí 0.416 log( c + 1 .177) + z(M ‚àí0.447 vir ,10 ‚àí 0.227) + 1 .965( Œªinner + Œª) + 0.693 ‚àí 1.582 

Z1/2,ThickDisk /R vir (All) 0.78 0.593 log Œ± + Œªinner + n0.122 1 epinner ‚àí 0.532 log c ‚àí

0.220 z1/2 log(0 .024 Mvir ,10 + 0 .778) ‚àí 1.463 

Z1/2,ThickDisk /R vir (Low mass) 0.71 0.075 Mvir ,10 (Œ± + Œªinner ‚àí 0.259) ‚àí 0.508 log c + 5 .870( n0.191 1 ‚àí 0.311) 

Z1/2,ThickDisk /R vir (High mass) 0.69 2.799 Œªinner ‚àí log c(0 .617 log Œ± + 1 .194) + 1 .324(log Œ± ‚àí 0.399) + 

z1/2(M ‚àí0.650 vir ,10 ‚àí 0.145)  

> ‚àó

All targets are in base-10 logarithm except disk mass fractions.  

> ‚Ä†

œâ = 0 .9 is used for this equation. 

‚Ä¢ n estimators : the number of decision trees in the RF, taken from [200, 300, 400, 500, 600, 800, 1000, 1200]. 

‚Ä¢ max depth : the maximum depth of each tree, taken from [7, 10, 13, 16, 19, 22, 25]. 

‚Ä¢ min samples leaf : the minimum number of sam-ples required at a leaf node, taken over [10, 20, 50, 70, 95, 110]. 

‚Ä¢ max features : the maximum number of features to consider when looking for the best split, with options from [ sqrt , log2 , None ]. Specifically, sqrt 

uses the square root of the total number of fea-tures, log2 uses the base-2 logarithm, and None 

uses all available features. We use the GridSearchCV module from 

scikit-learn to tune the hyperparameters defined above. This module applies K-fold cross-validation, where the training set is split into K folds: one fold 20 

Table A.2. Predicted empirical relations from SR for different targets using DMO simulation with œâ = 0 .7Target ‚àó R2 Model 

M‚ãÜ/M vir (All) 0.73 0.081 z1/2 ‚àí 1.375 e‚àí0.089 Mvir ,10 s + 0 .042 c ‚àí 1.900 SFR √ótH/M vir (All) 0.54 0.101 z1/2 + e‚àí0.146 Mvir ,10 s(0 .014 M ‚àí2.337 vir ,10 ‚àí 1.334) ‚àí 1.296 

r1/2/R vir (All) 0.54 log( Œª + 0 .162) log( Mvir ,10 + c) + log( z + s) ‚àí 1.474 + e‚àí1.272 Mvir ,10 +0 .642 +

Œªinner + (0 .643 ‚àí 0.201 z0.463 )(log Mvir ,10 + 0 .374) 

fDisk (All) 0.43 0.160 qinner + c0.476 Mvir ,10 (Mvir ,10 + 35 .67) ‚àí1.31 + 0 .172 

fThinDisk (All) 0.28 0.077( qinner + log z1/2) + ‚àí0.284 e‚àí0.010 cM vir ,10 + 0 .310 

fThickDisk (All) 0.20 0.477 Œªinner + (0 .052 qinner ‚àí 0.092) log 10 Mvir ,10 ‚àí 0.243 e‚àí0.063 sM vir ,10 + 0 .382 

R1/2,Disk /R vir (All) 0.41 log Mvir ,10 (Œª0.251 ‚àí 0.339) + z(Œª + 0 .088) + e‚àí0.021 c‚àí0.007 zM vir ,10 +0 .045 +0.343 q ‚àí 2.696 

R1/2,Disk /R vir (Low mass) 0.29 Œª‚àí0.084 (Œªinner ‚àí 1.122) + eMvir ,10 Œª‚àí0.090 log(0 .587 z + q)

R1/2,Disk /R vir (High mass) 0.27 ‚àí0.387 log Mvir ,10 ze ÀôMnorm + log Œª + 0 .328( z1.101 + q) ‚àí 3.663 Œª log Mvir ,10 

R1/2,ThinDisk /R vir (All) 0.37 n0.087 1 + ( Œª0.344 + Œªinner ) log Mvir ,10 + ( Œª + 0 .578)(log q + z) ‚àí 0.359( z +1.284)( Mvir ,10 + c)0.177 ‚àí 1.106 

R1/2,ThinDisk /R vir (Low mass) 0.33 (log z1/2 +0 .098 Mvir ,10 )( ‚àí0.063 z+Œªinner )+0 .335 log( qŒª )+ z(Œª+0 .146) ‚àí0.906 

R1/2,ThinDisk /R vir (High mass) 0.29 0.486 log( Œªq ) + ( M ‚àí0.221 vir ,10 ‚àí 0.969)(0 .992 + z)0.332 

R1/2,ThickDisk /R vir (All) 0.52 Œª0.193 (z + 0 .519) 0.396 ‚àí 1.344 z(M ‚àí0.971 vir ,10 + 0 .067) ‚àí3.987 /10 ‚àí5 + Œªinner ‚àí 2.141 

R1/2,ThickDisk /R vir (Low mass) 0.48 Œªinner + Œª0.268 ‚àí 0.005 Mvir ,10 z ‚àí 0.020 c + log( z + 2 .054 q) ‚àí 2.153 

R1/2,ThickDisk /R vir (High mass) 0.38 0.481( z + log Œª) ‚àí (0 .375 z + 0 .101)(log Mvir ,10 + ÀôMnorm ) ‚àí 0.940 

Z1/2,Disk /R vir (All) 0.68 Œª0.435 ‚àí 0.446 log c + ( pinner + z0.596 )( ‚àí0.237 M 0.224 vir ,10 + 0 .534) ‚àí 2.219 

Z1/2,Disk /R vir (Low mass) 0.66 Œª0.302 ‚àí 0.461 log c + ( z + 0 .208) 0.515 (‚àí0.012 Mvir ,10 + 0 .350) ‚àí 2.318 

Z1/2,Disk /R vir (High mass) 0.23 1.931 Œªinner + ( z1/2 ‚àí 0.082 c)(0 .105 Mvir ,10 )‚àí0.938 + 0 .158 z1/2 log Œª +0.389 s ‚àí 2.600 

Z1/2,ThinDisk /R vir (All) 0.65 (Œª + 0 .714)( z + 1 .932) ‚àí (0 .424 z + 0 .184) log( Mvir ,10 + 3 .137 z1/2) ‚àí 3.630 

Z1/2,ThinDisk /R vir (Low mass) 0.65 ‚àí0.813 e‚àí0.326 z + 0 .095 z1/2Mvir ,10 (Œª ‚àí 0.086) ‚àí 0.282 log c ‚àí 1.214 

Z1/2,ThinDisk /R vir (High mass) 0.26 (M ‚àí0.4900863 vir ,10 ‚àí 0.174)3 .048 z ‚àí 0.088 z1.898 [log( Œ± + 0 .209) + PC2] + 0.331( qinner + log Œª) ‚àí 2.281 

Z1/2,ThickDisk /R vir (All) 0.70 (z0.736 + s)( Œª + 0 .291) ‚àí 0.379 z1/2 log(0 .042 Mvir ,10 + 1 .064) ‚àí 2.412 

Z1/2,ThickDisk /R vir (Low mass) 0.66 0.206( s + log Œª) + (0 .315 ‚àí 0.011 Mvir ,10 )z0.562 ‚àí 0.426 log c ‚àí 1.669 

Z1/2,ThickDisk /R vir (High mass) 0.38 Œªinner + 0 .155 z1/2 log Œª + 9 .116 z1/2c‚àí0.272 M ‚àí0.880603 vir ,10 ‚àí 2.322  

> ‚àó

All targets are in base-10 logarithm except disk mass fractions. 

is used for validation while the remaining K-1 folds are used for training, repeated K times. For each hyperparameter combination, performance is evalu-ated using the chosen metric, and the best set of pa-rameters is selected. In our experiments, we use 5-fold cross-validation with negative mean squared error (neg mean squared error ) as the scoring metric. A.2. Shapley Additive Explanations Values 

To interpret regression results from the complex tree structures in RF, we use SHAP (S. Lundberg & S.-I. Lee 2017), a game-theoretic method. SHAP evaluates how much each feature contributes to a prediction by comparing the model‚Äôs output with and without that feature across many possible feature combinations. ASHAP value is the weighted average of these marginal contributions, capturing both the direction and strength of a feature‚Äôs effect. A positive SHAP value indicates that a feature in-creases the prediction relative to a baseline, while a neg-ative value indicates a decrease. For each data point, the sum of all SHAP values equals the difference between the model‚Äôs prediction and the baseline. The absolute values show how strongly each feature influences the prediction. By aggregating SHAP values across data points, we can 21 10 3 10 2 10 1                

> R1/2, ThinDisk /Rvir (Pred)
> 10 3
> 10 2
> 10 1
> R1/2, ThinDisk /Rvir  (Test)
> fDisk > 0.3, fThin/ThickDisk > 0.1
> Hydro RF (SR)
> DMO RF (SR)
> MAE=
> R2=
> RMSE=
> 0.13
> 0.60
> 0.17
> 0.15
> 0.47
> 0.19
> (0.15)
> (0.40)
> (0.20)
> (0.16)
> (0.37)
> (0.21)
> All
> 10 310 210 1
> R1/2, ThinDisk /Rvir (Pred)
> 0.12
> 0.53
> 0.16
> 0.15
> 0.40
> 0.19
> (0.14)
> (0.37)
> (0.18)
> (0.15)
> (0.33)
> (0.20)

10 10.6 Mvir /M < 10 11.6       

> 10 310 210 1
> R1/2, ThinDisk /Rvir (Pred)
> 0.16
> 0.57
> 0.22
> 0.22
> 0.37
> 0.29
> (0.16)
> (0.56)
> (0.22)
> (0.23)
> (0.29)
> (0.31)

10 11.6 Mvir /M         

> 020 40 60
> Percentage of total |SHAP values|
> c
> inner
> Mvir, 10
> pinner
> z
> z1/2
> s
> Tinner
> Mvir, 10
> z
> q
> c
> inner
> PC1
> s
> n1
> Mnorm
> 020 40 60
> Percentage of total |SHAP values|
> c
> inner
> Mvir, 10
> pinner
> z1/2
> s
> sinner
> q
> z
> Mvir, 10
> c
> q
> inner
> z1/2
> Mnorm
> s
> T
> 020 40 60
> Percentage of total |SHAP values|
> inner
> z1/2
> z
> Mnorm
> s
> c
> p
> q
> z
> Mvir, 10
> c
> PC1
> s
> q
> qinner
> PC2

Figure A1. Predictions for thin disk compactness R1/2,ThinDisk /R vir from ML algorithms. The colors and styles for lines and symbols are similar to Fig. 3, except the samples are further limited by fThinDisk > 0.1 and fThickDisk > 0.1. 

identify and rank the most influential features. How-ever, SHAP does not measure model accuracy or reveal direct correlations among features. A.3. Symbolic Regression 

For finding empirical and interpretable equations from the most important features identified by SHAP, we ap-ply the SR (e.g. J. R. Koza 1992) equation search algo-rithm PySR (M. Cranmer 2023). 

PySR is based on genetic programming, which searches for multiple candidate equations (populations) in paral-lel rather than just a single solution. Each candidate equation is represented as a tree structure, where the nodes are mathematical operators and the leaves are variables or constants. The algorithm begins by randomly initializing popu-lations of simple equations using the given input fea-tures and operators. It then evaluates the loss of each equation on the data and iteratively improves them through evolutionary steps including mutation (chang-ing an operator or replacing a subtree), crossover (swap-ping branches between equations), and selection (keep-ing the equations that minimize the loss). Afterward, 

PySR applies simplification rules and optimizes constants within the equations. Once all populations complete one evolutionary cycle (a generation), migration occurs which exchange a frac-tion of equations between populations or replace them with top-performing candidates from the overall pool. This promotes diversity and helps avoid getting stuck in local optima. The PySR configuration in this work is implemented on a large-scale setup with 150 populations, each con-taining 27 individuals, allowing the algorithm to run for up to 300 iterations with 500 cycles per iteration, thereby ensuring thorough exploration of the expres-sion space. The model is restricted to the binary op-erators multiplication ( √ó), plus (+), and power ( b ), and the unary operators exponential (exp) and base-10 logarithm (log). Variable complexity is set to 3, while constant and operator complexities are set to 1. Strict complexity constraints are enforced, including a maxi-mum expression size of 100 and a depth limit of 8. Fur-thermore, nested operations of exponential, base-10 log-arithm, and power are prohibited to avoid overly com-plex expressions. Weight optimization is set to 0.001, with higher values resulting in more frequent optimiza-tion steps. All other hyperparameters are left at their default settings. The loss function L used in this work combines a nor-malized mean squared error term LNMSE with a nor-malized quantile loss term LNQL . The normalized mean squared error term takes form 

LNMSE = ( y ‚àí ÀÜy)2/y 2 (A1) where y is the real values and ÀÜy is the predicted values. The normalized quantile loss captures the asymmetric penalties for underestimation and overes-timation across multiple quantiles œÑi which taken from 22 10 3 10 2 10 1                

> R1/2, ThickDisk /Rvir (Pred)
> 10 3
> 10 2
> 10 1
> R1/2, ThickDisk /Rvir  (Test)
> fDisk > 0.3, fThin/ThickDisk > 0.1
> Hydro RF (SR)
> DMO RF (SR)
> MAE=
> R2=
> RMSE=
> 0.11
> 0.75
> 0.14
> 0.13
> 0.63
> 0.17
> (0.13)
> (0.60)
> (0.18)
> (0.15)
> (0.52)
> (0.19)
> All
> 10 310 210 1
> R1/2, ThickDisk /Rvir (Pred)
> 0.10
> 0.67
> 0.13
> 0.13
> 0.54
> 0.17
> (0.11)
> (0.59)
> (0.15)
> (0.14)
> (0.48)
> (0.18)

10 10.6 Mvir /M < 10 11.6       

> 10 310 210 1
> R1/2, ThickDisk /Rvir (Pred)
> 0.15
> 0.60
> 0.19
> 0.20
> 0.39
> 0.26
> (0.13)
> (0.68)
> (0.17)
> (0.20)
> (0.38)
> (0.26)

10 11.6 Mvir /M         

> 020 40 60
> Percentage of total |SHAP values|
> c
> z
> Mvir, 10
> inner
> z1/2
> pinner
> s
> Mnorm
> z
> Mvir, 10
> c
> inner
> Mnorm
> q
> s
> PC2
> z1/2
> 020 40 60
> Percentage of total |SHAP values|
> c
> inner
> z
> Mvir, 10
> z1/2
> sinner
> pinner
> s
> z
> Mvir, 10
> q
> inner
> c
> Mnorm
> PC1
> s
> PC2
> 020 40 60
> Percentage of total |SHAP values|
> inner
> z1/2
> c
> Mvir, 10
> Mnorm
> PC2
> T
> PC1
> Mvir, 10
> z1/2
> Mnorm
> PC2
> z
> c
> Envir
> s

Figure A2. Performance of regression models for thick disk compactness R1/2,ThickDisk /R vir from ML algorithms. 

The colors and styles for lines and symbols are similar to Fig. 3, except the samples are further limited by fThinDisk > 0.1 and 

fThickDisk > 0.1. 

[0.1,0.25,0.5,0.75,0.9]. The quantile loss is computed as 

LNQL = 15

œÑiX

i=1 

"

œÑi max 

 y ‚àí ÀÜyy , 0



+ (1 ‚àí œÑi) max 



‚àí y ‚àí ÀÜyy , 0

#

(A2) The final loss function is taken from L = LNMSE +LNQL .Besides the equations, PySR also returns the loss L and complexity C for each equation. More complex equations typically achieve lower loss but are harder to interpret and implement into semi-analytical models. To balance complexity and loss, we designed a score to automat-ically select equations from all possible solutions. We first construct normalized loss ÀúL and normalized com-plexity ÀúC by ÀúL = L ‚àí min( L)max( L) ‚àí min( L) , ÀúC = C ‚àí min( C)max( C) ‚àí min( C) (A3) Then the score is defined as Score = 

"

w log(1 + ÀúL) + (1 ‚àí w) log(1 + ÀúC)

#‚àí1

(A4) where w is the weight. This formula first increases with complexity, reaching a maximum, and then decreases with complexity. We choose the equation at the max-imum point. A higher w results in greater complexity but lower loss at the maximum point. We set the w to 0.7 which leads a equation with complexity ‚àº 50. 

B. EMPIRICAL RELATIONS FROM SYMBOLIC REGRESSION In this section, we provide our empirical relations from SR using w = 0 .7 in Table A.1 and Table A.2 for hydro and DMO simualtion, respectively. Other equations returned by symbolic regression are pro-vided in https://github.com/JinningLianggithub/Gal-halo Symbolic-regression. 

C. THIN AND THICK DISKS In this section, we show the RF and SR results for both thin and thick disks, which are separated using the morphological decomposition method (see Paper I for details) In addition to applying the total disk mass fraction cut of fDisk > 0.3, we further require a thin disk mass fraction of fThinDisk > 0.1 and a thick disk mass fraction of fThickDisk > 0.1. C.1. Sizes 

Fig. A1 and Fig. A2 present predictions for the com-pactness of thin and thick disks, respectively. 

Model accuracy: The thin disk compactness is pre-dicted with accuracy comparable to that of the total disk, yielding R2 = 0 .60 (0.47) from RF and R2 = 0 .40 (0.37) from SR, using hydro (DMO) dataset. The thick disk is even more predictable, with R2 = 0 .75 (0.63) from RF, R2 = 0 .60 (0.52) from SR, using hydro (DMO) dataset. 23 10 3 10 2             

> Z1/2, ThinDisk /Rvir (Pred)
> 10 3
> 10 2
> Z1/2, ThinDisk /Rvir  (Test)
> fDisk > 0.3, fThin/ThickDisk > 0.1
> Hydro RF (SR)
> DMO RF (SR)
> MAE=
> R2=
> RMSE=
> 0.10
> 0.81
> 0.13
> 0.12
> 0.73
> 0.16
> (0.12)
> (0.72)
> (0.16)
> (0.13)
> (0.65)
> (0.18)
> All
> 10 310 2
> Z1/2, ThinDisk /Rvir (Pred)
> 0.10
> 0.75
> 0.13
> 0.11
> 0.67
> 0.15
> (0.10)
> (0.70)
> (0.14)
> (0.12)
> (0.65)
> (0.15)

10 10.6 Mvir /M < 10 11.6     

> 10 310 2
> Z1/2, ThinDisk /Rvir (Pred)
> 0.14
> 0.54
> 0.20
> 0.18
> 0.37
> 0.23
> (0.14)
> (0.58)
> (0.19)
> (0.19)
> (0.26)
> (0.25)

10 11.6 Mvir /M         

> 020 40 60
> Percentage of total |SHAP values|
> Mvir, 10
> c
> z
> inner
> n1
> Mnorm
> z1/2
> 1
> Mvir, 10
> z
> c
> Mnorm
> z1/2
> inner
> s
> PC2
> 3
> 020 40 60
> Percentage of total |SHAP values|
> c
> Mvir, 10
> z
> inner
> Mnorm
> n1
> 1
> 3
> z
> Mvir, 10
> c
> Mnorm
> inner
> q
> s
> z1/2
> PC2
> 020 40 60
> Percentage of total |SHAP values|
> inner
> c
> z1/2
> Mvir, 10
> Mnorm
> PC2
> z
> s
> Mvir, 10
> z1/2
> PC1
> z
> PC2
> Mnorm
> Tinner
> qinner

Figure C3. Performance of regression models for thin disk thickness Z1/2,ThinDisk /R vir . The samples are limited to 

fThinDisk > 0.1 and fThickDisk > 0.1. Everything else follows Fig. 3. 

Feature importance: For hydro dataset, the most important halo properties for both thin and thick disk compactness are Œ±, c, Mvir ,10 , Œª, Œªinner , and z. These are nearly the same as those for the total disk. Similarly, for DMO halos, the shared important properties are z,

Mvir , Œª, c.

Symbolic regression: While the SR models for thin disk compactness reach accuracy levels similar to those of the total disk, the thick disk prediction are noticeably better. The full analytic forms of the SR relations are listed in Table A.1 and Table A.2. 

Mass dependence: For both thin and thick disks, the R2 values are lower in each mass bin than for the full sample, for both RF and SR. The set of important fea-tures remains broadly similar. They are Œ±, Œªinner , c and 

Œª for the thin and thick disks using hydro dataset. In the DMO dataset, common important features include 

Œª, Mvir ,10 , z, c for the thin disk. For the thick disk, low-mass halos also show Œª, Mvir ,10 , z are important. Differently, high-mass halos show more formation and environmental parameters are important, which include 

z1/2, ÀôMnorm and PC2, C.2. Scale heights 

The prediction for thickness of thin and thick disks are presented in Fig. C3 and Fig. C4, respectively. 

Model accuracy: Similar to the total disk, the pre-diction accuracies for thin and thick disk thicknesses are noticeably higher than those for their compactness, for both RF and SR. The predictions for thin disk thickness achieve a R2 = 0 .81 (0.73) from RF and R2 = 0 .72 (0.65) from SR, using hydro (DMO) dataset. Similarly, the thick disk achieve R2 = 0 .83 (0.77) from RF, R2 = 0 .78 (0.70) from SR, using hydro (DMO) dataset. 

Feature importance: Using the hydro dataset, 

Mvir ,10 , Œ±, c, Œª, Œªinner , and z remain the most impor-tant halo properties for the disk thickness of thin and thick disks, the same as their compactness. With the DMO dataset, z, Mvir ,10 , Œª, c, and ÀôMnorm are the dom-inant halo parameters for the predictions of thin and thick disk thickness. The appear of ÀôMnorm is slightly different from their disk compactness, which potentially highlights the disk heating by accretion. 

Symbolic regression: The SR prediction accuracy for thin and thick disk thicknesses is similar to that for the total disk. The full analytic SR expressions are pro-vided in Table A.1 and Table A.2. Notably, the SR models capture additional formation and environmental properties including z1/2 and n1 in the relations. 

Mass dependence: 

Using the hydro dataset, the key halo properties within individual mass bins remain broadly consistent with those of the full sample for both disk types. In both low and high mass halos, halo mass ranks lower in importance. In the high-mass halos, z1/2 emerges as a more important parameter, replacing z. With the DMO dataset, low-mass halos show the same dominant parameters as in the full sample for both disks. In high-24 10 3 10 2             

> Z1/2, ThickDisk /Rvir (Pred)
> 10 3
> 10 2
> Z1/2, ThickDisk /Rvir  (Test)
> fDisk > 0.3, fThin/ThickDisk > 0.1
> Hydro RF (SR)
> DMO RF (SR)
> MAE=
> R2=
> RMSE=
> 0.09
> 0.83
> 0.13
> 0.11
> 0.77
> 0.15
> (0.11)
> (0.78)
> (0.14)
> (0.12)
> (0.70)
> (0.17)
> All
> 10 310 2
> Z1/2, ThickDisk /Rvir (Pred)
> 0.09
> 0.78
> 0.12
> 0.11
> 0.70
> 0.14
> (0.10)
> (0.71)
> (0.13)
> (0.11)
> (0.66)
> (0.15)

10 10.6 Mvir /M < 10 11.6     

> 10 310 2
> Z1/2, ThickDisk /Rvir (Pred)
> 0.15
> 0.58
> 0.20
> 0.18
> 0.43
> 0.23
> (0.12)
> (0.71)
> (0.16)
> (0.19)
> (0.38)
> (0.24)

10 11.6 Mvir /M         

> 020 40 60
> Percentage of total |SHAP values|
> Mvir, 10
> z
> c
> inner
> Mnorm
> pinner
> z1/2
> n1
> Mvir, 10
> z
> Mnorm
> c
> z1/2
> PC2
> s
> pinner
> inner
> 020 40 60
> Percentage of total |SHAP values|
> c
> z
> Mvir, 10
> inner
> pinner
> Mnorm
> s
> n1
> z
> Mvir, 10
> c
> Mnorm
> s
> q
> inner
> PC2
> 3
> 020 40 60
> Percentage of total |SHAP values|
> inner
> c
> z1/2
> Mvir, 10
> Mnorm
> PC2
> RTotal
> z
> Mvir, 10
> Mnorm
> z1/2
> PC2
> inner
> Envir
> RTotal
> c

Figure C4. Performance of regression models for thick disk thickness Z1/2,ThickDisk /R vir . The samples are limited to 

fThinDisk > 0.1 and fThickDisk > 0.1. Everything else follows Fig. 3. 

mass halos, both disk types show increased importance in formation and environmental properties. C.3. Mass fraction 

The predictions for the mass fractions of thin and thick disks are shown in Fig. D5. 

Model accuracy: As with the total disk, the sample is not divided into different halo mass bins. The predic-tion accuracy for thin disk mass fraction is higher than that for the total disk, reaching R2 = 0 .60 (0.56) for the hydro (DMO) dataset. For both datasets, the ac-curacy for thin disks is about 0.2 higher than for thick disks. The SR models exhibit lower accuracy than the RF models, with deficits of roughly 0.15‚Äì0.3 for both thin and thick disk mass fractions. 

Feature importance: Except for halo mass and one additional key property ( c for the thin disk and Œªinner for the thick disk), the remaining halo properties all have rather weak importance. Symbolic regression: In the SR relation, the halo mass and second property above are captured. Inner shape parameters (e.g. qinner and 

sinner ) and formation parameters (e.g. ÀôMnorm and z1/2)are also incorporated. The explicit forms of the SR re-lations are provided in Table A.1 and Table A.2. 

D. BIAS IN SAMPLE SELECTION Following Paper I, we require a minimum of 1000 stel-lar and 1000 DM particles. The stellar threshold ensures robust morphological decomposition but is the more re-strictive condition. Since galaxies with 1,000 stellar par-ticles typically inhabit halos well above the mass equiv-alent of 1000 DM particles, our sample and the mea-surements for halo quantities becomes incomplete at the low-mass end. From a physical perspective, we ignore galaxies that are strongly DM-dominated, which may represent a substantial fraction of the population. Such incompleteness biases the comparisons between predictions and data. Note that because predictions are calculated from the SR relation using halo measure-ments, they effectively act as halo properties. This bias is evident in three perspectives. First, while binning by predictions yields medians close to the data, the reverse (binning by data) exposes a bias at the low-mass end. Second, the visual agreement and R2 values improve when plotting physical quantities (e.g., M‚ãÜ) rather than normalized ones (e.g., M‚ãÜ/M vir ). Third, the maximum halo mass for the galaxies with 1000 stellar particles is 

‚àº 10 10 .8M‚äô. If one test the RF and SR using samples with halo mass above this threshold, the performance will be better. We therefore caution the use of SR rela-tions for samples below this threshold. 25 0.2 0.4 0.6 0.8                      

> fThinDisk (Pred)
> 0.2
> 0.4
> 0.6
> 0.8
> fThinDisk  (Test)
> Hydro RF (SR)
> DMO RF (SR)
> fDisk > 0.3, fThin/ThickDisk > 0.1
> 0.07
> 0.60
> 0.08
> 0.07
> 0.56
> 0.09
> (0.09)
> (0.25)
> (0.12)
> (0.09)
> (0.28)
> (0.11)
> 025 50 75 100
> Percentage of total |SHAP values|
> Mvir, 10
> c
> qinner
> inner
> zMajor
> sinner
> RTotal
> Mnorm
> Mvir, 10
> c
> sinner
> qinner
> Mnorm
> s
> z1/2
> q
> RTotal
> 0.2 0.4 0.6
> fThickDisk (Pred)
> 0.1
> 0.2
> 0.3
> 0.4
> 0.5
> 0.6
> fThickDisk  (Test)
> fDisk > 0.3, fThin/ThickDisk > 0.1
> 0.04
> 0.44
> 0.05
> 0.04
> 0.35
> 0.06
> (0.04)
> (0.30)
> (0.06)
> (0.05)
> (0.20)
> (0.06)
> 025 50 75 100
> Percentage of total |SHAP values|
> Mvir, 10
> inner
> c
> sinner
> qinner
> Mnorm
> z
> s
> 1
> Mvir, 10
> inner
> qinner
> s
> z
> sinner
> Mnorm
> q
> c
> 5

Figure D5. Performance of regression models for thin and thick disk mass fractions. The left and right columns present the results for the thin ( fThinDisk ), and thick disk ( fThickDisk ) mass fractions, respectively. The sample is limited to 

fDisk > 0.3, fThinDisk > 0.1, and fThickDisk > 0.1. Everything else follows Fig. 3. 

REFERENCES 

Allgood, B., Flores, R. A., Primack, J. R., et al. 2006, MNRAS, 367, 1781, doi: 10.1111/j.1365-2966.2006.10094.x Behroozi, P., Hearin, A., & Moster, B. P. 2022, MNRAS, 509, 2800, doi: 10.1093/mnras/stab3193 Blumenthal, G. R., Faber, S. M., Flores, R., & Primack, J. R. 1986, ApJ, 301, 27, doi: 10.1086/163867 Breiman, L. 2001, Machine Learning, 45, 5, doi: 10.1023/A:1010933404324 Bullock, J. S., Dekel, A., Kolatt, T. S., et al. 2001, ApJ, 555, 240, doi: 10.1086/321477 Chen, Y., Mo, H. J., Li, C., et al. 2020, ApJ, 899, 81, doi: 10.3847/1538-4357/aba597 Cole, S., Lacey, C. G., Baugh, C. M., & Frenk, C. S. 2000, MNRAS, 319, 168, doi: 10.1046/j.1365-8711.2000.03879.x Cranmer, M. 2023, arXiv e-prints, arXiv:2305.01582, doi: 10.48550/arXiv.2305.01582 Davis, M., Efstathiou, G., Frenk, C. S., & White, S. D. M. 1985, ApJ, 292, 371, doi: 10.1086/163168 Dekel, A., Birnboim, Y., Engel, G., et al. 2009, Nature, 457, 451, doi: 10.1038/nature07648 Di Cintio, A., Brook, C. B., Macci` o, A. V., et al. 2014, MNRAS, 437, 415, doi: 10.1093/mnras/stt1891 Du, M., Ho, L. C., Zhao, D., et al. 2019, ApJ, 884, 129, doi: 10.3847/1538-4357/ab43cc Dubois, Y., Peirani, S., Pichon, C., et al. 2016, MNRAS, 463, 3948, doi: 10.1093/mnras/stw2265 Einasto, J. 1965, Trudy Astrofizicheskogo Instituta Alma-Ata, 5, 87 Fall, S. M. 1983, in IAU Symposium, Vol. 100, Internal Kinematics and Dynamics of Galaxies, ed. E. Athanassoula, 391‚Äì398 Fall, S. M., & Efstathiou, G. 1980, MNRAS, 193, 189, doi: 10.1093/mnras/193.2.189 Forero-Romero, J. E., Hoffman, Y., Gottl¬® ober, S., Klypin, A., & Yepes, G. 2009, MNRAS, 396, 1815, doi: 10.1111/j.1365-2966.2009.14885.x Freundlich, J., Dekel, A., Jiang, F., et al. 2020, MNRAS, 491, 4523, doi: 10.1093/mnras/stz3306 Genel, S., Nelson, D., Pillepich, A., et al. 2018, MNRAS, 474, 3976, doi: 10.1093/mnras/stx3078 Gnedin, O. Y., Kravtsov, A. V., Klypin, A. A., & Nagai, D. 2004, ApJ, 616, 16, doi: 10.1086/424914 Hahn, O., Porciani, C., Carollo, C. M., & Dekel, A. 2007, MNRAS, 375, 489, doi: 10.1111/j.1365-2966.2006.11318.x Henriques, B. M. B., Yates, R. M., Fu, J., et al. 2020, MNRAS, 491, 5795, doi: 10.1093/mnras/stz3233 Huang, K.-H., Fall, S. M., Ferguson, H. C., et al. 2017, ApJ, 838, 6, doi: 10.3847/1538-4357/aa62a6 Jiang, F., Dekel, A., Kneller, O., et al. 2019, MNRAS, 488, 4801, doi: 10.1093/mnras/stz1952 Jiang, F., Liang, J., Jin, B., et al. 2025, arXiv e-prints, arXiv:2504.01070, doi: 10.48550/arXiv.2504.01070 26 

Kim, J.-h., & Lee, J. 2013, MNRAS, 432, 1701, doi: 10.1093/mnras/stt632 Koza, J. R. 1992, Genetic programming. On the programming of computers by means of natural selection Kravtsov, A. V. 2013, ApJL, 764, L31, doi: 10.1088/2041-8205/764/2/L31 Lacey, C. G., Baugh, C. M., Frenk, C. S., et al. 2016, MNRAS, 462, 3854, doi: 10.1093/mnras/stw1888 Lapiner, S., Dekel, A., Freundlich, J., et al. 2023, MNRAS, 522, 4515, doi: 10.1093/mnras/stad1263 Liang, J., Jiang, F., Mo, H., et al. 2025, MNRAS, 541, 2304, doi: 10.1093/mnras/staf947 Lundberg, S., & Lee, S.-I. 2017, A Unified Approach to Interpreting Model Predictions, https://arxiv.org/abs/1705.07874 Martizzi, D., Vogelsberger, M., Artale, M. C., et al. 2019, MNRAS, 486, 3766, doi: 10.1093/mnras/stz1106 McBride, J., Fakhouri, O., & Ma, C.-P. 2009, MNRAS, 398, 1858, doi: 10.1111/j.1365-2966.2009.15329.x Mo, H. J., Mao, S., & White, S. D. M. 1998, MNRAS, 295, 319, doi: 10.1046/j.1365-8711.1998.01227.x Nadler, E. O., Wechsler, R. H., Bechtol, K., et al. 2020, ApJ, 893, 48, doi: 10.3847/1538-4357/ab846a Nelson, D., Pillepich, A., Springel, V., et al. 2019, MNRAS, 490, 3234, doi: 10.1093/mnras/stz2306 Pedregosa, F., Varoquaux, G., Gramfort, A., et al. 2011, Journal of Machine Learning Research, 12, 2825, doi: 10.48550/arXiv.1201.0490 Pillepich, A., Nelson, D., Springel, V., et al. 2019, MNRAS, 490, 3196, doi: 10.1093/mnras/stz2338 Rodriguez-Gomez, V., Genel, S., Vogelsberger, M., et al. 2015, MNRAS, 449, 49, doi: 10.1093/mnras/stv264 Somerville, R. S., Gabrielpillai, A., Hadzhiyska, B., & Genel, S. 2025, arXiv e-prints, arXiv:2502.03679, doi: 10.48550/arXiv.2502.03679 Somerville, R. S., Behroozi, P., Pandya, V., et al. 2018, MNRAS, 473, 2714, doi: 10.1093/mnras/stx2040 Sotnikova, N. Y., & Rodionov, S. A. 2006, Astronomy Letters, 32, 649, doi: 10.1134/S106377370610001X Springel, V., White, S. D. M., Tormen, G., & Kauffmann, G. 2001, MNRAS, 328, 726, doi: 10.1046/j.1365-8711.2001.04912.x Tomassetti, M., Dekel, A., Mandelker, N., et al. 2016, MNRAS, 458, 4477, doi: 10.1093/mnras/stw606 van den Bosch, F. C. 2002, MNRAS, 331, 98, doi: 10.1046/j.1365-8711.2002.05171.x Wang, H., Mo, H. J., Jing, Y. P., Yang, X., & Wang, Y. 2011, MNRAS, 413, 1973, doi: 10.1111/j.1365-2966.2011.18301.x Wechsler, R. H., Bullock, J. S., Primack, J. R., Kravtsov, A. V., & Dekel, A. 2002, ApJ, 568, 52, doi: 10.1086/338765 Wetzel, A. R., Tinker, J. L., Conroy, C., & van den Bosch, F. C. 2013, MNRAS, 432, 336, doi: 10.1093/mnras/stt469 White, S. D. M., & Rees, M. J. 1978, MNRAS, 183, 341, doi: 10.1093/mnras/183.3.341 Zana, T., Lupi, A., Bonetti, M., et al. 2022, MNRAS, 515, 1524, doi: 10.1093/mnras/stac1708 Zasov, A. V., Bizyaev, D. V., Makarov, D. I., & Tyurina, N. V. 2002, Astronomy Letters, 28, 527, doi: 10.1134/1.1499176 Zhao, D. H., Mo, H. J., Jing, Y. P., & B¬® orner, G. 2003, MNRAS, 339, 12, doi: 10.1046/j.1365-8711.2003.06135.x Zolotov, A., Dekel, A., Mandelker, N., et al. 2015, MNRAS, 450, 2327, doi: 10.1093/mnras/stv740