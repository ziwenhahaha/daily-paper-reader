Title: SRLR: Symbolic Regression based Logic Recovery to Counter Programmable Logic Controller Attacks

URL Source: https://arxiv.org/pdf/2512.11298v1

Published Time: Mon, 15 Dec 2025 01:28:25 GMT

Number of Pages: 27

Markdown Content:
> IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 1

# SRLR: Symbolic Regression based Logic Recovery to Counter Programmable Logic Controller Attacks 

Hao Zhou a, Suman Sourav b, Binbin Chen c, Ke Yu aa Beijing University of Posts and Telecommunications, China  

> b

Aalborg University, Denmark  

> c

Singapore University of Technology and Design, Singapore {zhouh, yuke}@bupt.edu.cn, sumansourav@cs.aau.dk, binbin_chen@sutd.edu.sg 

Abstractâ€”Programmable Logic Controllers (PLCs) are crit-ical components in Industrial Control Systems (ICSs). Their potential exposure to external world makes them susceptible to cyber-attacks. Existing detection methods against controller logic attacks use either specification-based or learnt models. However, specification-based models require expertsâ€™ manual efforts or access to PLCâ€™s source code, while machine learning-based models often fall short of providing explanation for their decisions. We design SRLR â€” a Symbolic Regression based Logic Recovery solution to identify the logic of a PLC based only on its inputs and outputs. The recovered logic is used to generate explainable rules for detecting controller logic attacks. SRLR enhances the latest deep symbolic regression methods using the following ICS-specific properties: (1) some important ICS control logic is best represented in frequency domain rather than time domain; (2) an ICS controller can operate in multiple modes, each using different logic, where mode switches usually do not happen frequently; (3) a robust controller usually filters out outlier inputs as ICS sensor data can be noisy; and (4) with the above factors captured, the degree of complexity of the formulas is reduced, making effective search possible. Thanks to these enhancements, SRLR consistently outperforms all existing methods in a variety of ICS settings that we evaluate. In terms of the recovery accuracy, SRLRâ€™s gain can be as high as 39% in some challenging environment. We also evaluate SRLR on a distribution grid containing hundreds of voltage regulators, demonstrating its stability in handling large-scale, complex systems with varied configurations. Index Termsâ€”Cyber-physical System Security, Symbolic Regression, Logic Recovery, Programmable Logic Controller. 

I. Introduction In the era of Industry 4.0, critical infrastructures are integrated with advanced communication networks and physical processes, leading to the emergence of diverse ICSs such as water treatment plants and power control systems. However, this integration in ICSs exposes indus-trial process to various vulnerabilities, thus precipitating severe security challenges [1], [2]. Internet-connected PLCs play a pivotal role in ICSs. High-profile attacks, such                             

> This article was accepted by IEEE Transactions on Information Forensics and Security. Corresponding author: Ke Yu (yuke@bupt.edu.cn). Digital Object Identifier 10.1109/TIFS.2025.3634027 Â©2025 IEEE. Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists, or reuse of any copyrighted component of this work in other works.

as Stuxnet [3], manipulate the configuration of PLCs or tamper with PLCâ€™s output commands to compromise physical processes. Various Intrusion Detection Systems (IDSs) have been developed to detect malicious activities in ICSs. Many of them focus on detecting manipulated PLC logic. State-of-the-art (SOTA) deep learning-based IDSs [4]â€“[6] gather sensor and actuator readings within ICSs to construct profiles for normal or anomalous data. However, these techniques are black-boxes where the reasoning behind the detection results is non-explainable, even for domain experts. In contrast, specification-based IDSs [7], are ex-plainable but rely on rules derived from expert knowledge. Crafting and maintaining these manual rules is labor-intensive, error-prone, and difficult. Recent advancements (e.g., [8]) include the design of automatic rule generators by parsing PLCsâ€™ code (which can thereby be used by an IDS); however, these codes are often proprietary in nature and inaccessible to third-party security vendors. Specifi-cally, based on our first-hand experiences with several state-owned ICS operators, their PLC code is classified as â€œCONFIDENTIALâ€ by regulation, so their policy strictly prohibits sharing the code outside their organizations, even to contracted security-vendors; moreover, some core PLC logic is the intellectual-property of solution-vendors and is not accessible even to the ICS operators themselves. Consequently, without access to the logical information of PLCs, these methods encounter significant challenges in effectively addressing complex attack detection problems in real-world ICS environments. On the other hand, ICS operators are usually open for contracted security-vendors to instrument their system in a non-invasive way, i.e. allowing security-vendors to passively gather input/output data of PLCs. Additionally, high-fidelity in-house testing facilities (running the same PLC logic as in the field) are usually provided for security-vendors to calibrate their solutions for pre-deployment testing. In this regard, there is a need for accurate attack detection that (1) doesnâ€™t rely on code availability from PLC vendors; (2) instead, leverages available system log and network trace; and (3) provides transparent and explainable detection decisions. In this work, we propose SRLR (Symbolic Regression based Logic Recovery) â€” a method designed to utilize PLCsâ€™ inputs (sensor readings) and outputs (actuator commands) to identify PLCsâ€™ key control logic and gen-                                       

> arXiv:2512.11298v1 [cs.LG] 12 Dec 2025 IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 2
> TABLE I Summary of comparisons with different methods. Logic recovery models Time domain Frequency domain Single-mode logic Multi-mode logic Single-mode logic Multi-mode logic NARMAX, NARX, FIR [9] âœ“Ã—âœ“Ã—
> Genetic Programming [10], [11] âœ“Ã—Ã—Ã—
> Cluster SR [12] âœ“âœ“Ã—Ã—
> SRLR (ours) âœ“âœ“âœ“âœ“
> Attack detection models Explainable Minimal prior knowledge Easy installation with human-understandable rules without knowledge of attack signatures without access to PLC code Specification based methods [1], [13] âœ“Ã—Ã—
> Machine Learning (ML) based methods [4], [5], [14], [15] Ã—âœ“âœ“
> CoToRu [8] âœ“âœ“Ã—
> SRLR (ours) âœ“âœ“âœ“

erate a series of rules for attack detection. The design of SRLR is feasible because: For many PLCs, the initiation of their control commands is contingent upon some key decision variables, whose values are determined by math-ematical equations of input sensor readings and governed by physical laws and control loop mechanisms. While there are complicated PLC logic (e.g., state-based logic or those with dozens of conditional branches) that do not offer succinct mathematical representation (hence, beyond the scope of our work), we believe that by recovering PLC logic that can be expressed as mathematically deterministic equations between PLC inputs and outputs, one can already cover a large subset of PLC control behaviors in many domains â€”- from power systems to other important industrial control systems, as we will validate through our experiments. This observation inspires us to employ Deep Symbolic Regression (DSR) [16] to infer the formulaic mappings, wherein PLCsâ€™ outputs are expressed as math-ematical functions of sensor readings. SRLR enhances the design of DSR based on the following ICS-unique properties: (1) For some important ICS domains, the control logic to be recovered often has specific patterns and expected level of complexity (e.g., including integral and differentiation components), and the simplest repre-sentation of such logic is not in the time domain, but in the frequency domain. One of our contributions in designing SRLR is to use such domain knowledge and map the original time-domain data into the complex-valued frequency domain, or known as s-domain, before recovering the control logic. (2) A PLC may be configured to operate in multiple modes, with each mode running different logic. The mode switches in ICS are not frequent. This observation inspires us to infer multi-mode logic using a continuity constraint to comprehensively profile the PLCsâ€™ control logic. (3) In ICSs, the sensor readings that are fed into PLCs often contain outliers or noise. To deal with that, a robust PLC usually has built-in logic to filter out such outliers. We also design an outlier-aware training algorithm for SRLR to prevent outlier data from driving the search in the wrong direction. (4) Lastly, we propose an effective regularization method to guide the search towards the appropriate complexity level. Thanks to the above enhancements, SRLR is able to recover the controller logic with higher accuracy compared to the DSR method. The derived formulas by SRLR can be leveraged to formulate invariant rules that describe the normal operational profile of PLCs. Deviation from these rules can then indicate in an explainable manner anomalous behavior observed in the PLCsâ€™ operation. We summarize the difference between SRLR and the main SOTA methods in Table I. Using the control logic recovered by SRLR, we generate a series of rules that accurately describe the normal operational profile of PLCs. Deviation from these rules can be used to detect PLC attacks. To show the effectiveness of SRLR in detecting controller logic attacks, we extensively evaluate SRLR using a variety of ICSs in different settings. We show that SRLR outperforms all the existing methods by up to 39% in terms of accuracy. For the Secure Water Treatment (SWaT) dataset [17], SRLR not only improves the attack detection accuracy on recent SOTA schemes, and it also makes the decision more explainable by mapping to the corresponding invariant that is being violated. II. Background and Threat Model A. Logic Recovery There are industrial processes that operate under a singular mode (or state) with static control logic. We define the recovery of such control logic as a single-mode logic recovery. Making it more challenging, PLCs in many ICSs encompass multi-mode logic, which carry out different logic based on state-transition conditions. We refer to the problem of profiling the switched control logics, i.e., recovering the control logic for each operating mode/configuration of the considered system as multi-mode logic recovery. We assume in each mode (be it single or multi-mode system), there is a succinct mathematical equation that governs the relationship between the output of a PLC and its inputs. One fundamental concept we use to recover logic is symbolic regression (SR). SR has been extensively studied in the field of discovering physical laws [18] aiming to derive mathematical formulas that accurately represent data generated by physical systems. Given a dataset 

(X, y ), where Xi âˆˆ Rn, y i âˆˆ R, the objective of SR is to identify the function f : Rn â†’ R, such that yi = f (Xi)

for each data point. In this work, we adopt the recent SOTA model, namely DSR [16], as the backbone framework for identifying con-trol logic. As illustrated in Figure 1, DSR operates within a reinforcement learning framework, where the Recurrent Neural Network (RNN) serves as the policy. The sym-bolic representations act as the state, while emitting the IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 3Â˜     

> 0.2 á¡¶
> ä™¦ã€¶ä™§ : y ã„ 0.2á¡¶
> &RQVWDQWRSWLPL]DWLRQ 6DPSOHG H[SUHVVLRQ
> 511 511
> Â˜cu
> 511
> Â˜cÂ˜
> %)*6
> á¡•âˆ—
> á¡•â¡¨
> á¡•â¡©
> 3ROLF\JHQHUDWRU
> á¡€HSLVRGHV
> ä™¦â¡©ä™§
> ä™¦â¡°ä™§
> . . .
> ä™¦ã€•ä™§
> á¡°ä™¦â¡©ä™§
> á¡°ä™¦â¡°ä™§
> . . . á¡°ä™¦ã€•ä™§
> 7UDLQLQJGDWD á ¶ä™¦â€–ä™§ â‰ á¦‡ ã‚™ä™°á¡„ä™¦ ä™§ä™±
> 2EMHFWLYHIXQFWLRQ
> 3ROLF\ *UDGLHQW
> Fig. 1. Framework of the DSR model. An RNN generates sample probabilities, which are used to construct an expression tree. The predictive errors of the generated expressions serve as a reward signal to further train the RNN, improving expression generation over time.

probabilities of each symbol within a library (e.g. {+, âˆ’,

etc. }) constitutes the action. During an episode, the sampled symbolic sequence can construct an expression tree, representing a mathematical expression Ï„ through a pre-order traversal. The risk-policy gradient is adopted in the objective function to promote the generation of optimal mathematical expressions as follows: 

Jrisk (Î¸) .

= EÏ„ âˆ¼p(Ï„ |Î¸)[R(Ï„ )|R(Ï„ ) â‰¥ RÎµ(Ï„ )] 

R(Ï„ ) = 1

> 1
> Ïƒy

âˆš 1

> T

âˆ‘Tt=1 (yt âˆ’ f (xt)) 2

(1) where R(Ï„ ) is the reward, RÎµ(Ï„ ) is the ( 1 âˆ’ Îµ)-quantile of the rewards, and Ïƒy is the standard deviation of the observations. Other key components of the DSR design include constant optimization, constraints for avoiding invalid formulas, etc. (c.f. [16] for further details). B. Threat Model PLCs control the physical processes in ICSs. A PLC con-tains control logic and firmware that drives its operation. Configuration and updates to the PLC code are performed via a workstation PC equipped with PLC management software like TwinCAT 3, using a dedicated interface. Similar to previous work on PLC security (e.g., [8]), we assume attackers can manipulate the PLCâ€™s control logic or modify its firmware to tamper with the PLCâ€™s output values. Remote attackers can gain access to a compromised workstation and use that to modify the control logic [19]. Other attack vectors, such as those at the firmware level, can be executed through direct hardware access, such as SD cards or the Joint Test Action Group (JTAG) interface [8], or through supply chain attacks. These advanced attacks can alter the output from PLCs in a more stealthy manner without leaving a visible trace on the PLC code. We assume that the sensor readings are not modified in this work. Various false data detection and sensor reading protection methods have been extensively studied [20], and SRLR can complement these methods by enhancing control logic protection. Hence, in our threat model, SRLR is used to detect deviation of PLCâ€™s behavior, regardless of whether such deviation arises due to changes in application logic or modification in underlying firmware, and regardless of whether deviation happens persistently or occasionally. III. SRLR: Symbolic Regression for PLC Logic Recovery & Attack Detection We will present the design of SRLR in this section. After a brief introduction of DSR, we will describe the key techniques we incorporate into SRLR to make DSR work more effectively for PLC logic recovery, and consequently generate explainable attack detection rules. A. Design 1: Using the Right Domain 1) Single-mode Logic Recovery: The DSR method can be readily applied for single-mode logic recovery through the collection of input and output data from dynamic systems. However, oftentimes, specifically in ICSs, the systemâ€™s time domain exhibits considerable complexity. As such, it becomes challenging for DSR to accurately generate the correct expressions, particularly for functions containing integral or derivative expressions. Considering the Linear Time-invariant System (LTI), which can be described as an ordinary differential equa-tion: Pâˆ‘

> p=1

ap

dp

dtp yt =

> Q

âˆ‘

> q=1

bq

dq

dtq xt (2) where ap and bq are constant coefficients, and P, Q 

represent derivative orders related to inputs and outputs, respectively. Time-domain systems often involve complex integral and derivative equations in ICSs, posing a challenge for DSR method to generate complex expressions. Never-theless, these integral and derivative formulations can be readily transformed into simpler expressions in the frequency domain or the s domain. Applying Laplace transform to both sides of Equation (2), results in the following expression: 

Y (s)

> P

âˆ‘

> p=1

apsp = X(s)

> Q

âˆ‘

> q=1

bq sq (3) where s = Ïƒ + iw is the complex s-domain parameter, 

Ïƒ, w are real constants. Thus, LTI can be expressed in a much simpler and clear fashion as the transfer function in 

s domain: 

H(s) = Y (s)

X(s) = b0 + b1s + ... + bQsQ

a0 + a1s + ... + aP sP (4) 2) Model Construction and Training: We adopt the DSR model as the foundation for directly inferring the systemâ€™s transfer function from observational data, with-out relying on expert knowledge. A schematic illustra-tion of the general framework for identifying control systems is depicted in Figure 2. The search library comprises not only basic mathematical symbols, such as {+, âˆ’, Ã—, Ã·, constant }, but also contains the complex IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 4Library           

> Ã—
> âˆ’+
> Ã·s
> cRNN
> Policy generator
> Constant
> optimizer
> Ã·
> +1
> 2s
> ð€ (ð€ ):H(s) = 1
> ð€ +2
> Expression tree
> System response
> ð€ (ð€ ) â‰ ð€ ð€ [ð€ (ð€ )]
> Objective function
> 2
> 1
> ð€ +
> âˆ’
> ð€ ð€
> ð€ ð€
> Training data
> (ð€ ð€ ,ð€ ð€ )
> Fig. 2. Framework for single-mode process identification in the s-domain using the DSR model. The generated expressions represent transfer functions, and system responses are simulated to calculate the reward.

parameter s. Unlike the logic recovery in the time domain, the input variables (e.g. x1, x 2) are not a part of the library. This is because our goal is to predict the actual expression of the transfer function in the s domain. In our approach, an RNN acts as the policy to se-quentially generate the predictive transfer function. To evaluate system behavior during training, we compute the corresponding time-domain system response. This involves two main steps. First, the transfer function is converted into a state-space representation using the controllable canonical form. Next, a numerical integration technique, such as the Euler method, is applied to produce the systemâ€™s output in the time domain. This entire computation process can be efficiently implemented using standard control libraries [21]. Subsequently, the prediction errors are utilized to cal-culate the rewards, we get: 

R(Ï„ ) = 1

> 1
> Ïƒy

âˆš 1

> T

âˆ‘Tt=1 (yt âˆ’ Ë†f (xt)) 2 (5) where yt, Ë†f (xt) are the ground truth and prediction outputs respectively. SRLR can operate in either the time domain or the s domain. The choice between these domains can be guided by slight domain knowledge about the systemâ€™s behavior. In the time domain, it models the systemâ€™s dynamics directly, while in the s domain, it generates the corresponding transfer function. Despite these differences, both approaches use the same data representation: time-domain input data are fed into the simulated system to produce time-domain outputs. The prediction error between the simulated and actual outputs is then used to compute a reward signal, which guides model training through a risk-aware policy gradient method. B. Design 2: Use of Continuity Constraint 1) Multi-mode Logic Recovery:: In this section, we in-troduce the details of multi-mode logic recovery. Consider a controller comprised of K modes. For example, the notation st = k indicates that the mode k is operational in the time step t. We can describe the dynamics of the 

k-th mode through the equation yt = fk(xt, s t = k; Î¶k),and the multi-mode control logic can be formulated as follows: 

yt = f (xt, s t; Î¶) = 

ï£±ï£´ï£´ï£²ï£´ï£´ï£³

f1(xt, s t = 1; Î¶1), (xt, y t) âˆˆ D 1

f2(xt, s t = 2; Î¶2), (xt, y t) âˆˆ D 2

... fK (xt, s t = K; Î¶K ), (xt, y t) âˆˆ D K

(6) where the function f (Î¶) represents the equation governing the mode and Î¶ is the parameters, and the dynamics f (Î¶)

can be linear or nonlinear. Dk = {(xt, y t)|st = k} denotes the input/output set of the k-th mode. The mode equation fk(xt, s t = k; Î¶k) and the mode dataset Dk are not accessible apriori. To correctly deter-mine the logic of such a multi-mode system, we need to identify the equation f (Î¶k) of each mode, the sub-dataset 

Dk of each mode, and the total number K of modes. The multi-mode process identification problem can be formulated as two optimization tasks. The first task involves (correctly) partitioning the dataset into sub-datasets corresponding to each operating mode, while the second employs DSR on that sub-dataset to identify the accurate equation governing that mode. However, solving the joint optimization problem presents a non-trivial challenge. We introduce a binary vector Î³k âˆˆ RT

as the membership value, where the membership Î³k,t 

indicates whether the input-output pair (xt, y t) belongs to k-th mode. If true, Î³k,t = 1 ; otherwise, Î³k,t = 0 . The joint objective function is formulated as follows: 

min 

> Î³,Î¶ T

âˆ‘

> t=1
> K

âˆ‘

> k=1

Î³k,t l(yt, Ë†yt; Î¶k) + Ï•L (Ë† yt) + g(Î³k,t ; Î»)

s.t. (xt, y t)âˆˆ D 

Î³kâˆˆ { 0, 1}|D| 

Ë†yt= fk(xt, s = k; Î¶k)

(7) where Ë†yt represents the predicted output at time step t.

D = â‹ƒKk=1 Dk and |D| is the total number of input-output pairs. The first term l(yt, Ë†yt; Î¶k) is the prediction error for the equation of k-th mode (e.g. square error). The second term L(Ë† yt) is the regularization for the prediction model with hyperparameter Ï•. The third term g(Î³k,t ; Î»)

is the regularization assigning the input-output pairs to a specific mode in training. This is a general framework that can be utilized for multi-mode process identification tasks by specifying a regressor to predict systemâ€™s output and defining a regu-larizer for partitioning the sub-dataset. We employ DSR as the regressor, and choose a hard regularizer that is widely adopted in previous studies [22]. The regularizer is formulated as g(Î³; Î») = âˆ’Î»Î³ .We employ the Alternative Optimization Strategy (AOS) [22] to address the mixed-integer programming problem. AOS is an alternatively iterative method where we first fix the Î³ value and update the regressor model. Then, we fix the regressor parameters and update the Î³IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 52XWSXW 7LPH   

> 7LPH
> '65 (TXDWLRQ
> 0HPEHUVKLS
> '65 (TXDWLRQ
> $26
> 0HPEHUVKLS
> 0HPEHUVKLS
> (TXDWLRQ
> 0HPEHUVKLS
> (TXDWLRQ
> 5HPRYH PDUNHG GDWD
> 5HSHDW XQWLO DOO GDWD DUH PDUNHG
> 2XWSXW
> $26 0RGH 0RGH
> Fig. 3. Example of multi-mode logic recovery. The DSR model is iteratively optimized alongside a binary variable. Identified mode points are progressively removed, and the process continues until all points are assigned to a mode.

value. The objective function for optimizing the regularizer is as follows: 

min 

> Î³T

âˆ‘

> t=1
> K

âˆ‘

> k=1

Î³k,t lk,t âˆ’ Î»Î³ k,t 

s.t. Î³kâˆˆ { 0, 1}|D| 

(8) where lk,t is the abbreviation of l(yt, Ë†yt) for convenience. When the regressor parameters are fixed, the loss of prediction is a scalar. Thus, the optimal Î³k,t can be obtained as follows: 

Î³âˆ—

> k,t

(Î», l k,t ) = 

{0 if lk,t â‰¤ Î»

1 if lk,t > Î» (9) 2) Refined Optimization Approach: If the prediction loss lk,t is less than the pre-defined threshold Î», then the input-output pair (xt, y t) is assigned to mode k

(Î³k,t = 1 ). Conversely, if the loss surpasses the threshold, it indicates that (xt, y t) is not generated by k-th mode (Î³k,t = 0). Given that fewer points in a multi-mode process provide limited information about the subsystem, we make the following basic hypothesis for constructing the identification method. This hypothesis holds for most ICS as mode switches are often non-transient in nature. Assumption 1: At least w input-output pairs are gen-erated during each mode activation (i.e., a mode switch can only occur after w time slots), where w is some small constant. Considering that the data generation process in dynamic systems follows a temporal sequence, we leverage this smooth information and incorporate a regularization term to prompt the algorithm to commence the identification process with a greater relaxation for the first w data points, i.e., a higher value of Î». When we are identifying the k-th mode, the objective function can be expressed as follows: 

min 

> Î³k
> T

âˆ‘

> t=1

Î³k,t lk,t âˆ’

> w

âˆ‘

> t=1

Î»1Î³k,t âˆ’

> T

âˆ‘

> t=w+1

Î»2Î³k,t 

s.t. Î³kâˆˆ { 0, 1}|D| 

(10) where Î»1 is a larger threshold that relaxes the condition for the initial points to be divided to mode k, and Î»2

is a smaller value that limits the predictions with minor errors. In our experiments, the parameters Î»1 and Î»2 are empirically set to 1 and 0.001, respectively. When the 

Î³k is fixed, we proceed to train the DSR model using the selected training data specified by Î³k. The objective function is defined as follows: 

min 

> Î¶k
> T

âˆ‘

> t=1

Î³k,t l(yt, Ë†yt; Î¶k) + Ï•L (Ë† yt)

s.t. (xt, y t)âˆˆ D 

Ë†yt= fk(xt, s = k; Î¶k)

(11) We can employ risk policy gradient to optimize the DSR problem, and the gradient is computed as follows when identifying mode k:

âˆ‡Î¸ Jrisk (Î¶k; Îµ) â‰ˆ 1

ÎµT 

> T

âˆ‘

> t=1

IÂ·[R(Ï„ (t))âˆ’ ËœRÎµ(Î¶k)] âˆ‡Î¶k log p(Ï„ (t)|Î¶k)

(12) where ËœRÎµ(Î¶k) is the (1 âˆ’ Îµ) quantile of the rewards in a training batch. I is an indicator variable, where if 

R(Ï„ (t)) â‰¥ ËœRÎµ(Î¶k), then I = 1 ; otherwise, I = 0 .As shown in Figure 3, the proposed method iteratively identifies each mode and removes the index once the sub-dataset is successfully partitioned. C. Design 3: Outlier-aware Training While DSR is optimized in the previous section to handle the right domain and multiple modes for controller logic recovery, it may still be susceptible to outliers in the training data. These outliers can arise from envi-ronmental interference, noise during data collection, or internal system vibrations. Such sensitivity can result in DSR generating overly complex expressions, leading to overfitting or even failure to recover control logic. To mitigate this issue, we proposed a data dropout approach to address potential outliers. Rewards are calculated upon the generation of an expression by DSR, and these rewards are then utilized in the risk-seeking policy gradient mechanism to update the parameters of DSR. Throughout this process, all training data, including outliers, contribute to the reward calculation. Typically, the evolutionary models attempt to initially fit easier data in the early iterations and then tackle more challenging data (such as outliers) in subsequent iterations. Consequently, the normal data are likely to be fitted by generated candidate expressions, resulting in higher rewards for these data points and lower rewards for outliers. Drawing from this observation, we implement a data dropout approach where we remove the data representing the lowest Î± percent in terms of reward for a chosen constant Î±, as these are deemed more likely to be outliers. D. Design 4: Complexity Regularization In general, high-order systems featuring a more complex transfer function can emulate the response of lower-order systems when provided with input data. Consequently, it is essential to impose additional constraints on DSR to ensure the generation of expressions with suitable complexity levels. IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 6                         

> TABLE II The measurement of symbol complexity. Complexity 1234Symbol +,âˆ’,Ã—,Ã·sin ,cos log ,exp
> constant,variable $FWXDWRU 6HQVRU
> 3/&
> $WWDFNV
> 3K\VLFDO 3ODQW
> 65/5 /RJLF5HFRYHU\ 5XOHV*HQHUDWRU $WWDFN$ODUP
> &RQWUROOHU $WWDFN 'HWHFWLRQ
> 0DOLFLRXV&RQWUROOHU2XWSXW,QMHFWLRQ
> &RQWUROOHU&RQILJXUDWLRQ7DPSHULQJ
> &RQWUROOHU'LVDEOLQJ$WWDFN
> 
> Fig. 4. Attack detection framework based on SRLR. The model learns normal PLC logic from sensor and actuator data, then generates rules to monitor and ensure PLC security.

We quantify complexity based on the number of math-ematical symbols [16]. Specifically, the symbols [Ã·, Ã—]

exhibit higher complexity compared to [+ , âˆ’] as detailed in Table II, and the complexities are summed as the final complexity of the expression. We utilize the Akaike Information Criterion (AIC) [23] as a regularization term to encourage our model to generate less complex expres-sions. AIC is an indicator of predictive error derived from information theory, serving as a criterion for model selec-tion in regression and balancing precision with simplicity. Its formulation is as follows: 

AIC = (2 m âˆ’ ln ( Ë†L)) /n (13) where m is the number of model parameters, Ë†L is the predictive likelihood and n is the total number of data. The preferred candidate model typically exhibits a lower AIC score, indicating either a lower complexity or ahigher likelihood. Assuming the error residuals follow an independent identical normal distribution, the maximum value of a modelâ€™s log-likelihood can be formulated by the residual. As our calculation of the complexity of generated expressions is based on the number of symbols, the complexity term tends to be small. To enhance the impact of expression complexity, we introduce an additional complexity term into the AIC formula. The final modified AIC is calculated as follows: 

ln ( Ë†L) = âˆ’ n

2 Â· ln (2 Ï€) âˆ’ n

2 Â· ln 

( sse n

)

âˆ’ n

2

AIC = (2 m âˆ’ ln ( Ë†L)) /n + m

(14) where sse is the residual error. The negative AIC is a regularization term within the reward function that encourages the model to generate expressions that strike a balance between complexity and precision. E. Using SRLR for Attack Detection We now present how our proposed SRLR can be applied to detect different attacks in ICSs. The overall framework is depicted in Figure 4, where the ICSs comprise both the physical process and the controller module. Sensors measure the states of the physical system, such as water level, flow rate, etc., and these measurements are fed into PLCs, which analyze the system states and emit control commands to actuators. The actuators then execute these commands to control the physical system. However, PLCs are susceptible to vulnerabilities and may be targeted by attackers, leading to the transmission of incorrect or even harmful commands. Notice that, once we have correctly identified the normal system process (in either single-mode or multi-mode), we can leverage that to check the behavior of the system. If there is a deviation from the expected behavior, the system can be considered as behaving anomalously and â€œunder-attackâ€. These predictions are compared with the actual output from the actuators, with anomaly score calculated as: 

et = 1

T

> T

âˆ‘

> t=1

|yt âˆ’ Ë†yt| (15) where yt represents the observed PLCs output and Ë†yt

denotes the prediction of the identified system. The output commands may exhibit some fluctuations, especially at the state-switching time points (during change in the operating mode), resulting in spikes in the anomaly scores. To prevent these points from being erroneously classified as an attack, we employ the Expo-nentially Weighted Moving Average (EWMA) smoothing algorithm to smooth the anomaly scores. Points are only flagged as attacks when the smoothed anomaly score exceeds a predefined threshold determined through a non-parametric threshold [24]. The SRLR model can be integrated into monitoring systems within ICSs to deliver accurate numerical results that support timely and efficient alarms. In addition to its predictive capabilities, SRLR generates human-understandable rules, enabling operators to trace potential threats by analyzing these rules. Furthermore, it identifies compromised variables based on the generated rules, which is the critical information that helps security teams investigate and determine the root cause of incidents. IV. Experiments on Logic Recovery In this section, we conduct experiments to validate the performance of SRLR in terms of correctly identifying the operating mode of an ICS system. A. Metrics We evaluate the correctness of the recovered logic from two key perspectives: fidelity and explainability. Fidelity refers to how accurately the recovered logic reproduces the true behavior of the system. To quantify IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 7

TABLE III The recovery results of SRLR for the EWMA equation. Ground truth: y(t) = 0 .8x(t) + 0 .16 x(t âˆ’ 1) + 0 .032 x(t âˆ’ 2) .Dataset AIC Outlier-aware Identified mode Complexity BFR Raw data                                                                                               

> Ã—Ã—y(t) = 0 .2307 x(tâˆ’1) + x(t)/(0 .2585 x(tâˆ’1) /(x(tâˆ’1) + x(tâˆ’2)) + 1 .1842) 19 0.9966
> Ã—âœ“y(t) = 0 .9064 x(tâˆ’2) x(t)/(0 .873 x(tâˆ’2) âˆ’0.1269 x(tâˆ’1) + 0 .1673 x(t) + 0 .1178) 22 0.9963
> âœ“Ã—y(t) = 0 .7958 x(t) + 0 .1653 x(tâˆ’1) + 0 .0308 x(tâˆ’2) 15 0.9959
> âœ“âœ“y(t) = 0 .7917 x(t) + 0 .1706 x(tâˆ’1) + 0 .0296 x(tâˆ’2) 17 0.9957 Contanimated data
> Ã—Ã—y(t) = 0 .0029 x(tâˆ’1)( x(tâˆ’2)( âˆ’x(tâˆ’2) + x(t) + 641 .6587) âˆ’303 .4484 x(tâˆ’2) + x(t)âˆ’8.2933) /x (tâˆ’2) 29 0.8293
> Ã—âœ“y(t) = 0 .7999 x(t) + 0 .2x(tâˆ’1)(0 .0005 x(tâˆ’2) âˆ’0.0005 x(tâˆ’1) + 0 .96) âˆ’0.0007 24 0.9959
> âœ“Ã—y(t) = 0 .9919 x(t)âˆ’0.2275 x(tâˆ’1) + 0 .2275 x(tâˆ’2) 10 0.9897
> âœ“âœ“y(t) = 0 .7985 x(t) + 0 .1628 x(tâˆ’1) + 0 .0305 x(tâˆ’2) 15 0.9945

TABLE IV The identification results of SRLR and baselines in multi-mode logic recovery. (noise level Np = 0 .02 )Dataset Mode The ground truth mode SRLR Cluster SR Cluster DSR Hysteresis Relay 1 y = 1 y = 1 y = 1 y = 1                                                                                                                                                      

> 2y=âˆ’1y=âˆ’1y=âˆ’1y=âˆ’1
> Continuous Hysteresis 1y= 0 .5x2+xâˆ’0.5y= 0 .4988 x2+ 0 .9993 xâˆ’0.4994 y= 0 .013 + xy= 0 .4988 x2+ 0 .9993 xâˆ’0.4994
> 2y=âˆ’0.5x2+x+ 0 .5y=âˆ’0.4987 x2+ 0 .9998 x+ 0 .4996 y=xy=âˆ’0.4987 x2+ 0 .9997 x+ 0 .4995
> Phototaxic Robot 1y=x2âˆ’x1y=x2âˆ’x1y=x2âˆ’x1y=x2âˆ’1.0009 x1
> 2y= 1 /(x1âˆ’x2)y= 0 .9647 /(1 .0332 x1âˆ’1.0332 x2)y= 0 .969 /(x1âˆ’x2)y= 0 .083 x1âˆ’0.083 x2âˆ’0.0873
> 3y= 0 y= 0 y=âˆ’0.005 y= 0
> Non-linear System 1y=x1x2y=x1x2y=x1x2y= 1 .0827 x1x2âˆ’0.4131 x1
> 2y= 6 x1/(6 + x2)y= 5 .9206 x1/(5 .9153 + x2)y=x1x2âˆ’(x1âˆ’5.169) x1/(âˆ’6.699) y= 0 .4774 x21+ 0 .4774 x1x2
> 3y= ( x1+x2)/(x1âˆ’x2)y= ( x1+x2)/(x1âˆ’x2)y= ( x1+x2)/(x1âˆ’x2)y= 1 .2327 x1x2âˆ’1.2797 x1

this, we use the Best Fit Ratio (BFR) as defined in [25]. The BFR is calculated as follows: BFR = max {0, 1 âˆ’ âˆ¥y âˆ’ Ë†yâˆ¥2

âˆ¥y âˆ’ Â¯yâˆ¥2

} (16) where y = [y(1) , ..., y (T )] , Ë†y = [Ë† y(1) , ..., Ë†y(T )] are the ground truth and predicted system outputs, respectively. The BFR ranges from 0 to 100%, with higher values indicating closer alignment with the true system dynamics. This metric also serves as an indicator of model precision: if the recovered logic consistently achieves high BFR scores across test data, it suggests strong generalization and reliable predictive accuracy. Explainability evaluates how easily a human can in-terpret the recovered expressions and understand the relationships among variables. First, we assess the overall symbolic complexity of each mode identified by SRLR, as shown in Table II. This complexity measure considers both the number and diversity of symbols used. Lower com-plexity generally implies greater explainability. Second, we examine symbolic equivalence, i.e. whether the recovered expression matches the known system dynamics. When the true dynamics are available, we can use intuitive visual inspection or formal tools such as SymPy 1 to determine equivalence. This focus on explainability is a key advantage of SRLR. Unlike many machine learning-based approaches that yield only black-box numerical predictions, SRLR produces explicit symbolic expressions that not only ap-proximate system behavior but also provide insight into the underlying control logic and variable relationships. B. Single-mode Logic Recovery For the first evaluation, we tasked SRLR to recover the EWMA equations in the time domain. EWMA is a popular 

> 1

docs.sympy.org 

and prevalent method employed on PLCs to preprocess data for smoothing in ICSs [26]. EWMA smooths time series data through an exponential window, expressed as follows: 

y(t) = Î±x (t) + (1 âˆ’ Î±)y(t âˆ’ 1) 

â‰ˆ Î±x (t) + Î±(1 âˆ’ Î±)x(t âˆ’ 1) + Î±(1 âˆ’ Î±)2x(t âˆ’ 2) 

(17) where Î± is the smoothing factor, x(t) is the input data at t-th time step and y(t) is the output after EWMA process. Notice from the definition of EWMA â€“ earlier inputs have progressively less influence on the output than recent ones. For our experiments, we truncate the input with a finite window size 2 and set the Î± to 0.8 to keep the resulting equation simple. However, our method also works when considering a larger number of inputs. Additionally, to simulate a contamination situation, we randomly introduce outliers to the raw data points as: 

Ëœx(t) = Â¯x Â· Ïµ + x(t), where Â¯x is the local mean, and 

Ïµ âˆ¼ N (âˆ’0.1, 0.1) .The dataset utilized in this study is sourced from the real-world SWaT testbed [17]. The identification results are presented in Table III, revealing that the model can generate expressions with high BFR when outliers are not injected. However, without AIC regularization, the model tends to generate complex expressions that deviate significantly from the ground truth. The AIC regulariza-tion helps constrain the model to generate the correct expression with a lower complexity. In contaminated data, i.e., data with injected outliers AIC regularization alone results in incorrect expressions. However, when equipped with both the AIC regularization and outlier-aware method, the model can generate correct expressions with lower complexity and a high BFR. Experimental results confirm the effectiveness of our proposed AIC regularization and outlier-aware method, especially in IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 8             

> (a) Continuous Hysteresis (b) Nonlinear System
> Fig. 5. Comparison of mode identification results between Cluster SR and the proposed SRLR method. The first row shows simulated data from both methods alongside ground truth. Subsequent rows present the identified mode indices for each method. 0.5 0.6 0.7 0.8 0.9 1
> Best Fit Ratio Hysteresis Relay
> 0.5 0.6 0.7 0.8 0.9 1
> Continuous Hysteresis
> SRLR(Ours) Cluster SR Cluster DSR LSTM CascadedNN Cluster PySR Cluster Operon
> 00.02 0.04 0.06 0.08 0.1
> Noise Level
> 0.4 0.6 0.8 1
> Best Fit Ratio Phototaxic Robot
> 00.02 0.04 0.06 0.08 0.1
> Noise Level
> 0.7 0.8 0.9 1
> Nonlinear System
> Fig. 6. The comparative BFR across different noise levels.

cases where the training data contains outliers. C. Multi-mode Logic Recovery Building upon the findings from single-mode logic recov-ery, we evaluate the performance of SRLR on identifying hybrid ICS systems having multiple operating modes. Dataset. We consider four classic hybrid dynamic systems as in [12]. These hybrid dynamic systems include hysteresis relay, continuous hysteresis loop, phototaxic robot, and nonlinear system. The hysteresis relay and continuous hysteresis loop represent discrete and continuous switch systems, respectively. The phototaxic robot system com-prises three modes to track the movement of a light-interacting robot. The nonlinear system comprises three modes with nonlinear equations. For further datasets details, please refer to [12]. We also evaluate the efficacy of SRLR across varying levels of noise in the data, comparing its performance against several baseline models. To this end, we consider an addition of zero-mean Gaussian noise to the input data, with noise levels ranging from 0% to 10% [12]. The noise level is proportional to the standard deviation of the raw data, denoted as Np = Ïƒnoise /Ïƒ y , where Ïƒnoise represents the standard deviation of the noisy data and Ïƒy is the standard deviation of the noiseless data. We use the noisy data as the training set and the noiseless data as the testing set following the evaluation in [12] to ensure a fair comparison. Baselines. We evaluate the performance of SRLR against six baseline methods. The first, Cluster SR [12], is a symbolic regression technique that combines Generic Programming (GP) with the expectation-maximization algorithm for clustering and membership estimation. To benchmark SRLR against SOTA symbolic regression tools, we also create three variants: Cluster DSR, Cluster PySR, and Cluster Operon. These versions replace the GP component in Cluster SR with more advanced symbolic regression algorithms, such as DSR, PySR [27], and Operon [28], respectively. For broader comparison, we also include two black-box deep learning models: Long Short-term Memory Network (LSTM) and a Deep Cascaded Neural Network (CascadedNN) [9]. Comparison results. As shown in Figure 6, SRLR con-sistently outperforms all baseline methods in terms of average BFR. The black-box models, LSTM and Cascad-edNN, demonstrate competitive results on the discrete and continuous hysteresis datasets, where their performance closely matches SRLR. However, their effectiveness de-clines on more complex tasks, such as modeling nonlinear systems. In contrast, SRLR not only maintains high pre-dictive accuracy but also provides interpretable equations that reveal the underlying system dynamics. The performance of the cluster-based symbolic regres-sion models varies across datasets. For example, Cluster SR achieves better results on the phototaxic robot dataset but struggles with the continuous hysteresis system, lead-ing to a significantly lower BFR, as shown in Table IV. This inconsistency can be attributed to the shared mem-bership estimation method across all cluster-based models, which fails to account for the temporal continuity present in system-generated data. As a result, these models underperform compared to SRLR, particularly on tasks that require capturing complex or sequential patterns. Furthermore, we conducted a comparative analysis of the mode indexes identified by SRLR (ours) and Cluster SR. Both approaches are trained using noisy data, and the resulting index identification results are illustrated in Figure 5. A key difference we observe is that Cluster SR does not account for the temporal dynamics of systems and therefore overlooks the local continuity of the point distribution within each mode. As shown in Figure 5, Cluster SR yields a sparse IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 9                       

> TABLE V The parameters and results of the distribution grid. System Gain Time Constant Total Number Average BFR Amplifier (10, 400) (0.02, 0.1) 79 0.9999 Exciter (0.7, 1) (0.02, 1) 79 0.9999 Generator (0.7, 1) (1, 2) 79 0.9999 Sensor (0.7, 1) (0.01, 0.06) 79 0.9999 Controller Automatically tuned 79 0.9969

membership distribution in the continuous hysteresis system, despite most values being correct. In the case of the nonlinear system, Cluster SR even misclassifies the membership due to the presence of noisy training data. In contrast, as SRLR leverages temporal information and employs a larger Î»1 (see Equation 10), along with an effective fine-tuning mechanism, it helps the correct identification of the initial points of each mode, providing the algorithm with essential prior information to guide its decisions. This leads to the correct identification of initial segments, and inference of the correct mathematical structure which results in overall better performance. D. Logic Recovery in Distribution Grid Next we evaluate SRLR on a distribution grid with hundreds of voltage regulators are deployed and updated independently to stabilize the local voltages delivered to users. To simulate this distributed network, we randomly generated the gains and time constants for each subsystem within the normal range, as referenced in the litera-ture [29]. The corresponding parameters of Proportional-Integral-Derivative (PID) controllers were automatically tuned using MATLAB PID Tuner App. As illustrated in Table V, we simulate 40 distributed voltage regulator systems, each consisting of four phys-ical subsystems and one PID controller. The recovery performance of SRLR in physical subsystems (amplifier, exciter, generator, and sensor) achieved an average BFR 0.9999, demonstrating SRLRâ€™s stability under diverse con-ditions. Additionally, the average BFR for the controllers was 0.9969, indicating SRLRâ€™s effectiveness in identifying complex logic (e.g. second-order mathematical expression in PID controllers) with a high degree of accuracy. In total, 395 subsystems were identified across 79 distributed systems, and the high success rate highlights SRLRâ€™s robustness and suitability for deployment in large-scale, distributed real-world systems. V. Experiments on Attack Detection In this section, we evaluate the performance of SRLR to detect controller logic attacks in different ICS en-vironments, including a power grid frequency control system [30] and the SWaT testbed [17]. A. Metrics and Baselines Metrics. We evaluate detection performance using widely-used metrics: F1 score, precision, and recall. Following established practice in prior work, we enumerate all pos-sible threshold values and report the highest achieved F1 score, denoted as F1, Precision, and Recall. Additionally, we adopt the adjust-point evaluation strategy [4], [15], [31], which considers an entire attack segment correctly detected if at least one alarm is triggered within its dura-tion. Metrics calculated using this approach are reported as F1 âˆ—, Presion âˆ—, and Recall âˆ—. The average performance metrics along with their standard deviations are reported. Baselines. We compare SRLR against several neural System Identification (SI) methods, including RNN [9], CascadedNN [9], and NSIBF [4] along with its variants NSIBF-RECON and NSIBF-PRED. RNN and Cascad-edNN directly predict system outputs using neural net-works. NSIBF constructs a state-space model via neural networks and updates system states through Bayesian filtering. It detects anomalies based on a combination of reconstruction and prediction errors. In addition to these neural SI methods, we also evaluate SRLR against deep learning-based anomaly detection models. These include the encoder-decoder architecture EncDec-AD [32], the density-based approach DAGMM [33], the adversarially trained method USAD [15], and the probabilistic modeling framework OmniAnomaly [31]. B. Power Grid Frequency Control System System Description. We simulated a power grid Load Frequency Control (LFC) system as the first ICS case study. The system parameters are aligned with prior research simulating a power system of Great Britain [30]. As depicted in Figure 7, the controller is modeled using an integral-separated PID controller. The integral component of the PID is crucial for eliminating static errors; however, in instances where the input errors are substantial, the integral controller accumulates these errors, potentially driving the systemâ€™s actuators into a state of saturation â€“ a phenomenon extensively studied and referred to as controller windup in the literature [34]â€“[36]. Integral-separated PID control is an effective strategy to circum-vent windup; it operates by switching the controller to Proportional-Derivative (PD) mode when the controllerâ€™s input errors exceed a predefined threshold, and reverting to PID mode when inputs fall below this threshold. The training dataset consists of 180,000 simulated points, while the testing dataset includes 182,500 points, with a 39.6% anomaly rate generated through various attack scenarios described in the attack model section. Attack Model. We launch three types of attacks on the LFC system, aimed at disturbing the frequency deviation and potentially causing the frequency control to fail. The first attack is Malicious Controller Output Injection Attack. Similar to previous methods of injecting malicious data [37], we assume these attacks occur randomly, gov-erned by a nonlinear function, formulated as follows: 

Â¯y(t) = Î²(t)g(y(t)) + (1 âˆ’ Î²(t)) y(t)

g(y) = âˆ’tanh (Gy ) (18) IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 10 0          

> *DLQ 1
> 0.2á¡± ãŽ— 1
> *RYHUQRU
> âˆ†á¡‚ ã€”
> ãŽ˜ãŽ—
> /RDG
> âˆ†á¡˜
> 11
> 'URRS 1.35 (9
> ãŽ˜
> ãŽ—ãŽ˜
> 3' &RQWUROOHU
> ,QWHJUDO &RQWUROOHU
> 6ZLWFK
> ãŽ—
> *HQHUDWRU 7XUELQH
> 2á¡± ãŽ— 1
> 12á¡± ãŽ— 1
> 1
> 0.3á¡± ãŽ— 1
> 1
> 6.84á¡± ãŽ— 1
> Fig. 7. Framework of the simulated LFC system. The system uses an integral-separated PID controller, with logic that switches based on feedback signals. TABLE VI The controller identification results. Mode Ground truth Prediction Controller-1 3.3s+2 .1
> s+1 3.874 s+2 .599 1.182 s+1 .231
> Controller-2 3.3s2+2 .7s+0 .6
> s2+s
> 3.027 s2+2 .099 s+0 .4469
> s2+0 .6936 s
> Switch threshold 0.10.0979

Here, G represents the constant for the upper bound, and 

Î² âˆˆ { 0, 1} is a Bernoulli variable with an expectation ranging from [0 , 0.3] . g(y) generates the malicious data with the restriction âˆ¥ g(y) âˆ¥2â‰¤âˆ¥ Gy âˆ¥2.The second attack is the Controller Configuration Tam-pering Attack, where the parameters of the PID controller are altered based on a random variable: 

KP = KP + Î¾1, KI = KI + Î¾2, KD = KD + Î¾3

KP â‰¥ 0, KI â‰¥ 0, KD â‰¥ 0 (19) where Î¾1, Î¾ 2, Î¾ 3 follow a Gaussian distribution N (0 , 1) .

KP , KI , and KD represent the proportional, integral, and derivative parameters of a PID controller, respec-tively. The third attack is Controller Disabling Attack. Specif-ically, KP = 0 , KI = 0 , KD = 0 . While this attack shares similarities with tampering with the PID configurations, it differs in that the systemâ€™s PID configuration returns to normal after a short period. This attack can be formulated as follows: PID config = normal , t âˆˆ [0 , T of f )

PID config = attack , t âˆˆ [Tof f , T ], (20) where the controller outputs are divided into N periods, and each period lasts for T time slots. Tof f is the starting time step for attacks in one period. Attack Detection. We utilize the SRLR in multi-mode logic recovery setting to identify the switched controller logic (i.e., logic switch from PD control to PID control) utilizing just the controller inputs and outputs as training data. Subsequently, we apply the identified controllersâ€™ logic to the dataset and compute the errors, determining the time points where a mode switch occurs. Employing the Mahalanobis distance-based filtering method [38], we then utilize the DSR model to determine the logic switch threshold. The training process requires 5.7 hours. The results presented in Table VI, demonstrate the accurate recovery of the switched controller logic and the corre-sponding switch results. The results are presented in Table VII. It is evident from the table that our model consistently outperforms the baselines across all three types of attack detection sce-narios. This superiority can be attributed to the accuracy with which our model recovers the switched controllersâ€™ logic and the associated switch conditions. Notably, the CascadedNN exhibits the second-best performance owing to its fully connected characteristics. SI based methods, including our proposed model, RNN, CascadedNN and NSIBF, demonstrate superior performance compared to autoencoder-based approaches and generative approaches. In the case of malicious controller output injection, our model effectively detects nearly all instances of malicious data. This success stems from the modelâ€™s ability to accurately identify between malicious and nor-mal data. Conversely, autoencoder methods struggle to distinguish between normal and malicious data, as they primarily focus on capturing the distribution of training and testing data without explicitly considering controller logic. When the controller configuration is tampered with, particularly if the tampered configuration closely resembles the normal configuration, the performance of our model, RNN, and CascadedNN experiences a slight decrease. However, EncDec-AD and DAGMM methods exhibit improved performance in this scenario, as the tampered configuration persists for an extended period, leading to a continuous presence of attacked points. In contrast, the controller disabling attack poses a stealthier threat, as it only lasts for a brief duration and may go undetected by system identification-based methods. More-over, the relatively fewer attacked points in comparison to controller configuration tampering also contribute to decreased performance for NSIBF, EncDec-AD, DAGMM and USAD. OmniAnomaly demonstrates relatively stable performance across three types of attacks, due to its ability to model the dynamic characteristics of time series data. Additionally, the point-adjusted metrics yield higher values compared to standard metrics, as they evaluate continuous attack segments as single anomaly events. This approach increases the likelihood of detection, particularly in cases such as controller configuration tampering, where identifying any point within the segment is sufficient to flag the entire attack. In summary, leveraging the identified switch controllersâ€™ logic and associated switch conditions enables accurate simulation of system behavior, facilitating efficient detection of attacks. C. Secure Water Treatment Testbed The SWaT platform, developed by iTrust SUTD [17], represents a scaled-down emulation of real-world water treatment systems with six-stage processes. In the first 7 days, the SWaT system operated under normal conditions, followed by four days of operation under attack conditions. The dataset, collected from 51 sensors and actuators, comprises 495,000 training samples and 449,919 testing samples, with approximately 12.14% of the testing set containing attacked points. These attacks were initiated IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 11 

TABLE VII The comparison of attack detection in the load frequency control system. Model F1 Precision Recall F1 âˆ— Precision âˆ— Recall âˆ—                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

> Malicious Controller Output Injection CascadedNN 0.9916 Â±0.0126 0.9937 Â±0.011 0.9896 Â±0.0166 0.9939 Â±0.0096 1.0Â±0.00.988 Â±0.0189
> RNN 0.9795 Â±0.0315 0.9901 Â±0.0222 0.9700 Â±0.0463 0.9822 Â±0.0273 0.9927 Â±0.0192 0.9723 Â±0.0381
> EncDec-AD 0.3357 Â±0.1028 0.2262 Â±0.0706 0.6690 Â±0.1966 0.3543 Â±0.0973 0.2430 Â±0.0735 0.6749 Â±0.1526
> DAGMM 0.2732 Â±0.1333 0.1646 Â±0.0889 1.0Â±0.00.2826 Â±0.0152 0.1646 Â±0.1054 1.0Â±0.0
> USAD 0.8521 Â±0.1802 0.7772 Â±0.2359 0.9991 Â±0.0003 0.8943 Â±0.1169 0.8323 Â±0.1768 0.9915 Â±0.0159
> OmniAnomaly 0.8121 Â±0.1011 0.6964 Â±0.1595 0.9963 Â±0.0063 0.9874 Â±0.0213 0.9961 Â±0.0094 0.9797 Â±0.0416
> NSIBF 0.8727 Â±0.0929 0.8683 Â±0.1776 0.8862 Â±0.0037 0.9391 Â±0.0860 0.9107 Â±0.1262 0.9717 Â±0.0398
> NSIBF-RECON 0.9245 Â±0.1009 0.8695 Â±0.1768 0.9981 Â±0.0012 0.9318 Â±0.0964 0.8940 Â±0.1498 0.9776 Â±0.0316
> NSIBF-PRED 0.9245 Â±0.1009 0.8695 Â±0.1768 0.9981 Â±0.0012 0.9383 Â±0.0872 0.9030 Â±0.1370 0.9803 Â±0.0278
> SRLR (Ours) 0.9980 Â±0.0013 1.0Â±0.00.9961 Â±0.0027 0.9982 Â±0.0015 1.0Â±0.00.9964 Â±0.0030
> Controller Configuration Tampering Attack CascadedNN 0.9736 Â±0.0571 0.9582 Â±0.0963 0.9951 Â±0.0141 0.9999 Â±0.01.0Â±0.01.0Â±0.0
> RNN 0.9286 Â±0.0841 0.9069 Â±0.1285 0.9662 Â±0.0655 0.9999 Â±0.01.0Â±0.01.0Â±0.0
> EncDec-AD 0.7721 Â±0.1402 0.6881 Â±0.2218 0.9544 Â±0.0914 0.9960 Â±0.0112 0.9922 Â±0.0214 1.0Â±0.0
> DAGMM 0.7014 Â±0.0923 0.5485 Â±0.1074 0.9950 Â±0.0161 0.7087 Â±0.0915 0.5560 Â±0.1074 1.0Â±0.0
> USAD 0.7555 Â±0.1274 0.6956 Â±0.2275 0.9201 Â±0.1359 0.9824 Â±0.0242 0.9664 Â±0.0456 1Â±0.0
> OmniAnomaly 0.7058 Â±0.0887 0.5552 Â±0.1015 0.9872 Â±0.0319 0.9399 Â±0.0848 0.8964 Â±0.1279 1.0Â±0.0
> NSIBF 0.751 Â±0.0621 0.6717 Â±0.0657 0.8519 Â±0.0541 0.9877 Â±0.0151 0.9759 Â±0.0295 1.0Â±0.0
> NSIBF-RECON 0.7080 Â±0.0458 0.5491 Â±0.0551 0.9996 Â±0.0004 0.9744 Â±0.0258 0.9755 Â±0.0141 0.9735 Â±0.0374
> NSIBF-PRED 0.7082 Â±0.0462 0.5493 Â±0.0554 1.0Â±0.00.9713 Â±0.0204 0.9695 Â±0.0036 0.9735 Â±0.0374
> SRLR (Ours) 0.9955 Â±0.0077 0.9981 Â±0.0043 0.9929 Â±0.0114 0.9999 Â±0.01.0Â±0.01.0Â±0.0
> Controller Disabling Attack CascadedNN 0.9727 Â±0.0392 0.9707 Â±0.0455 0.9757 Â±0.0433 0.9999 Â±0.01.0Â±0.01.0Â±0.0
> RNN 0.8857 Â±0.0823 0.8853 Â±0.0706 0.8899 Â±0.1079 0.9888 Â±0.0185 0.9801 Â±0.0318 0.9981 Â±0.0083
> EncDec-AD 0.5026 Â±0.0796 0.3946 Â±0.1230 0.8703 Â±0.2398 0.9139 Â±0.0454 0.8912 Â±0.0499 0.9444 Â±0.0860
> DAGMM 0.4824 Â±0.0790 0.3213 Â±0.0680 0.9991 Â±0.0020 0.4904 Â±0.0805 0.3284 Â±0.0696 1.0Â±0.0
> USAD 0.5056 Â±0.0734 0.3778 Â±0.1307 0.9394 Â±0.1854 0.8285 Â±0.0817 0.7738 Â±0.1005 0.9122 Â±0.1207
> OmniAnomaly 0.7229 Â±0.1020 0.6004 Â±0.1238 0.9324 Â±0.0912 0.9864 Â±0.0276 0.9745 Â±0.0506 1.0Â±0.0
> NSIBF 0.5839 Â±0.0206 0.5165 Â±0.0518 0.6907 Â±0.1476 0.8593 Â±0.0085 0.8483 Â±0.0066 0.8705 Â±0.0105
> NSIBF-RECON 0.5012 Â±0.0137 0.3344 Â±0.0122 1.0Â±0.00.7578 Â±0.0151 0.6221 Â±0.0119 0.9691 Â±0.0204
> NSIBF-PRED 0.5009 Â±0.0133 0.3342 Â±0.0119 0.9994 Â±0.0007 0.7699 Â±0.0323 0.6379 Â±0.0456 0.9725 Â±0.0030
> SRLR (Ours) 0.9822 Â±0.0264 0.9975 Â±0.0045 0.9685 Â±0.047 0.9999 Â±0.0001 1.0Â±0.00.9999 Â±0.0001
> 1F1 âˆ—, Precision âˆ—and Recall âˆ—refer to the metrics calculated using the point-adjusted evaluation strategy.

by tampering with sensor or actuator values, introducing perturbations into the system dynamics. The SWaT dataset has been extensively utilized in the machine learning community [4], [5]. Prior research primarily focuses on detecting attacks and triggering alarms without providing a comprehensive explanation for the occurrence of these attacks to system operators. Moreover, these studies often treat all attacks as a single category, overlooking the diverse nature of attack types. We address these limitations by conducting an in-depth analysis of attack behaviors, categorizing them into three distinct types. Subsequently, we apply our mode process identification method to recover controller logic, enabling the generation of rules for attack detection. Leveraging these generated rules, we detect attacks and provide detailed explanations to system operators when alarms are triggered. This approach not only enhances the accuracy of attack detection but also facilitates a deeper under-standing of the underlying causes behind these security breaches. Attack Categories. We classify the attacks observed in the SWaT dataset into three distinct types: a) Actuator Value Tampering Attack: The actuators themselves are targeted, resulting in the manipulation of their values. b) Actuator-Dependent Sensor Value Tampering Attack: The attacker tampers with sensor values that share a consis-tent relationship with specific actuators. This relationship becomes disrupted upon tampering with the sensor values. c) Actuator-Independent Sensor Value Tampering Attack: The attacker targets sensor values that are not directly related to the control logic of the PLCs governing the actuators. For our analysis, SWaT dataset encompasses 36 consecutive attacks, with 19 attacks classified as actu-ator value tampering, 6 attacks categorized as actuator-dependent sensor value tampering, and 11 attacks falling under the actuator-independent sensor value tampering category. This classification allows for a comprehensive understanding of the diverse attack scenarios present within the SWaT dataset. Attack Detection. We grouped the 51 variables into six categories corresponding to the distinct physical pro-cesses within the system. Each group encompasses both actuators and sensors that relate to its specific physical process. It is assumed that some of the actuators are controlled by the value of sensors and this can be expressed through a mathematical formulation. Upon examining the actuator data, it was observed that actuators operate in binary states, either â€onâ€ or â€offâ€, with these states typically determined by time-domain control logic. To reflect this behavior, SRLR is operated within the time domain on the SWaT system. To further enhance modeling accuracy, we introduced a step function. This adjustment not only better captures the binary nature of actuator outputs but also reduces the SRLR search space. With this configuration, SRLR is capable of capturing nonlinear relationships. The dynamic relationship between an actuator and its IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 12    

> (a) Actuator value tampering Attack. (b) Actuator-dependent sensor value tampering (c) Actuator-independent sensor value tampering
> Fig. 8. Examples of attack detection results on the SWaT dataset with red areas highlighting the intervals where actual attacks occur. (a) The observed and predicted values for the pump P205. The left sub-figure shows the training set and the right sub-figure shows the results on the testing set. (b) observations of differential pressure DPIT301 and the observed and predicted behavior of valve MV302 on the training and testing sets. (c) Observations of level transmitter LIT301 on training and testing sets.

sensors is represented by the following equation: 

y(t) = Step (f (x1(t), x 1(t âˆ’ Ï„ ), x 2(t), x 2(t âˆ’ Ï„ )... )) =

{1, f (x) â‰¥ 00, f (x) < 0

(21) where y(t) represents the actuator value at time step 

t, x(t), and x(t âˆ’ Ï„ ) denote the current and delayed sensor values within the same group, respectively. step () 

represents the step function. The function f (x) reveals the relationship between the sensors and the actuator, with the actuator activated if f (x) â‰¥ 0, and deactivated otherwise. Employing the proposed single-mode logic recovery approach, we endeavored to recover the truth logic of the function f (x) by identifying all relationships that invariantly hold true within the training dataset. Training on the SWaT dataset takes approximately 4.08 hours. This process generated 15 definitive rules that remained valid across the training set. Subsequently, these rules were applied to simulate the corresponding actuator val-ues within the testing set, facilitating the detection of anomalies indicative of potential attacks.  

> 1

def rule_1(P205_obs):  

> 2

x1=AIT202; x2=AIT203; x3=FIT201  

> 3

x4=AIT203_delay; x5=FIT201_delay  

> 4

P205_pred = step(x1âˆ—âˆ—3âˆ—x3âˆ’x2âˆ—x5+x2âˆ’2âˆ—x4)  

> 5

error = abs(P205_predâˆ’P205_obs)  

> 6

return error  

> 7

def rule_2(MV302_obs):  

> 8

x1=DPIT301; x2=FIT301;  

> 9

x3=LIT301; x4=FIT301_delay  

> 10

MV302_pred = step(x1âˆ’0.0115âˆ—x3)âˆ—(x2+x3+x4)  

> 11

error = abs(MV302_predâˆ’MV302_obs)  

> 12

return error  

> 13

def rule_3(LIT301_obs):  

> 14

if LIT301_obs>1020 or LIT301_obs<780:  

> 15

error = 1  

> 16

else :  

> 17

error = 0  

> 18

return error  

> Listing 1. Examples of invariant rules on the training dataset

For the first type of attack, i.e., the Actuator Value Tampering Attack, detection becomes feasible if rules gov-erning actuator value generation are correctly established by our proposed SRLR model. Leveraging the single-mode process identification method, we derive the formula governing the relationship between actuator P205 and sensors in process 2, subsequently yielding Rule 1. As depicted in List 1, rows 2 and 3 are sensor observations assignments, row 5 denotes the generated formula, and row 6 represents the error between predictive P205 and observed P205. As illustrated in Figure 8(a), predictive P205 consistently aligns with observations in the training data. However, in the test data, the actuator P205 is maliciously manipulated from â€œonâ€ to â€œoffâ€ during the attack, resulting in a discrepancy between predictive and observed P205 values and triggering an alarm. Thus, this actuator tampering attack is effectively detected. For the second type of attack, i.e., the Actuator-Dependent Sensor Value Tampering Attack, the sensor value is linked to the actuator. Although the sensor value does not directly control the output of the PLC, when the sensor value is tampered with, the systemâ€™s status becomes abnormal, disrupting the previous invariant relationship between the sensor and actuator. Therefore, identifying the relationship between sensors and their corresponding actuators can detect this type of attack. As illustrated in List 1 rows 9 to 14, we establish the relationship between the actuator MV302 and the sensor value DPIT301. This equation consistently holds true in the training data, as depicted in Figure 8(b). In the testing data, the attacker tampers with the DPIT301 value, causing oscillations in the MV302 value. However, when simulating the logic in List 1 row 12, the MV302 is predicted to remain consistently open, triggering the alarm and thus, detecting the attack successfully. For the third type of attack, i.e., the Actuator-Independent Sensor Value Tampering Attack, the sensor value neither controls the PLCâ€™s output nor has an in-variant relationship with actuators. Therefore, we cannot employ the mode equation identification method to detect this type of attack. However, we can utilize the normal range observed in the training data to constrain the corre-sponding sensor values in the testing data. As illustrated in Figure 8(c), although the LIT301 participates in the calculation of MV302, we find that tampering with the LIT301 value does not affect the prediction for the MV302. Then, we analyze the range of LIT301 in the training data and generate a rule to limit the range of LIT301 in the testing data. As shown in List 1 rows 16 to 21, IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 13                                                                                                                                                                                               

> TABLE VIII The comparison of attack detection in the SWaT system. Model F1 Precision Recall F1 âˆ—Precision âˆ—Recall âˆ—
> CascadedNN 0.6829 Â±0.0619 0.7473 Â±0.1647 0.6433 Â±0.0296 0.9010 Â±0.0062 0.9499 Â±0.0144 0.8573 Â±0.0170
> RNN 0.6963 Â±0.0735 0.9386 Â±0.0457 0.5612 Â±0.1032 0.9048 Â±0.0184 0.9471 Â±0.0242 0.8668 Â±0.0340
> EncDec-AD 0.6940 Â±0.0405 0.8272 Â±0.1517 0.6080 Â±0.0506 0.8762 Â±0.0185 0.9132 Â±0.0264 0.8423 Â±0.0183
> DAGMM 0.2165 Â±0.00.1213 Â±0.0001 0.9999 Â±0.00.8533 Â±0.0097 0.8602 Â±0.0116 0.8464 Â±0.0079
> USAD 0.6807 Â±0.0977 0.8240 Â±0.2933 0.6188 Â±0.0570 0.8534 Â±0.0172 0.9442 Â±0.0540 0.7836 Â±0.0703
> OmniAnomaly 0.7540 Â±0.0018 0.9962 Â±0.0007 0.6066 Â±0.0026 0.7993 Â±0.0053 0.9993 Â±0.0009 0.6660 Â±0.0076
> NSIBF 0.6983 Â±0.0053 0.7725 Â±0.0116 0.6371 Â±0.0017 0.8691 Â±0.0096 0.8273 Â±0.0156 0.9164 Â±0.0362
> NSIBF-RECON 0.7603 Â±0.0037 0.9669 Â±0.0316 0.6270 Â±0.0182 0.8690 Â±0.0217 0.9481 Â±0.0103 0.8023 Â±0.0297
> NSIBF-PRED 0.7417 Â±0.0037 0.9468 Â±0.0438 0.6106 Â±0.0216 0.8680 Â±0.0125 0.8660 Â±0.0337 0.8710 Â±0.0216
> SRLR (Ours) 0.8329 Â±0.0007 0.9816 Â±0.0007 0.7233 Â±0.0015 0.9299 Â±0.0096 0.9353 Â±0.0197 0.9247 Â±0.0
> 1F1 âˆ—, Precision âˆ—and Recall âˆ—refer to the metrics calculated using the point-adjusted evaluation strategy. )DOVH SRVLWLYHV 7UXHSRVLWLYHV )DOVH SRVLWLYHV 7UXHSRVLWLYHV 7KHRFFXUUHQFHRIDWDQN RYHUIORZ $SLSHEXUVWGXHWRWKH RSHQLQJRIWKHEDFNXS SXPS
> Fig. 9. The case study for false positives.

we observe that LIT301 in the training data falls within the range of [780,1020]. In the testing data, when the value of LIT301 is tampered to exceed the normal range, this attack can succeed, as depicted at the bottom of Figure 8(c). Thus, while this type of attack cannot be detected by the proposed model, we can still apply the range rule to detect out-of-range values. We observe some (false) alarms when there is no attack. For instance, SRLR identifies a relationship between MV101 and sensor FIT101. However, there are instances of delayed responses / updates in the testing data, leading to triggering of alarms. In this case, SRLR recovers correct logic, but there is an additional task (beyond SRLR) to distinguish whether the violation of the rule is due to attack or some data anomaly. Comparison with Baselines. We compare our results with various deep learning-based methods and neural system identification models. As depicted in Table VIII, our model surpasses EncDec-AD, generation-based models USAD, DAGMM, OmniAnomaly, and neural system identifica-tion models CascadedNN, RNN and NSIBF. Specifically, although NSIBF (neural system identification method) can numerically identify systems, it fails to generate a clear expression, thereby lacking explanatory power for ICS operators. Once the true rules are generated by SRLR, attacks can be detected effectively, as most attacks involve control logic modifications, output value tampering, or sensor readings falling outside valid ranges. Consequently, the number of false negatives is significantly lower com-pared to deep learning methods, as evidenced by the recall metric in Table VIII. As previously discussed, the rare cases of misdetection are due to environmental sampling delays. As illustrated in Figure 9, these false positives occur either due to the persistence of the hazard (e.g., tank overflow) or due to the discrepancies of actuator-sensor relationship rules generated by SRLR. Although the data is labeled as normal in the gray area shown in Figure 9, these false alarms are justifiable in real-world systems. For the first false alarm, despite the valve being closed, the water level takes time to return to normal, leading to a delay that results in false positives (grey area). For the second alarm, our model detects an immediate violation of the actuator values as soon as the pump is activated, even though the pipe has not yet burst. This early detection leads to false positives. Furthermore, the false positive rate of SRLR is 0.0068 . We already consider the noise and outliers, hence the number of false positives can be kept to a minimum. This results in a precision score consistently over 90%. The ICS-specific design of SRLR enables it to handle complex systems effectively, allowing it to generate rules for attack detection that minimize both false positives and false negatives. This design ensures superior F1 performance, providing a robust solution for detecting deviations in PLC behavior. VI. Related Work and Limitations A. Logic Recovery Logic recovery aims to infer the underlying PLC logic solely from input-output data. This concept overlaps with system identification and symbolic regression, as all three approaches focus on deriving mathematical representa-tions from observed data. In this section, we review these related methods to contextualize our approach. System Identification. System identification (SI) has been a prominent research interest (see [39] and references therein), evolving from the identification of linear systems to encompass non-linear and hybrid system identifica-tion. Classical SI methods like ARX, FIR, and ARMAX employ linear combinations of inputs to predict system outputs, and this paradigm extends to nonlinear systems in methods such as NARX [9] and NARMAX [40]. Some SI methods detect multi-mode systems by fine-tuning the IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 14 

parameters of a predefined nonlinear model, such as the linear piecewise affine system identification method [41] and the hybrid system identification method [42]. In comparison with these methods, SRLR offers greater flexibility, as it does not require prior knowledge of the model structure. Symbolic Regression. Existing symbolic regression methods can be broadly categorized into three groups: heuristic methods, pre-trained methods, and reinforce-ment learning methods. Heuristic methods [10], [11] em-ploy evolutionary techniques like GP to explore the search space for optimal solutions. However, these methods face scalability issues and are sensitive to hyperparameters [16]. Pre-trained methods [43], [44] leverage pre-trained models to provide prior knowledge for guiding the initial search space exploration. However, these methods primarily focus on numerical results, making it challenging to handle sym-bols due to their discrete characteristics. Reinforcement learning methods [16], [45], on the other hand, sample symbols and address the discrete sampling process using policy gradient training. This approach has proven to be efficient and has achieved SOTA results in symbolic regression benchmarks. Thus, we adopt DSR [16] in this work as the backbone framework for identifying control logic. Logic Recovery. The concept of logic recovery has been explored extensively [9], [39]. For instance, Schmidt and Lipson [10] employed an evolutionary-based symbolic re-gression method to uncover physical laws through motion-tracking data, striking a balance between computational complexity and accuracy of discovery with the Pareto Front. Ly et al. [12] proposed the Cluster SR designed to identify time-invariant nonlinear hybrid systems. They integrated GP and the Expectation Maximization (EM) algorithm to infer the equations governing each mode and introduced a classification method to recover the transition logic among distinct modes within the hybrid system. In our experiments, existing clustering-based methods performed poorly in identifying complex nonlinear PLC logics. For example, mode memberships determined by Cluster SR were often sparse and inaccurate in complex systems, largely due to their reliance on soft assignments and the absence of continuity constraints. By contrast, SRLR achieved a 39% improvement in BFR in noisy environments compared with Cluster SR. Furthermore, without key designs used in SRLR like the s-domain enhancement and complexity regularization, existing sym-bolic regression methods such as PySR and Operon failed to identify subsystems in load frequency control systems and automatic voltage regulators, including PID controllers. Several studies have explored methods for reverse-engineering PLC logic. Reditus [46] captures network packets generated during PLC program execution and reconstructs the logic using the decompilation tools pro-vided by PLC workstations. However, this approach is limited to a small subset of PLCs; for example, recent platforms such as Siemens TIA Portal and Codesys do not support reverse-engineering functions. Another line of research proposes extracting PLC logic from compiled binaries through database mapping. In this method [47], a database maps binary structures to their corresponding control program components, and similarity analysis is used to match target code segments. While effective in some cases, it is impractical to enumerate all mapping relationships needed to reconstruct complex control logic, especially those involving varied arithmetic operations. CLEVER [48] addresses this challenge by analyzing PLC control applications directly. Using heuristic algorithms, it identifies variable dependencies and sequentially decom-piles the source code. However, its effectiveness is limited when variable dependencies are incomplete, leading to failures in recognizing certain numerical operations, such as cyclic shift functions in motor control programs. In contrast, SRLR demonstrates strong capabilities in handling numerical calculations. First, it employs s-domain modeling to broaden the scope of recognized operations, enabling the modeling of motor logic in LFC systems. Second, SRLR focuses on recovering mathemat-ical relationships between variables, making the precise code implementation less critical in some contexts. These strengths allow SRLR to operate independently of specific programming platforms while offering robust logic recon-struction capabilities. B. Attack Detection Attack detection methods in ICSs are crucial for addressing threats in both cyber and physical lay-ers and these methods can be broadly catego-rized into specification-based and ML-based approaches. Specification-based methods [1], [13] derive rules from a database of known attacks and employ these rules to identify threats as they occur. These methods typically offer high accuracy and clear explanations; however, their major limitation lies in the difficulty of detecting zero-day attacks, which are not represented in the existing database. In contrast, ML-based methods [4], [5], [14], [15] leverage statistical or machine learning techniques to develop patterns of normal data, which facilitates the detection of zero-day attacks by recognizing patterns that deviate from the norm. Despite this capability, ML-based methods often suffer from a low true positive rate, particularly when attack data falls within the normal data range or does not significantly deviate from established patterns. Additionally, ML-based methods cannot gen-erally provide clear, easily understandable explanations for their detection decisions. From the perspective of ICS security, related efforts can be broadly categorized into three areas: process-level protection, sensor data integrity, and PLC code integrity verification. In this section, we review representative work in each of these areas and discuss relevant AI explainability methods that related to the goals of our approach. Process-level Protection. Regarding process control at-tacks, Hadziosmanovi et.al [49] proposed monitoring the IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 15 

status of PLC variables and developing a regression model to predict variable traces, aiming to detect discrepancies that do not match the predicted patterns. However, in modern ICSs, PLC outputs are predominantly binary variables, such as commands for controlling valves or pumps in water treatment systems. This characteristic poses a significant challenge for time-series models, as accurately predicting binary outcomes often proves dif-ficult. Tan et al. [8] introduced CoToRu, a method for inferring the behavior of PLCs to detect attacks. Their approach involves parsing the PLC code to generate a state transition table, which is then used to derive rules for detecting threats. While their method is effective and achieves high accuracy, obtaining access to the PLC code can be challenging for third-party security teams in real-world scenarios. Sensor Data Integrity. Numerous studies have focused on protecting sensor data integrity. A common approach involves using prediction models to forecast future sensor values. PyCRA [50], for example, enhances these predic-tion methods by comparing current readings with histor-ical data, employing a noise-reduction strategy to detect stealthy integrity attacks. Another widely-used method is the Linear Dynamical State-Space model, which simulates process behavior using known signals and compares the simulated values with sensor response. While effective for process-level data integrity detection, these methods struggle with predicting the outputs of controllers. SRLR, on the other hand, is specifically designed to counter logic attacks on controllers. Unlike the methods above, which focus on sensor data integrity, SRLR addresses the core logic of controllers, making it a complementary and or-thogonal approach. Deploying SRLR alongside sensor data integrity protection methods can provide comprehensive protection against both process-level attacks (such as false data injection via sensor) and control logic tampering. Attesting PLC Code Integrity. Attesting code integrity is another potential solution for addressing PLC logic tampering. This can be achieved through root-of-trust mechanisms in specialized hardware modules or checksum verification via updating PLC software. However, these methods often require invasive hardware modifications or PLC vendorâ€™s support [51] and are vulnerable to time-of-check-to-time-of-use (TOCTOU) attacks [52]. In contrast, SRLR can be integrated into existing PLC I/O monitoring platforms, such as commercial-ready level 0 monitoring solutions 2, to offer advanced logic attack detection in a non-invasive manner. C. Scope and Limitations. PLC logic covers a wide range of control strategies. From a control theory perspective, these strategies fall into two broad categories: open-loop control, such as simple switches, and closed-loop control, including PID controllers. Our experiments show that the SRLR frame-work effectively recovers certain open-loop behaviors, such 

> 2https://sigasec.com

as hysteresis relay logic, and accommodates variations of PID control commonly used in closed-loop systems. However, SRLR has limitations when applied to complex control strategies such as Model Predictive Control and 

Hâˆž control. These approaches involve solving quadratic programming or semi-definite programming problems with intricate constraints, making it difficult to represent their logic through simple mathematical expressions. As aresult, such advanced control methods fall outside the current scope of SRLR. From a syntactic standpoint, PLC programs rely on a set of standardized function blocks, which can be grouped into key categories: Bitwise operations; Timers; Counters; Edge detection; Data operations; Control functions. Many of these constructsâ€”such as bitwise logic and arithmeticâ€” map directly to mathematical symbols, expanding the SRLR frameworkâ€™s symbolic library, enabling effective handling of such logic. Timer functions can also be expressed mathematically. For example, the TON (on-delay) timer activates when its input signal remains high for a duration longer than a predefined threshold. This behavior can be represented as: 

Q(t) = H(I(t)âˆ† t

> N

âˆ‘ 

> Ï„=0

I(t âˆ’ Ï„ ) âˆ’ P T ), (22) where I(t) is the input signal, P T the preset time, âˆ†t the PLC scan cycle, and H the Heaviside step function. The accumulated time Tacc (t) = I(t)âˆ† t âˆ‘NÏ„ =0 I(t âˆ’ Ï„ ), similar to an EWMA, is reset whenever the input is low. SRLR has been shown to recover EWMA-like patterns even in noisy environments, supporting its ability to model timer behaviors. Other PLC structures can be similarly translated into mathematical representations, such as counters and edge triggers. These results collectively demonstrate that SRLR is capable of capturing basic PLC syntax. However, the mathematical modeling of more complex process control and sequential structures like interrupt and asynchronous event handling becomes significantly more complicated. These advanced control logics are currently beyond the scope of SRLR. While SRLR shows promising results in our experiments across various ICS domains, thorough evaluation with a more diverse set of control logic is needed to characterize SRLRâ€™s capability and applicability â€” specifically, future work is needed to answer the following questions: which type of control logic SRLR can handle well, and which types it cannot? Is there a complexity bound for the control logic, beyond which, SRLR can no longer work reliably? If that is the case, can we find a reliable way to divide and conquer a complicated system using SRLR? We hope our work can inspire future research in these directions. VII. Conclusion We presented SRLR, a novel approach to recover logic of PLC and generate rules for detecting logic manipulation IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 16 

attacks in ICSs. SRLR accurately infers formulas for both single-mode and multi-mode processes, recovering the control logic of PLCs. The recovered logic helps generate rules capable of detecting attacks such as controller config-uration tampering, malicious controller output injection, and controller disabling. SRLR is tested on both a grid frequency control system and a water treatment testbed. Results indicate that SRLR outperforms existing deep anomaly detection models, while providing explainability to its decisions. In future work, we will evaluate SRLR under more complex control logic and determine the applicable range of such methods. Acknowledgments This research is supported in part by the National Natural Science Foundation of China under the Grant No. 62371057; and in part by the National Research Foundation, Singapore, under its National Satellite of Excellence Programme â€œDesign Science and Technology for Secure Critical Infrastructure: Phase IIâ€, under Award NRF-NCR25-NSOE05-0001. Any opinions, findings and conclusions or recommendations expressed in this material are those of the author(s) and do not reflect the views of National Research Foundation, Singapore. The work was done when Hao Zhou was a visiting PhD student in Singapore University of Technology and Design (SUTD). References 

[1] J. Giraldo, D. Urbina, A. Cardenas, J. Valente, M. Faisal, J. Ruths, N. O. Tippenhauer, H. Sandberg, and R. Candell, â€œA survey of physics-based attack detection in cyber-physical systems,â€ ACM Computing Surveys (CSUR), vol. 51, no. 4, pp. 1â€“36, 2018. [2] H. Zhu, M. Liu, B. Chen, X. Che, P. Cheng, and R. Deng, â€œHoneyjudge: A plc honeypot identification framework based on device memory testing,â€ IEEE Transactions on Information Forensics and Security, 2024. [3] D. Kushner, â€œThe real story of stuxnet,â€ IEEE Spectrum, vol. 50, no. 3, pp. 48â€“53, 2013. [4] C. Feng and P. Tian, â€œTime series anomaly detection for cyber-physical systems via neural system identification and bayesian filtering,â€ in Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery & Data Mining, 2021, pp. 2858â€“2867. [5] S. Tuli, G. Casale, and N. R. Jennings, â€œTranad: Deep trans-former networks for anomaly detection in multivariate time series data,â€ arXiv preprint arXiv:2201.07284, 2022. [6] A. Deng and B. Hooi, â€œGraph neural network-based anomaly detection in multivariate time series,â€ in Proceedings of the AAAI conference on artificial intelligence, 2021, pp. 4027â€“4035. [7] I. Stellios, P. Kotzanikolaou, M. Psarakis, C. Alcaraz, and J. Lopez, â€œA survey of iot-enabled cyberattacks: Assessing attack paths to critical infrastructures and services,â€ IEEE Communications Surveys & Tutorials, vol. 20, no. 4, pp. 3453â€“ 3495, 2018. [8] H. C. Tan, C. Cheh, and B. Chen, â€œCotoru: automatic genera-tion of network intrusion detection rules from code,â€ in IEEE INFOCOM 2022-IEEE Conference on Computer Communica-tions. IEEE, 2022, pp. 720â€“729. [9] L. Ljung, C. Andersson, K. Tiels, and T. B. SchÃ¶n, â€œDeep learn-ing and system identification,â€ IFAC-PapersOnLine, vol. 53, no. 2, pp. 1175â€“1181, 2020. [10] M. Schmidt and H. Lipson, â€œDistilling free-form natural laws from experimental data,â€ science, vol. 324, no. 5923, pp. 81â€“85, 2009. [11] T. N. Mundhenk, M. Landajuela, R. Glatt, C. P. Santiago, D. M. Faissol, and B. K. Petersen, â€œSymbolic regression via neural-guided genetic programming population seeding,â€ 2021. [12] D. L. Ly and H. Lipson, â€œLearning symbolic representations of hybrid dynamical systems,â€ The Journal of Machine Learning Research, vol. 13, no. 1, pp. 3585â€“3618, 2012. [13] A. Khraisat, I. Gondal, P. Vamplew, and J. Kamruzzaman, â€œSurvey of intrusion detection systems: techniques, datasets and challenges,â€ Cybersecurity, vol. 2, no. 1, pp. 1â€“22, 2019. [14] S. Han and S. S. Woo, â€œLearning sparse latent graph repre-sentations for anomaly detection in multivariate time series,â€ in Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, 2022, pp. 2977â€“2986. [15] J. Audibert, P. Michiardi, F. Guyard, S. Marti, and M. A. Zu-luaga, â€œUsad: Unsupervised anomaly detection on multivariate time series,â€ in Proceedings of the 26th ACM SIGKDD Inter-national Conference on Knowledge Discovery & Data Mining, 2020, pp. 3395â€“3404. [16] B. K. Petersen, M. Landajuela, T. N. Mundhenk, C. P. Santiago, S. K. Kim, and J. T. Kim, â€œDeep symbolic regression: Recover-ing mathematical expressions from data via risk-seeking policy gradients,â€ in Proc. of the International Conference on Learning Representations, 2021. [17] J. Goh, S. Adepu, K. N. Junejo, and A. Mathur, â€œA dataset to support research in the design of secure water treatment systems,â€ in Critical Information Infrastructures Security: 11th International Conference, CRITIS 2016, Paris, France, October 10â€“12, 2016, Revised Selected Papers 11. Springer, 2017, pp. 88â€“99. [18] H. Wang, T. Fu, Y. Du, W. Gao, K. Huang, Z. Liu, P. Chandak, S. Liu, P. Van Katwyk, A. Deac et al., â€œScientific discovery in the age of artificial intelligence,â€ Nature, vol. 620, no. 7972, pp. 47â€“60, 2023. [19] R. Spenneberg, M. BrÃ¼ggemann, and H. Schwartke, â€œPlc-blaster: A worm living solely in the plc,â€ Black Hat Asia, vol. 16, pp. 1â€“16, 2016. [20] W. Aoudi, M. Iturbe, and M. Almgren, â€œTruth will out: Departure-based process-level detection of stealthy attacks on control systems,â€ in Proceedings of the 2018 ACM SIGSAC Conference on Computer and Communications Security, 2018, pp. 817â€“831. [21] S. Fuller, B. Greiner, J. Moore, R. Murray, R. van Paassen, and R. Yorke, â€œThe python control systems library (python-control),â€ in 60th IEEE Conference on Decision and Control (CDC). IEEE, 2021, pp. 4875â€“4881. [22] M. Kumar, B. Packer, and D. Koller, â€œSelf-paced learning for latent variable models,â€ in Advances in Neural Information Processing Systems, J. Lafferty, C. Williams, J. Shawe-Taylor, R. Zemel, and A. Culotta, Eds., vol. 23. Curran Associates, Inc., 2010. [Online]. Available: https://proceedings.neurips.cc/paper_files/paper/ 2010/file/e57c6b956a6521b28495f2886ca0977a-Paper.pdf [23] H. Akaike, â€œA new look at the statistical model identification,â€ IEEE transactions on automatic control, vol. 19, no. 6, pp. 716â€“ 723, 1974. [24] K. Hundman, V. Constantinou, C. Laporte, I. Colwell, and T. Soderstrom, â€œDetecting spacecraft anomalies using lstms and nonparametric dynamic thresholding,â€ in Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery & data mining, 2018, pp. 387â€“395. [25] D. Masti and A. Bemporad, â€œLearning nonlinear stateâ€“space models using autoencoders,â€ Automatica, vol. 129, p. 109666, 2021. [26] K. B. Newhart, R. W. Holloway, A. S. Hering, and T. Y. Cath, â€œData-driven performance analyses of wastewater treatment plants: A review,â€ Water research, vol. 157, pp. 498â€“513, 2019. [27] M. Cranmer, â€œInterpretable machine learning for sci-ence with pysr and symbolicregression. jl,â€ arXiv preprint arXiv:2305.01582, 2023. [28] B. Burlacu, G. Kronberger, and M. Kommenda, â€œOperon c++ an efficient genetic programming framework for symbolic re-gression,â€ in Proceedings of the 2020 genetic and evolutionary computation conference companion, 2020, pp. 1562â€“1570. [29] H. Saadat et al., Power system analysis. McGraw-hill, 1999, vol. 2. [30] Z. A. Obaid, L. M. Cipcigan, and M. T. Muhssin, â€œFuzzy hierarchal approach-based optimal frequency control in the great britain power system,â€ Electric power Systems research, vol. 141, pp. 529â€“537, 2016. IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 17 

[31] Y. Su, Y. Zhao, C. Niu, R. Liu, W. Sun, and D. Pei, â€œRobust anomaly detection for multivariate time series through stochas-tic recurrent neural network,â€ in Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery & data mining, 2019, pp. 2828â€“2837. [32] P. Malhotra, A. Ramakrishnan, G. Anand, L. Vig, P. Agarwal, and G. Shroff, â€œLstm-based encoder-decoder for multi-sensor anomaly detection,â€ 2016. [33] B. Zong, Q. Song, M. R. Min, W. Cheng, C. Lumezanu, D. Cho, and H. Chen, â€œDeep autoencoding gaussian mixture model for unsupervised anomaly detection,â€ in International Conference on Learning Representations, 2018, pp. 1â€“19. [Online]. Available: https://openreview.net/forum?id=BJJLHbb0-[34] H.-B. Shin and J.-G. Park, â€œAnti-windup pid controller with integral state predictor for variable-speed motor drives,â€ IEEE Transactions on Industrial Electronics, vol. 59, no. 3, pp. 1509â€“ 1516, 2011. [35] L. R. da Silva, R. C. Flesch, and J. E. Normey-Rico, â€œAnalysis of anti-windup techniques in pid control of processes with measurement noise,â€ IFAC-PapersOnLine, vol. 51, no. 4, pp. 948â€“953, 2018. [36] L. Jia and X. Zhao, â€œAn improved particle swarm optimization (pso) optimized integral separation pid and its application on central position control system,â€ IEEE Sensors Journal, vol. 19, no. 16, pp. 7064â€“7071, 2019. [37] J. Liu, Y. Gu, L. Zha, Y. Liu, and J. Cao, â€œEvent-triggered 

hâˆž load frequency control for multiarea power systems under hybrid cyber attacks,â€ IEEE Transactions on Systems, Man, and Cybernetics: Systems, vol. 49, no. 8, pp. 1665â€“1678, 2019. [38] D. EStimator, â€œA fast algorithm for the minimum covariance,â€ Technometrics, vol. 41, no. 3, p. 212, 1999. [39] L. Ljung, â€œPerspectives on system identification,â€ Annual Re-views in Control, vol. 34, no. 1, pp. 1â€“12, 2010. [40] S. A. Billings, Nonlinear system identification: NARMAX meth-ods in the time, frequency, and spatio-temporal domains. John Wiley & Sons, 2013. [41] L. Bako, â€œIdentification of switched linear systems via sparse optimization,â€ Automatica, vol. 47, no. 4, pp. 668â€“677, 2011. [42] Y. Yuan, X. Tang, W. Zhou, W. Pan, X. Li, H.-T. Zhang, H. Ding, and J. Goncalves, â€œData driven discovery of cyber physical systems,â€ Nature communications, vol. 10, no. 1, p. 4894, 2019. [43] S. Holt, Z. Qian, and M. van der Schaar, â€œDeep generative symbolic regression,â€ 2023. [44] M. Valipour, B. You, M. Panju, and A. Ghodsi, â€œSymbolicgpt: A generative transformer model for symbolic regression,â€ 2021. [45] M. Landajuela, B. K. Petersen, S. Kim, C. P. Santiago, R. Glatt, N. Mundhenk, J. F. Pettit, and D. Faissol, â€œDiscovering sym-bolic policies with deep reinforcement learning,â€ in International Conference on Machine Learning. PMLR, 2021, pp. 5979â€“5989. [46] S. A. Qasim, J. M. Smith, and I. Ahmed, â€œControl logic forensics framework using built-in decompiler of engineering software in industrial control systems,â€ Forensic Science International: Digital Investigation, vol. 33, p. 301013, 2020. [47] S. Kalle, N. Ameen, H. Yoo, and I. Ahmed, â€œClik on plcs! attacking control logic with decompilation and virtual plc,â€ in Binary Analysis Research (BAR) Workshop, Network and Distributed System Security Symposium (NDSS), 2019, pp. 1â€“ 12. [48] C. Sang, J. Wu, J. Li, and M. Guizani, â€œFrom control appli-cation to control logic: Plc decompile framework for industrial control system,â€ IEEE Transactions on Information Forensics and Security, vol. 19, pp. 8685â€“8700, 2024. [49] D. HadÅ¾iosmanoviÄ‡, R. Sommer, E. Zambon, and P. H. Hartel, â€œThrough the eye of the plc: semantic security monitoring for industrial processes,â€ in Proceedings of the 30th Annual Computer Security Applications Conference, 2014, pp. 126â€“135. [50] Y. Shoukry, P. Martin, Y. Yona, S. Diggavi, and M. Srivastava, â€œPycra: Physical challenge-response authentication for active sensors under spoofing attacks,â€ in Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security, 2015, pp. 1004â€“1015. [51] W. Lin, H. C. Tan, B. Chen, and F. Zhang, â€œDnattest: Digital-twin-based non-intrusive attestation under transient uncer-tainty,â€ in 2023 53rd Annual IEEE/IFIP International Con-ference on Dependable Systems and Networks (DSN). IEEE, 2023, pp. 376â€“388. [52] S. Bratus, N. Dâ€™Cunha, E. Sparks, and S. W. Smith, â€œToctou, traps, and trusted computing,â€ in International Conference on Trusted Computing. Springer, 2008, pp. 14â€“32. [53] R. K. Pearson, â€œOutliers in process modeling and identification,â€ IEEE Transactions on control systems technology, vol. 10, no. 1, pp. 55â€“63, 2002. [54] L. Ljung, â€œExperiments with identification of continuous time models,â€ IFAC Proceedings Volumes, vol. 42, no. 10, pp. 1175â€“ 1180, 2009. [55] M. T. Ribeiro, S. Singh, and C. Guestrin, â€œâ€ why should i trust you?â€ explaining the predictions of any classifier,â€ in Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining, 2016, pp. 1135â€“1144. [56] S. M. Lundberg and S.-I. Lee, â€œA unified approach to inter-preting model predictions,â€ Advances in neural information processing systems, vol. 30, 2017. [57] D. W. Apley and J. Zhu, â€œVisualizing the effects of predictor variables in black box supervised learning models,â€ Journal of the Royal Statistical Society Series B: Statistical Methodology, vol. 82, no. 4, pp. 1059â€“1086, 2020. [58] D. Han, Z. Wang, W. Chen, Y. Zhong, S. Wang, H. Zhang, J. Yang, X. Shi, and X. Yin, â€œDeepaid: Interpreting and improving deep learning-based anomaly detection in security applications,â€ in Proceedings of the 2021 ACM SIGSAC Con-ference on Computer and Communications Security, 2021, pp. 3197â€“3217. [59] R. Langner, â€œStuxnet: Dissecting a cyberwarfare weapon,â€ IEEE Security & Privacy, vol. 9, no. 3, pp. 49â€“51, 2011. [60] Y. Geng, X. Che, R. Ma, Q. Wei, M. Wang, and Y. Chen, â€œControl logic attack detection and forensics through reverse-engineering and verifying plc control applications,â€ IEEE Inter-net of Things Journal, vol. 11, no. 5, pp. 8386â€“8400, 2023. [61] A. Di Pinto, Y. Dragoni, and A. Carcano, â€œTriton: The first ics cyber attack on safety instrument systems,â€ Proc. Black Hat USA, vol. 2018, pp. 1â€“26, 2018. 

Hao Zhou received the B.Sc. degree in commu-nication engineering from Wuhan University of Technology in 2019 and the Ph.D. degree in information and communication engineering from Beijing University of Posts and Telecom-munications in 2025. He was a visiting Ph.D. student at the Singapore University of Tech-nology and Design from 2023 to 2024. His current research interests include AI-native radio access networks and time series modeling for forecasting and anomaly detection. 

Suman Sourav is an Assistant Professor at Aalborg University, Denmark. He earned his Ph.D. from the National University of Sin-gapore, where he also received the Research Achievement Award. He was previously a Re-search Fellow at the Singapore University of Technology and Design and at Illinois Ad-vanced Research Centre, Singapore. His re-search interest lies in the interplay of theory and application, considering both theoretical as well as practically implemented algorithmic aspects of real-world systems, including topics such as satellite networks, edge-cloud systems, distributed computing, and cyber-physical systems. IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 18 

Binbin Chen (Mâ€™11) received the B.Sc. degree in computer science from Peking University in 2003 and the Ph.D. degree in computer science from the National University of Singapore in 2010. Since July 2019, he has been an As-sociate Professor in the Information Systems Technology and Design (ISTD) pillar, Sin-gapore University of Technology and Design (SUTD). His current research interests include wireless networks, cyber-physical systems, and cyber security for critical infrastructures. 

Ke Yu received the B.S. degree in com-puter science and the Ph.D. degree in sig-nal and information processing from Beijing University of Posts and Telecommunications (BUPT), China, in 2000 and 2005, respec-tively. She worked as a visiting researcher at the University of Agder, Norway in 2011. From 2015 to 2016, she has been a visiting scholar in the University of Illinois at Chicago, USA. She is currently a professor at the School of Artificial Intelligence, BUPT. Her research in-terests include communication network theory, network data mining and anomaly detection, Internet of Agents. IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 19 

Appendix I: Detailed Algorithms of SRLR A. Multi-mode Logic Recovery Algorithm Algorithm 1 Alternative optimization strategy for multi-mode logic recovery 

Input: Dataset D = {(xt, y t)|t âˆˆ T = {1, 2, ..., T }} and 

max _iter 

Output: The total number of modes K, index of each mode ind k and dynamic equation of each mode fk(.) 

> 1:

Initialization: K â† 1, {Î³t}tâˆˆW â† 1, {Î³t}tâˆˆT â§¹W â† 0 

> 2:

repeat  

> 3:

if K = 1 then  

> 4:

TK â† T  

> 5:

else  

> 6:

TK â† T â§¹ â‹ƒKâˆ’1 

> k=1

Tk 

> 7:

end if  

> 8:

for all i = 1 , 2, Â· Â· Â· , max _iter do  

> 9:

/* Update parameters of DSR */ 

Î¶(i+1)  

> K

= arg min 

> Î¶K

Jrisk (Î¶(i) 

> K

; Îµ) 

> 10:

Calculate current loss {lt}tâˆˆT K 

> 11:

/* Update Î³ */ 

Î³(i+1)  

> K

= arg min   

> Î³Kâˆˆ{ 0,1}|T K|

âˆ‘ 

> tâˆˆT K

Î³(i)

> K,t

l(i) 

> t

âˆ’ Î»Î³ (i) 

> K,t
> 12:

end for  

> 13:

{ind K } â† { t|Î³k,t = 1 , t âˆˆ T K } 

> 14:

if T â§¹ â‹ƒKk=1 {ind k} = âˆ… then  

> 15:

return K, f 1, ..., f K , ind 1, ..., ind K . 

> 16:

else  

> 17:

K â† K + 1  

> 18:

end if  

> 19:

until all the points are identified. The details of multi-mode logic recovery are illustrated in Algorithm 1, where the input consists of the training dataset and the maximum allowed iteration for each mode identification ( max _itr ). The algorithm outputs the total number of modes, the indexes of mode changes, and the mode expressions. Initialization (Row 1) involves assigning the first w points ( W = {1, 2, ..., w }) to mode 1, which serves as prior information (follows from Assumption 1). Rows 3-7 check the unmarked dataset, while Rows 8-12 represent the identification process. Row 9 optimizes the DSR model with the fixed mode membership Î³, followed by Row 10, which computes the prediction loss for each point. Row 11 updates the mode membership Î³ with a fixed mode expression. Row 13 indicates the identification index for the K-th mode. This process is repeated until all points are successfully identified. An adjustment method is proposed to enhance the precision of index identification. It is assumed that the points generated by each mode exhibits temporal continuity. We utilize a sliding window approach with a size and sliding step of 50 to carefully adjust identified points in high-level noisy data. If the proportion of identified points exceeds 80% of all points within the window, we classify all points within that window as identified; otherwise, they are classified as unidentified. This large sliding step was chosen not only to minimize misclassified points in switching time step of the subsystem, but also to enhance computational efficiency. B. Outlier-aware Training The outlier-aware training algorithm is shown in Algo-rithm 2, where N is the batch size. Algorithm 2 Outlier-aware method for dynamic system iden-tification 

Input: Dataset D = {(xt, y t)|t âˆˆ T = {1, 2, ..., T }} and 

max _itr 

Output: The best fitting expression Ï„ âˆ—

Initialization: The parameters of RNN and the initial distribution of p(.|Î¶) 

> 2:

repeat /* Sample a batch of expressions using RNN */ 

O = {Ï„ (i)}Ni=1  

> 4:

/* Initialize constant items */ 

O â† { InitializeConstant (Ï„ (i))}Ni=1 

/* Compute loss for each training point */ 

L(i) â† { l(i) 

> t

= |yt âˆ’ Ë†y(i) 

> t

| | t âˆˆ T } , i = 1 , 2, ..., N  

> 6:

/* Remove training points with higher losses, th is the (1-Î±)-quartile of losses */ 

T (i) â† { t | l(i) 

> t

â‰¤ th, t âˆˆ T } , i = 1 , 2, ..., N 

/* Optimize constant items */ 

O â† { OptimizeConstant (Ï„ (i), R, T (i))}Ni=1  

> 8:

/* Update DSR parameters */ 

Î¶ â† arg min 

> Î¶

Jrisk (Î¶; Îµ, T (i)), i = 1 , 2, ..., N 

/* Evaluate current best expression */ if max R > R (Ï„ âˆ—) then Ï„ âˆ— â† Ï„ arg max R 

> 10:

until evaluation error smaller than the threshold or maximum iterations max _itr is reached. C. Mode Switch Detection Procedure The mode switch detection process consists of three main steps: identifying boundary points, filtering these points, and identifying the mode-switching logic. Each step is described in detail below. Step 1: Identifying Boundary Points. We begin by using the proposed SRLR to determine the behavioral logic associated with all data points. Mode-switching points (those at which the systemâ€™s behavior changes) are then identified and labeled as boundary points. Step 2: Filtering Boundary Points. The boundary points collected in the first step vary in their proximity to the true switching boundaries. To refine the selection, we apply a filtering process using the Elliptic Envelope method, chosen for its balance of efficiency and accuracy in iden-tifying outliers. This involves estimating the center of the point cluster using the Minimum Covariance Determinant, computing the Mahalanobis distance of each point from this center, ranking the points based on these distances, and discarding those that exceed a threshold (empirically set to 0.4 in this study). Step 3: Identifying Mode-Switch Logic. In the final step, we reconfigure SRLR for single-mode, time-domain logic IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 20 0 50 100 150 200  

> Data
> 484 486 488 490 492 494 496
> Value
> Ground truth
> NARMAX
> GP
> Our proposed model
> Fig. 10. The comparison results of the simulated ewma data.

identification. The filtered boundary points are then input into SRLR, which learns a logic function f (x), where 

f (x) = 0 defines the switching condition. The system mode at any point is determined by the sign of f (x):values where f (x) > 0 or f (x) â‰¤ 0 correspond to different operational modes. Appendix II: Additional Experiments D. Identification results for EWMA We compare our model with widely-used system iden-tification methods: Nonlinear Autoregressive Models with Moving Average and Exogenous Input (NARMAX) 3 and Genetic Programming (GP) 4, under different percentages of injected outliers. NARMAX is tailored for a broad class of nonlinear dynamic systems, comprising two steps: first, identifying the system structure, such as polynomial terms, and second, combining input-output lags to esti-mate the structure parameters. GP is a symbolic regres-sion method inspired by evolutionary principles, exploring the symbolic space to select the fittest individuals capable of explaining the input-output data relationship. The detailed results are in Table IX. NARMAX, GP, and SRLR can accurately identify EWMA systems with high Best Fit Ratio (BFR) and provide precise predictive expressions. However, when outliers are introduced into the training data, both NARMAX and GP fail to identify the correct expression. For a contamination fraction of 0.01, GP achieves a higher BFR than NARMAX. However, upon plotting the dynamics of the predictive expressions generated by the baselines and our proposed model on the test data shown in Figure 10, it becomes evident that the curve generated by GP deviates more from the ground truth compared to the NARMAX model. Our proposed model not only generates accurate expressions with a higher BFR but also effectively fits the true curve on the test set. We also evaluate recovery performance by comparing our approach with baseline models that incorporate data cleaning techniques. Hampel filtering, a commonly used method, mitigates outliers by adjusting them based on median absolute deviation. As shown in Table X, applying this filtering improves the accuracy of the NARMAX 

> 3https://github.com/wilsonrljr/sysidentpy
> 4https://github.com/trevorstephens/gplearn

model in predicting the EWMA expression. However, its performance declines as the proportion of outliers increases. Genetic Programming demonstrates greater sta-bility in the structure of its predictive expressions, but it struggles to accurately identify the true underlying format. Data cleaning techniques are commonly used in system identification to eliminate extreme values or smooth data, helping to prevent the optimization process from being misled. However, most traditional cleaning methodsâ€”such as distance-based or clustering-based approachesâ€”do not account for the performance of the system identification itself. As a result, they may incorrectly label valid data points as outliers. Our proposed outlier-aware training method addresses this limitation by jointly optimizing for both system identification and outlier removal. This in-tegrated approach ensures that outlier detection supports the ultimate goal of accurate system modeling. Figure 11 presents a comparison between our method and two widely used data cleaning techniques [53]: MT Cleaner and the Hampel filter. MT Cleaner combines a regression model with a Kalman filter, using prediction errors to assess outlier severity. The Hampel filter relies on median absolute deviation, while our method, SRLR, uses the reciprocal of the learned reward to quantify outlier likelihood. As illustrated, both MT Cleaner and the Hampel filter effectively identify global and collective outliers but struggle with contextual outliersâ€”those that appear anomalous in local segments yet fall within the normal range when viewed globally. In contrast, SRLR demonstrates higher sensitivity to all types of outliers, owing to its joint optimization strategy. When considering contaminated data with outliers, as depicted in Figure 12, the cumulative distribution probability of residual errors for the candidate expression is presented for cases involving the injection of 1% and 2% outliers. The results reveal that more than 90% of the training data exhibit lower residual errors. This suggests that training data with higher residual errors are likely to be outliers, constituting only a very small percentage of the dataset. Therefore, the proposed outlier-aware filter method effectively identifies and reduces the impact of outlier training data on system identification results. E. Identification Results in Load Frequency Control The Load Frequency Control (LFC) System employs several mathematical models, including generator, load, prime mover and governor model. The generator can be characterized by the swing equation. The load comprises frequency-independent and frequency-sensitive devices, al-lowing us to model the load as a combination of these two types of devices. Sudden load changes can cause deviations in frequency. The governor model is designed to adjust IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 21 

TABLE IX The comparison of logic recovery for EWMA. Ground truth: y(t) = 0 .8x(t) + 0 .16 x(t âˆ’ 1) + 0 .032 x(t âˆ’ 2) .Outlier NARMAX Genetic Programming SRLR(Our model) fraction Prediction BFR Prediction BFR Prediction BFR 0.0 y(t) = 0 .8x(t) + 0 .16 x(t âˆ’ 1) + 0 .032 x(t âˆ’ 2) + 5 .8eâˆ’11 y(t âˆ’ 1) 1.0 y(t) = 0 .995 x(t) âˆ’ 0.968 0.989 y(t) = 0 .7958 x(t) + 0 .1653 x(t âˆ’ 1) + 0 .0308 x(t âˆ’ 2) 0.9959 0.01 y(t) = 1 .7329 x(t âˆ’ 1) âˆ’ 0.7470 y(t âˆ’ 1) 0.9728 y(t) = 0 .995 x(t) âˆ’ 0.979 0.9883 y(t) = 0 .7985 x(t) + 0 .1628 x(t âˆ’ 1) + 0 .0305 x(t âˆ’ 2) 0.9945 0.02 y(t) = 1 .8563 x(t) âˆ’ 0.8715 y(t âˆ’ 1) 0.9690 y(t) = 0 .995 x(t) âˆ’ 0.979 0.9883 y(t) = 0 .7987 x(t) + 0 .1635 x(t âˆ’ 1) + 0 .0297 x(t âˆ’ 2) 0.9959 0.03 y(t) = 1 .8916 x(t) âˆ’ 0.9070 y(t âˆ’ 1) 0.9681 y(t) = 0 .995 x(t) âˆ’ 0.979 0.9883 y(t) = 0 .7961 x(t) + 0 .1665 x(t âˆ’ 1) + 0 .0292 x(t âˆ’ 2) 0.9945 0.04 y(t) = 1 .9181 x(t) âˆ’ 0.9338 y(t âˆ’ 1) 0.9672 y(t) = x(t) âˆ’ x(t)/(0 .446 x(t âˆ’ 2)) 0.9904 y(t) = 0 .7986 x(t) + 0 .1637 x(t âˆ’ 1) + 0 .0296 x(t âˆ’ 2) 0.9959 0.05 y(t) = 1 .9286 x(t) âˆ’ 0.9449 y(t âˆ’ 1) 0.9643 y(t) = x(t) âˆ’ 2.2176 0.9900 y(t) = 0 .7986 x(t) + 0 .1620 x(t âˆ’ 1) + 0 .0313 x(t âˆ’ 2) 0.9959 0.06 y(t) = 1 .9393 x(t) âˆ’ 0.9554 y(t âˆ’ 1) 0.9658 y(t) = x(t) âˆ’ 2.2590 0.9901 y(t) = 0 .8004 x(t) + 0 .1588 x(t âˆ’ 1) + 0 .0327 x(t âˆ’ 2) 0.9960 TABLE X Comparison of logic recovery for EWMA with data cleaned using the Hampel filter. Outlier NARMAX Genetic Programming fraction Prediction BFR Prediction BFR 0.0 y(t) = 0 .7929 x(t) + 0 .2006 y(t âˆ’ 1) 0.9978 y(t) = 0 .993 x(t) âˆ’ 0.3744 0.9913 0.01 y(t) = 0 .8123 x(t) + 0 .1810 y(t âˆ’ 1) 0.9970 y(t) = 0 .993 x(t) âˆ’ 0.3744 0.9913 0.02 y(t) = 0 .8247 x(t) + 0 .1685 y(t âˆ’ 1) 0.9970 y(t) = 0 .993 x(t) âˆ’ 0.3744 0.9913 0.03 y(t) = 0 .8301 x(t) + 0 .1631 y(t âˆ’ 1) 0.9978 y(t) = x(t) âˆ’ 2.2542 0.9902 0.04 y(t) = 0 .8417 x(t) + 0 .1514 y(t âˆ’ 1) 0.9975 y(t) = 0 .995 x(t) âˆ’ 0.982 0.9881 0.05 y(t) = 0 .8522 x(t) + 0 .1408 y(t âˆ’ 1) 0.9971 y(t) = 0 .995 x(t) âˆ’ 0.982 0.9881 0.06 y(t) = 0 .9122 x(t) + 0 .0803 y(t âˆ’ 1) 0.9958 y(t) = 0 .995 x(t) âˆ’ 0.997 0.9872 

1 Ground truth expression: y(t) = 0 .8x(t) + 0 .16 x(t âˆ’ 1) + 0 .032 x(t âˆ’ 2) .

2 Predictive expression by SRLR under outlier fraction of 0.06: y(t) = 0 .8004 x(t) + 0 .1588 x(t âˆ’

1) + 0 .0327 x(t âˆ’ 2) .0     

> 2
> Corrupted
> Data
> 1
> 0
> 1
> 1
> 0
> 1
> 0
> 1
> 2
> Hampel
> Filter
> 0.0
> 0.5
> 0
> 1
> 0
> 2
> MT
> Cleaner
> 0.0
> 0.2
> 0.0
> 0.5
> 1.0
> 020 40 60 80 100

Point Outliers      

> 0
> 1
> SRLR
> (Ours)
> 020 40 60 80 100

Contextual Outliers      

> 0.0
> 0.5
> 020 40 60 80 100

Collective Outliers 

> 0
> 1
> 2

Fig. 11. Comparison of data cleaning algorithms, including the Hampel Filter, MT Cleaner, and the proposed SRLRâ€™s outlier-aware filter. Red regions indicate anomalies. The first row shows the raw data, followed by anomaly scores from each algorithm. 10 -4 10 -2 10 0

Scaled residual 

> 0.001 0.003 0.01 0.02 0.05 0.10 0.25 0.50 0.75 0.90 0.99
> Cumulative distribution probability
> Outlier fraction=0.01
> Outlier fraction=0.02

Fig. 12. The residual distribution for each point of the candidate expressions. 

mechanical power, steering the system towards a new steady-state. The formulations are expressed as follows: 

â–³Î©( s)

â–³PM (s) âˆ’ â–³ PL(s) = 12Hs + D , â–³PM (s)

â–³PV (s) = 11 + Ï„T s

â–³PV (s)

â–³PG(s) = 11 + Ï„Gs , â–³PG(s)

â–³Î©( s) = âˆ’ 1

R

(23) where the equations are in the S-domain. The first is the equation for the load and inertia, â–³Î©( s), â–³PM (s), â–³PL(s)

is the change in frequency, mechanical power, and load power, respectively, and H, D is the load angle and inertia constant, respectively. The second is the equation for prime mover(turbine), â–³PV (s) is the changes in steam valve position, and Ï„T is the turbine time constant. The third is the equation for the governor, â–³PG(s) is the IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 22 

TABLE XI The identification results of SRLR in frequency control system with/without AIC regularization. Ground truth mode Identified mode(without AIC) Complexity BFR Identified mode(with AIC) simplified mode(with AIC) Complexity BFR Governor 10.2s+1 5.001 sâˆ’1.327 eâˆ’5                               

> s2+5 .001 s20 0.9999 5.001
> s+5 .001 10.1999 s+1 13 0.9999 Turbine 10.5s+1 2sâˆ’2.108 eâˆ’6
> s2+2 s20 0.9999 2
> s+2 10.5s+1 13 1Rotating mass and load 110 s+0 .80.1s+3 .797 eâˆ’6
> s2+0 .08 s20 0.9998 0.1
> s+0 .08 110 s+0 .817 1Gain âˆ’20 âˆ’20 19 1âˆ’20 âˆ’20 18 1PID controller 1050 s2+5030 s+3000
> s2+100 s
> 1049 .9995 s2+5029 .9949 s+2999 .9982
> s2+100 s17 11049 .9991 s2+5029 .9849 s+2999 .9973
> s2+100 s
> 1049 .9991 s2+5029 .9849 s+2999 .9973
> s2+100 s17 1

5HIHUHQFH 

10 

0.1á¡± ãŽ— 1 

$PSOLILHU 

1

0.4á¡± ãŽ— 1 

([FLWHU 

1

á¡± ãŽ— 1 

*HQHUDWRU 

1

0.05á¡± ãŽ— 1 

6HQVRU 

81.6á¡± â¡° ãŽ— 161á¡± ãŽ— 100 

á¡±â¡° ãŽ— 100á¡± 

3,'FRQWUROOHU ãŽ—ãŽ˜

á¡ˆã€™ã€†ã€‡ 

á¡ˆã€¡á¡ˆã€™á¡ˆã€†

á¡ˆã€ á¡ˆã€—ã€ã€… 

Fig. 14. Framework of the voltage regulator system, comprising five components: amplifier, exciter, generator, sensor, and controller. 0 2 4 6 8 10 12 14 16    

> Time (s)
> -0.45 -0.4 -0.35 -0.3 -0.25 -0.2 -0.15 -0.1 -0.05
> Frequency change of PID output (per unit)
> Ground truth
> Our proposed model
> Transfer function model
> ARX model
> 11.5 22.5
> -0.2 -0.1 0

(a) Frequency signals in load frequency control system. 0 1 2 3 4 5 6   

> Time (s)
> -10 -5 0510 15 20 25
> Voltage change of PID output (per unit)
> Ground truth
> Our proposed model
> Transfer function model
> ARX model
> 0.3 0.4 0.5 0.6
> 02468

(b) Voltage signals in voltage regulator system. 

Fig. 15. The comparison of the simulated frequency changes and voltage changes for PID output. /RDG 

> 1
> 0.2á¡± ãŽ— 1

*RYHUQRU 

> 1
> 0.5á¡± ãŽ— 1

7XUELQH 

> 1
> 10á¡± ãŽ— 0.8

,QHUWLDDQGORDG   

> 81.6á¡± â¡°ãŽ— 161á¡± ãŽ— 100
> á¡±â¡°ãŽ— 100á¡±

3,'FRQWUROOHU  

> ãŽ˜ãŽ—âˆ†âˆ†á¡‚ ã€”âˆ†á¡‚ ã€£
> 20

*DLQ 

> ãŽ˜
> ãŽ˜âˆ†á¡‚ ã€“
> âˆ†á¡‚ ã€ˆ

difference between the set power and the feedback power, and Ï„G is the governor time constant. The fourth is the equation for the feedback gain and R is the governor speed regulation. Standard frequency in load applications remains con-stant, such as 60Hz or 50Hz. However, increased loads may convert more kinetic energy into electrical energy, impacting rotor angles of generators and subsequently leading to changes in system frequency. Consequently, control strategies within power systems become crucial to achieve a steady-state system. Here, we analyze the capabilities of SRLR in identifying power control systems and the associated power control logic. We present a simulation of a load frequency controlled system as shown in Figure 13, whose parameters are configured according to the reference [29]. When given a constant input, i.e. â–³PL = 0 .2 per unit, the frequency tending towards a new steady state after a deviation in-terval. The identification results, as presented in Table XI, demonstrate that the proposed framework accurately iden-tifies the system. Moreover, the complexity regularization method effectively aids in discovering simpler structures. The droop alone fails to control the frequency changes to zero. Therefore, an additional controller needs to be introduced to control the frequency change towards zero. We incorporate a Proportional-Integral-Derivative (PID) controller into the feedback loop, as depicted in the dashed box in Figure 13. The PID controller leverages propor-tional, integral, and derivative influences for feedback, optimizing control over frequency. The frequency will tend toward the reference frequency (60Hz) when employing the PID controller in the feedback loop. Table XI records the identification results, revealing that the proposed framework can accurately identify the ground truth PID controller. F. Identification Results in Voltage Regulator Another simulation involves automatic voltage regulator (AVR) system. Changes in reactive powers can influence the deviations of voltage magnitude. We model the re-IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 23  

> (a) Hysteresis Relay (b) Phototaxic Robot

Fig. 16. Comparison of identified index for Cluster SR and proposed method in Hysteresis Relay and Phototaxic Robot datasets. The first row shows simulated data from both methods alongside ground truth. Subsequent rows present the identified mode indices for each method. TABLE XII The identification results of SRLR in voltage regulator system with/without AIC regularization. Ground truth mode Identified mode(without AIC) Complexity BFR Identified mode(with AIC) simplified mode(with AIC) Complexity BFR Amplifier 10 0.1s+1 100 .0656 sâˆ’0.0039                              

> s2+10 .0009 s20 0.9998 100 .0674
> s+10 .002 10 0.0999 s+0 .9995 13 0.9997 Exciter 10.4s+1 2.5022 sâˆ’0.0001
> s2+2 .5005 s20 0.9994 2.5022
> s+2 .5015 10.3996 s+0 .9997 13 0.9993 Generator 1
> s+1 1.425 4.912 eâˆ’5s2+1 .4244 s+1 .425 16 0.9997 1
> s+1 1
> s+1 13 1Sensor 10.05 s+1
> âˆ’0.0136 s+20 .29
> s+20 .2868 18 0.9990 20 .01
> s+20 .01 10.0499 s+1 13 0.9996 PID 81 .6s2+161 s+100
> s2+100 s
> 81 .7941 s2+131 .9117 s+104 .8382
> s2+100 .1764 s21 0.9883 81 .57 s2+131 .6s+104 .5
> s2+99 .91 s
> 81 .57 s2+131 .6s+104 .5
> s2+99 .91 s17 0.9888

active power using an amplifier, exciter, generator and sensor, with the formulations constructed as follows: 

VR(s)

VE (s) = KA

Ï„As + 1 , VF (s)

VR(s) = KE

Ï„E s + 1 

VT (s)

VF (s) = KG

Ï„Gs + 1 , VS (s)

VT (s) = KR

Ï„Rs + 1 

(24) where the first equation represents an amplifier in the excitation system. The second equation is the exciter model, which is a linearized model disregarding saturation or other nonlinearities. The third equation is the generator and the fourth equation is a sensor model, where the sensed voltage is rectified through a bridge rectifier. The parameters KA, K E , K G, K R are gains and Ï„A, Ï„ E , Ï„ G, Ï„ R

are time constants. A simulation is conducted as illustrated in Figure 14, with parameters configured according to the reference [23]. Specifically, KA = 10 , Ï„ A = 0 .1; KE = 1 , Ï„ E = 0 .4, K G =1, Ï„ G = 1; KR = 1 , Ï„ R = 0 .05 . The voltage tends to be stable when PID is employed. The results presented in Table XII demonstrate that our proposed model accu-rately identifies each part of the voltage regulator system. The application of complexity regularization proves to be superior, facilitating the model in generating more simple expression structures with high accuracy and mitigating the risk of overfitting. G. Comparison with Baselines We also conduct a comprehensive comparison between our proposed method and well-established system identi-fication models. The first model is the Transfer Function Model, implemented using the Matlab System Identifi-cation Tool [54]. This model initializes its parameters through the Instrument Variable method, and the Se-quential Quadratic Programming algorithm is employed for optimal parameter search. We also include the autore-gressive model with exogenous input (ARX), a widely used method for identifying linear-time invariant systems. The detailed results of the logic recovery for the fre-quency control system and voltage regulator system are presented in Table XIII and Table XIV. The transfer function model, ARX model, and our proposed method demonstrate accurate identification of the physical parts in the control system. However, itâ€™s noteworthy that these baseline models struggle to identify the PID controller component in both voltage regulator and frequency control scenarios. The simulated PID outputs are depicted in Figure 15(a) and Figure 15(b), showcasing the precision of our proposed method in simulating frequency and voltage changes of PID controller outputs. While the transfer function model can fit the PID output with relatively small errors, the identified expressions show a significant disparity compared to the ground truth expressions. The ARX model performs less effectively in identifying the expressions and exhibits large errors in numerical simulations. We compare SRLR with symbolic regression methods, including PySR and Operon. As shown in Figures 17 and 18, SRLR consistently outperforms these baselines. The gain subsystem is linear in the time domain, making it relatively easy for the baselines to identify. However, for other subsystems, the results differ. While PySR and Operon can adapt to nonlinear systems, they perform poorly in closed-form control systems such as PID con-trollers, as they do not incorporate designs like using the right domain, Use of continuity constraint, outlier-aware training and complexity regularization. IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 24 

TABLE XIII The comparison of SRLR and baselines for logic recovery in load frequency control system. Ground truth mode Transfer function model ARX model SRLR(our model) Identified mode BFR Identified mode BFR Identified mode BFR Governor 10.2s+1 10.1901 s+1 .0003 0.9814 10.1898 s+1 .0004 0.9807 10.1999 s+1 0.9999 Turbine 10.5s+1 10.4904 s+1 .0005 0.9893 10.4895 s+1 0.9885 10.5s+1 1Inertia 110 s+0 .8110 .1215 s+0 .8078 0.9450 110 .1420 s+0 .8085 0.9373 110 s+0 .8 1Gain -20 -20 1 -20 1 -20 1PID 1050 s2+5030 s+3000 

s2+100 s

482 .6s2+5060 s+3000 

s2+100 s 0.5900 3.773 s2+199 .1s+140 .6

s2+4 .748 s+0 .0217 0 1051 .57 s2+5039 .15 s+3005 .73 

s2+100 .41 0.9997 TABLE XIV The comparison of SRLR and baselines for logic recovery in voltage regulator system. Ground truth mode Transfer function model ARX model SRLR(our model) Identified mode BFR Identified mode BFR Identified mode BFR Amplifier 10 0.1s+1 10 0.0908 s+1 .0191 0.9567 10 0.0915 s+1 .0201 0.9587 10 .10.1s+1 0.9997 Exciter 10.4s+1 10.3908 s+1 .0191 0.9716 10.3902 s+1 .0176 0.9716 10.3996 s+1 0.9993 Generator 11s+1 10.994 s+1 .001 0.9931 10.9911 s+1 .001 0.9898 1

s+1 1Sensor 10.05 s+1 10.0391 s+1 .0004 0.9548 10.0392 s+1 .0004 0.9552 10.0499 s+1 0.9996 PID 81 .6s2+161 s+100 

s2+100 s

81 .6s2+1 .22 e18 s+1 .04 e18 

s2+1 .8e16 s+1 .5e18 0.9742 38 .03 s2+2788 s+16510 

s2+73 .14 s+3720 0.4731 81 .57 s2+131 .6s+104 .5

s2+99 .91 s 0.9888 Governor Turbine Inertia Gain PID     

> 0.0
> 0.2
> 0.4
> 0.6
> 0.8
> 1.0
> Best Fit Ratio
> 0.999 1.0 1.0 1.0 0.999
> 0.619
> 0.382
> 0.19
> 1.0
> 0.325
> 0.601
> 0.344
> 0.118
> 1.0
> 0.325
> SRLR
> PySR
> Operon

Fig. 17. Performance comparison of SRLR and baselines on the load frequency control system. Amplifier Exciter Generator Sensor PID       

> 0.0
> 0.2
> 0.4
> 0.6
> 0.8
> 1.0
> Best Fit Ratio
> 0.999 0.999 1.0 0.999 0.988
> 0.539
> 0.141 0.119
> 0.791
> 0.601
> 0.547
> 0.123 0.109
> 0.79
> 0.091
> SRLR
> PySR
> Operon

Fig. 18. Performance comparison of SRLR and baselines on the automatic voltage regulator system. IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 25 

TABLE XV The identification results of SRLR in multi-mode process systems. Dataset Mode ID The ground truth mode No. of points Identified mode Complexity BFR Index accuracy Hysteresis Relay 1 y = 1 1200 y = 1 1 1.0 100% 2 y = âˆ’1 1200 y = âˆ’1 6 1.0 Continuous Hysteresis 1 y = 0 .5x2 + x âˆ’ 0.5 2000 y = 0 .4999 x2 + x âˆ’ 0.4999 11 0.9999 99% 2 y = âˆ’0.5x2 + x + 0 .5 2000 y = âˆ’0.5x2 + x + 0 .5 15 1.0 Phototaxic Robot 1 y = x2 âˆ’ x1 840 y = x2 âˆ’ x1 7 1.0 100% 2 y = 1 /(x1 âˆ’ x2) 1500 y = 1 /(x1 âˆ’ x2) 10 1.0 3 y = 0 1200 y = 0 1 1.0 Non-linear System 1 y = x1x2 1500 y = x1x2 7 1.0 98.51% 2 y = 6 x1/(6 + x2) 1000 y = 6 x1/(6 + x2) 11 1.0 3 y = ( x1 + x2)/(x1 âˆ’ x2) 1000 y = ( x1 + x2)/(x1 âˆ’ x2) 17 0.9996 

H. Additional Results in Multi-Mode Logic Recovery To evaluate the identification accuracy of the index for each mode, we define the index accuracy as follows: Index Accuracy = 1

T

> T

âˆ‘

> t=1

(Iind t= Ë†ind t ) (25) where I is an indicator varaible: if the predicted mode 

ind t at time step t is correct, I is 1; otherwise, I equals zero. The details of the baselines are described as follows:  

> â€¢

Cluster SR [12]: A clustering symbolic regression approach that utilizes GP as the backbone for sym-bolic regression. This method iteratively optimizes soft membership values for each point and the GP parameters through the expectation-maximization al-gorithm, employing a weighted error summation as the fitness function.  

> â€¢

Cluster DSR: A comparative approach that substi-tutes GP with Deep Symbolic Regression [16] within the Cluster SR model, maintaining consistency in all other configurations.  

> â€¢

LSTM Network [9]: A LSTM based regression method that comprises one LSTM layer and two linear pro-jection layers to predict the next system output. The number of hidden units is set to 8, as the default configuration in [9], and the input data is segmented using a sliding window with size 100.  

> â€¢

Deep Cascaded Network [9]: A Neural Network based regression method with 7 cascaded feedforward networks and each with ReLU activation layers, which is used to predict the next system output. The sliding window size is similarly set to 100. As depicted in Figure 16, both our SRLR and Cluster SR successfully identified the discrete hysteresis for the switch-off and switch-on modes, as each mode exhibits a constant behavior that is relatively straightforward to discern. However, it is essential to note that the point distribution within each mode possesses local continuity, a characteristic overlooked by Cluster SR, which does not account for the temporal dynamics of systems. Thus, in the case of phototaxic robot, Cluster SR fails to identify the indexes. We also compare the runtime performance of SRLR against the baseline methods across four multi-mode process systems. All experiments use the same amount of training data, with a fixed maximum of 200,000 ex-pressions processed each method. Runtime is measured until all modes are successfully recovered. As shown in Table XVI, SRLR achieves the fastest performance, at-tributed to its effective mode membership assignment and accurate model identification. While DSR demonstrates better recovery than GP, its Cluster DSR variant suffers from less accurate mode membership assignment. As a result, Cluster SR slightly outperforms Cluster DSR, highlighting the critical role of precise mode membership and expression identification. 

TABLE XVI Average Runtime Comparison System SRLR Cluster SR Cluster DSR Hysteresis Relay 205.92 s 414.34 s 4916.48 s Continuous Hysteresis 642.70 s 3537.18 s 3131.23 s Phototaxic Robot 494.94 s 7490.50 s 10317.71 s Non-linear System 3839.66 s 8598.47 s 7144.81 s 

I. Additional Results in Switch Linear Systems Identifi-cation 40 35 30 25 20          

> Signal Noise Ratio
> 0.0
> 0.2
> 0.4
> 0.6
> 0.8
> 1.0
> Best Fit Ratio
> 0.945
> 0.916 0.899 0.876
> 0.711
> 0.942
> 0.917 0.908
> 0.865
> 0.705
> 0.933 0.932 0.915
> 0.849
> 0.698
> 0.538 0.537 0.539 0.528 0.525
> SRLR
> SparseSI
> SparseSI (Hampel Filter)
> SparseSI (MT Cleaner)

Fig. 19. Performance comparison between SRLR and sparse optimization-based identification. 

System identification for switched linear systems shares similarities with the identification of multi-mode control IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 26 

logic, as both approaches yield mathematical representa-tions for distinct system stages. In our study, we simulate a switched linear system comprising three linear submodels, defined by the following equation: 

y(t) = Î¸Tk [y(t âˆ’ 1) , x (t âˆ’ 1) , x (t âˆ’ 2)] T + e(t)] . (26) where the parameters for each submodel are: Î¸1 =[âˆ’0.277 , âˆ’1.779 , 1.154] , Î¸ 2 = [ âˆ’0.747 , âˆ’1.816 , 0.707] , Î¸ 3 =[âˆ’0.376 , 1.803 , 0.928] . The noise term e(t) is a white Gaus-sian noise, with a Signal-to-Noise Ratio (SNR) ranging from 40 dB to 20 dB, relative to the output signal. We compare the performance of our proposed SRLR, with a sparse optimization-based system identification method (SparseSI) [41]. To evaluate both methods, we generate synthetic data for each subsystem, totaling 3,600 data points for training. On average, SRLR requires approximately one hour for model identification, while SparseSI completes the process in about one second. This difference is expected, as SRLR includes a neural network training phase, which is inherently more computationally intensive. SparseSI, by contrast, is optimized for linear systems and is thus more efficient in these scenarios. As illustrated in Figure 19, both methods achieve strong BFR performance under high SNR conditions. When com-bined with Hampel filtering, SparseSIâ€™s accuracy improves slightly. However, applying the MT Cleaner significantly degrades its performance. This drop occurs because MT Cleaner uses a regressor to fit the dataset. Since the data is randomly generated, the regressor cannot generalize well, often distorting normal data points instead of isolating anomalies. This outcome underscores that data cleaning methods may not always yield improvements and must be chosen carefully based on data characteristics. Although SRLR incurs a higher computational cost, it does not rely on predefined structural assumptions about the system, unlike SparseSI. This flexibility allows SRLR to be applied to a broader range of systems, including nonlinear ones. Therefore, while SRLR may require more processing time, its adaptability offers a significant advantage for modeling complex or unknown system behaviors. Appendix III: Practical Implications J. Overhead Evaluation OpenPLC Runtime                 

> (Modbus Slave / Port 502)
> Modbus TCP Server
> I/O Mapping Layer
> Control Logic (.st)
> Modbus TCP
> Data Acquisition:
> â€¢Holding Registers
> â€¢Coils
> Attack Detection
> â€¢SRLR Rule
> Logging & Storage
> SCADA System
> Modbus TCP
> Modbus TCP Client
> (Emulated I/O Data)
> s2:avoid
> ð€ =1/( ð€ 1âˆ’ð€ 2)
> s3: idle
> ð€ =0
> s1: approach
> ð€ =ð€ 2âˆ’ð€ 1
> Fig. 20. The overall framework of simulated PLC plantform.

To evaluate the overhead of deploying SRLR in real-world industrial environments, we implemented asoftware-based PLC platform using the open-source Open-PLC project 5. OpenPLC adheres to the IEC 61131-3 standard, providing standard hardware and software functionalities of real PLCs. Our test framework, illustrated in Figure 20, comprises three components: a Modbus TCP client, the OpenPLC runtime, and a SCADA system. The Modbus client simulates randomized sensor values. These values are read by the OpenPLC runtime, which emulates the phototaxic robot system described in earlier experiments. The PLC input and output data are then collected by the SCADA system. SRLR-generated detection rules are deployed within the SCADA system to identify potential attack events. The deployment of SRLR involves two main steps. The first is offline training, where the necessary logs and data are collected, and the DSR model is executed. This process takes approximately one hour. The resulting rules, along with the associated code, require about 2 MB of storage. In the second step, the trained rules are installed on an attack detection system, potentially integrated into a SCADA environment. Performance evaluation indicates that collecting a single sample in SCADA incurs an average communication delay of 1.44 milliseconds. The detection process itself, when using SRLR, adds an average delay of 1.91 milliseconds. Memory usage during detection was also assessed: over a 20-minute observation period, SRLR required only 67.6 KB to store collected data and detection logs. K. Case Study: Explainability in Attack Detection Various AI explainability techniques have been devel-oped to interpret black-box, deep learning models. For instance, LIME [55] approximates complex models with locally interpretable ones, such as decision trees, to explain individual predictions. Similarly, SHAP [56] and ALE [57] estimate feature contributions to model outputs. While these methods offer insight at the feature level, they fall short of generating interpretable rules that capture system behavior. More advanced approaches, such as DeepAID [58], attempt to produce human-readable rules by contrasting normal behavior with detected anomalies. However, these methods still do not reconstruct underlying system logic in a way that supports root-cause analysis and operational response. In contrast, SRLR offers structured, rule-based explainability by modeling interactions among variables. This enables operators to trace the propagation of at-tacks through system logic, facilitating identification of tampered variables or compromised control logic. To illustrate, consider the phototaxic robot system de-scribed earlier. Using SRLR, interpretable rules governing behaviors such as movement, obstacle avoidance, and idle states can be derived, along with their logical transitions. As summarized in Table XVII, attackers can exploit protocol vulnerabilities to manipulate PLC logic. For instance, by altering scalar values [59], [60], substituting arithmetic or logical operators [19], deleting or injecting  

> 5https://autonomylogic.com IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY 27

TABLE XVII Explainable Attack Detection via SRLR Rules: Case Studies Attack Type Mutation Operation Example (Before â‡ After) Violations Sensor Value Tampering Scalar variable replacement x1 := 1 â‡ x1 := 10 rule1, rule2 Actuator Value Tampering Scalar variable replacement y := 0 â‡ y := 1 rule3 Arithmetic operator replacement 1 

> x2âˆ’x1

â‡ 1 

> x2+x1

rule2 Switch Logic Attack Subroutine deletion IF s2 AND x3 THEN s2 â†’ s1 â‡ ... rule4 Logical operator replacement IF s2 AND x5 THEN s2 â†’ s3 â‡

IF s2 OR x5 THEN s2 â†’ s3

rule5 Logical connector insertion IF s2 AND x5 THEN s2 â†’ s3 â‡

IF s2 AND x5 OR x3 THEN s2 â†’ s3

rule4, rule5 SRLR Rules: rule1: in mode s1, y := x2 âˆ’ x1; rule2: in mode s1, y := 1 

> x2âˆ’x1

; rule3: in mode s3, y := 0 ; rule4: if s2 AND x3, mode switch s2 â†’ s1

rule5: if s2 AND x5, mode switch s2 â†’ s3; other rules ... 

malicious instructions [61] to disrupt control flow. SRLR detects these manipulations by flagging corresponding rule violations. Security personnel can then pinpoint the affected variables or identify the relevant code segments in the PLCâ€™s ST (structured text) files responsible for the anomaly. Thanks to SRLRâ€™s explainable framework, tampered code and variables can be located more quickly, significantly reducing the response time to logic-level attacks and improving overall system resilience.